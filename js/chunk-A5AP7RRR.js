import{p as ht}from"./chunk-SQN7L5MN.js";import{b as mr,e as xr}from"./chunk-6ZQQ3XQO.js";import{a as dr}from"./chunk-MQMLE4BX.js";import{H as ur,K as lr,t as ar}from"./chunk-EDRI7XUL.js";import{e as fr,i as m,k as x,o as p}from"./chunk-JY5TIRRF.js";var nn={};fr(nn,{InvalidRError:()=>nt,InvalidSError:()=>ot,InvalidSerializedSizeError:()=>rt,InvalidVError:()=>st,InvalidYParityError:()=>ve,MissingPropertiesError:()=>Re,assert:()=>it,extract:()=>Gn,from:()=>Gt,fromBytes:()=>Qr,fromDerBytes:()=>Xn,fromDerHex:()=>Fr,fromHex:()=>Wt,fromLegacy:()=>en,fromRpc:()=>tn,fromTuple:()=>Jn,toBytes:()=>Qn,toDerBytes:()=>Fn,toDerHex:()=>eo,toHex:()=>rn,toLegacy:()=>to,toRpc:()=>ro,toTuple:()=>no,vToYParity:()=>ct,validate:()=>oo,yParityToV:()=>Xt});m();p();x();m();p();x();m();p();x();m();p();x();m();p();x();m();p();x();m();p();x();var wt=BigInt(0),gt=BigInt(1);function Pe(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Bt(e){if(!Pe(e))throw new Error("Uint8Array expected")}function He(e,r){if(typeof r!="boolean")throw new Error(e+" boolean expected, got "+r)}function _e(e){let r=e.toString(16);return r.length&1?"0"+r:r}function yr(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?wt:BigInt("0x"+e)}var br=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",En=Array.from({length:256},(e,r)=>r.toString(16).padStart(2,"0"));function ze(e){if(Bt(e),br)return e.toHex();let r="";for(let t=0;t<e.length;t++)r+=En[e[t]];return r}var ce={_0:48,_9:57,A:65,F:70,a:97,f:102};function pr(e){if(e>=ce._0&&e<=ce._9)return e-ce._0;if(e>=ce.A&&e<=ce.F)return e-(ce.A-10);if(e>=ce.a&&e<=ce.f)return e-(ce.a-10)}function Le(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(br)return Uint8Array.fromHex(e);let r=e.length,t=r/2;if(r%2)throw new Error("hex string expected, got unpadded hex of length "+r);let n=new Uint8Array(t);for(let o=0,s=0;o<t;o++,s+=2){let c=pr(e.charCodeAt(s)),f=pr(e.charCodeAt(s+1));if(c===void 0||f===void 0){let i=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+i+'" at index '+s)}n[o]=c*16+f}return n}function fe(e){return yr(ze(e))}function Et(e){return Bt(e),yr(ze(Uint8Array.from(e).reverse()))}function he(e,r){return Le(e.toString(16).padStart(r*2,"0"))}function vt(e,r){return he(e,r).reverse()}function X(e,r,t){let n;if(typeof r=="string")try{n=Le(r)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if(Pe(r))n=Uint8Array.from(r);else throw new Error(e+" must be hex string or Uint8Array");let o=n.length;if(typeof t=="number"&&o!==t)throw new Error(e+" of length "+t+" expected, got "+o);return n}function je(...e){let r=0;for(let n=0;n<e.length;n++){let o=e[n];Bt(o),r+=o.length}let t=new Uint8Array(r);for(let n=0,o=0;n<e.length;n++){let s=e[n];t.set(s,o),o+=s.length}return t}var yt=e=>typeof e=="bigint"&&wt<=e;function De(e,r,t){return yt(e)&&yt(r)&&yt(t)&&r<=e&&e<t}function ye(e,r,t,n){if(!De(r,t,n))throw new Error("expected valid "+e+": "+t+" <= n < "+n+", got "+r)}function gr(e){let r;for(r=0;e>wt;e>>=gt,r+=1);return r}var be=e=>(gt<<BigInt(e))-gt,bt=e=>new Uint8Array(e),hr=e=>Uint8Array.from(e);function wr(e,r,t){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=bt(e),o=bt(e),s=0,c=()=>{n.fill(1),o.fill(0),s=0},f=(...A)=>t(o,n,...A),i=(A=bt(0))=>{o=f(hr([0]),A),n=f(),A.length!==0&&(o=f(hr([1]),A),n=f())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let A=0,H=[];for(;A<r;){n=f();let j=n.slice();H.push(j),A+=n.length}return je(...H)};return(A,H)=>{c(),i(A);let j;for(;!(j=H(l()));)i();return c(),j}}var vn={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||Pe(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,r)=>r.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function ge(e,r,t={}){let n=(o,s,c)=>{let f=vn[s];if(typeof f!="function")throw new Error("invalid validator function");let i=e[o];if(!(c&&i===void 0)&&!f(i,e))throw new Error("param "+String(o)+" is invalid. Expected "+s+", got "+i)};for(let[o,s]of Object.entries(r))n(o,s,!1);for(let[o,s]of Object.entries(t))n(o,s,!0);return e}function St(e){let r=new WeakMap;return(t,...n)=>{let o=r.get(t);if(o!==void 0)return o;let s=e(t,...n);return r.set(t,s),s}}var W=BigInt(0),Z=BigInt(1),we=BigInt(2),Sn=BigInt(3),Er=BigInt(4),vr=BigInt(5),Sr=BigInt(8);function K(e,r){let t=e%r;return t>=W?t:r+t}function J(e,r,t){let n=e;for(;r-- >W;)n*=n,n%=t;return n}function Ye(e,r){if(e===W)throw new Error("invert: expected non-zero number");if(r<=W)throw new Error("invert: expected positive modulus, got "+r);let t=K(e,r),n=r,o=W,s=Z,c=Z,f=W;for(;t!==W;){let l=n/t,y=n%t,A=o-c*l,H=s-f*l;n=t,t=y,o=c,s=f,c=A,f=H}if(n!==Z)throw new Error("invert: does not exist");return K(o,r)}function Ir(e,r){let t=(e.ORDER+Z)/Er,n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}function In(e,r){let t=(e.ORDER-vr)/Sr,n=e.mul(r,we),o=e.pow(n,t),s=e.mul(r,o),c=e.mul(e.mul(s,we),o),f=e.mul(s,e.sub(c,e.ONE));if(!e.eql(e.sqr(f),r))throw new Error("Cannot find square root");return f}function An(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let r=e-Z,t=0;for(;r%we===W;)r/=we,t++;let n=we,o=ke(e);for(;Br(o,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1)return Ir;let s=o.pow(n,r),c=(r+Z)/we;return function(i,l){if(i.is0(l))return l;if(Br(i,l)!==1)throw new Error("Cannot find square root");let y=t,A=i.mul(i.ONE,s),H=i.pow(l,r),j=i.pow(l,c);for(;!i.eql(H,i.ONE);){if(i.is0(H))return i.ZERO;let k=1,g=i.sqr(H);for(;!i.eql(g,i.ONE);)if(k++,g=i.sqr(g),k===y)throw new Error("Cannot find square root");let D=Z<<BigInt(y-k-1),C=i.pow(A,D);y=k,A=i.sqr(C),H=i.mul(H,A),j=i.mul(j,C)}return j}}function On(e){return e%Er===Sn?Ir:e%Sr===vr?In:An(e)}var Pn=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function It(e){let r={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=Pn.reduce((n,o)=>(n[o]="function",n),r);return ge(e,t)}function Hn(e,r,t){if(t<W)throw new Error("invalid exponent, negatives unsupported");if(t===W)return e.ONE;if(t===Z)return r;let n=e.ONE,o=r;for(;t>W;)t&Z&&(n=e.mul(n,o)),o=e.sqr(o),t>>=Z;return n}function At(e,r,t=!1){let n=new Array(r.length).fill(t?e.ZERO:void 0),o=r.reduce((c,f,i)=>e.is0(f)?c:(n[i]=c,e.mul(c,f)),e.ONE),s=e.inv(o);return r.reduceRight((c,f,i)=>e.is0(f)?c:(n[i]=e.mul(c,n[i]),e.mul(c,f)),s),n}function Br(e,r){let t=(e.ORDER-Z)/we,n=e.pow(r,t),o=e.eql(n,e.ONE),s=e.eql(n,e.ZERO),c=e.eql(n,e.neg(e.ONE));if(!o&&!s&&!c)throw new Error("invalid Legendre symbol result");return o?1:s?0:-1}function Ot(e,r){r!==void 0&&ar(r);let t=r!==void 0?r:e.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function ke(e,r,t=!1,n={}){if(e<=W)throw new Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:o,nByteLength:s}=Ot(e,r);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c,f=Object.freeze({ORDER:e,isLE:t,BITS:o,BYTES:s,MASK:be(o),ZERO:W,ONE:Z,create:i=>K(i,e),isValid:i=>{if(typeof i!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof i);return W<=i&&i<e},is0:i=>i===W,isOdd:i=>(i&Z)===Z,neg:i=>K(-i,e),eql:(i,l)=>i===l,sqr:i=>K(i*i,e),add:(i,l)=>K(i+l,e),sub:(i,l)=>K(i-l,e),mul:(i,l)=>K(i*l,e),pow:(i,l)=>Hn(f,i,l),div:(i,l)=>K(i*Ye(l,e),e),sqrN:i=>i*i,addN:(i,l)=>i+l,subN:(i,l)=>i-l,mulN:(i,l)=>i*l,inv:i=>Ye(i,e),sqrt:n.sqrt||(i=>(c||(c=On(e)),c(f,i))),toBytes:i=>t?vt(i,s):he(i,s),fromBytes:i=>{if(i.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+i.length);return t?Et(i):fe(i)},invertBatch:i=>At(f,i),cmov:(i,l,y)=>y?l:i});return Object.freeze(f)}function Ar(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let r=e.toString(2).length;return Math.ceil(r/8)}function Pt(e){let r=Ar(e);return r+Math.ceil(r/2)}function Or(e,r,t=!1){let n=e.length,o=Ar(r),s=Pt(r);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);let c=t?Et(e):fe(e),f=K(c,r-Z)+Z;return t?vt(f,o):he(f,o)}var Pr=BigInt(0),Tt=BigInt(1);function Ht(e,r){let t=r.negate();return e?t:r}function zr(e,r){if(!Number.isSafeInteger(e)||e<=0||e>r)throw new Error("invalid window size, expected [1.."+r+"], got W="+e)}function zt(e,r){zr(e,r);let t=Math.ceil(r/e)+1,n=2**(e-1),o=2**e,s=be(e),c=BigInt(e);return{windows:t,windowSize:n,mask:s,maxNumber:o,shiftBy:c}}function Hr(e,r,t){let{windowSize:n,mask:o,maxNumber:s,shiftBy:c}=t,f=Number(e&o),i=e>>c;f>n&&(f-=s,i+=Tt);let l=r*n,y=l+Math.abs(f)-1,A=f===0,H=f<0,j=r%2!==0;return{nextN:i,offset:y,isZero:A,isNeg:H,isNegF:j,offsetF:l}}function zn(e,r){if(!Array.isArray(e))throw new Error("array expected");e.forEach((t,n)=>{if(!(t instanceof r))throw new Error("invalid point at index "+n)})}function Un(e,r){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((t,n)=>{if(!r.isValid(t))throw new Error("invalid scalar at index "+n)})}var Ut=new WeakMap,Ur=new WeakMap;function Nt(e){return Ur.get(e)||1}function Nr(e,r){return{constTimeNegate:Ht,hasPrecomputes(t){return Nt(t)!==1},unsafeLadder(t,n,o=e.ZERO){let s=t;for(;n>Pr;)n&Tt&&(o=o.add(s)),s=s.double(),n>>=Tt;return o},precomputeWindow(t,n){let{windows:o,windowSize:s}=zt(n,r),c=[],f=t,i=f;for(let l=0;l<o;l++){i=f,c.push(i);for(let y=1;y<s;y++)i=i.add(f),c.push(i);f=i.double()}return c},wNAF(t,n,o){let s=e.ZERO,c=e.BASE,f=zt(t,r);for(let i=0;i<f.windows;i++){let{nextN:l,offset:y,isZero:A,isNeg:H,isNegF:j,offsetF:k}=Hr(o,i,f);o=l,A?c=c.add(Ht(j,n[k])):s=s.add(Ht(H,n[y]))}return{p:s,f:c}},wNAFUnsafe(t,n,o,s=e.ZERO){let c=zt(t,r);for(let f=0;f<c.windows&&o!==Pr;f++){let{nextN:i,offset:l,isZero:y,isNeg:A}=Hr(o,f,c);if(o=i,!y){let H=n[l];s=s.add(A?H.negate():H)}}return s},getPrecomputes(t,n,o){let s=Ut.get(n);return s||(s=this.precomputeWindow(n,t),t!==1&&Ut.set(n,o(s))),s},wNAFCached(t,n,o){let s=Nt(t);return this.wNAF(s,this.getPrecomputes(s,t,o),n)},wNAFCachedUnsafe(t,n,o,s){let c=Nt(t);return c===1?this.unsafeLadder(t,n,s):this.wNAFUnsafe(c,this.getPrecomputes(c,t,o),n,s)},setWindowSize(t,n){zr(n,r),Ur.set(t,n),Ut.delete(t)}}}function Tr(e,r,t,n){zn(t,e),Un(n,r);let o=t.length,s=n.length;if(o!==s)throw new Error("arrays of points and scalars must have equal length");let c=e.ZERO,f=gr(BigInt(o)),i=1;f>12?i=f-3:f>4?i=f-2:f>0&&(i=2);let l=be(i),y=new Array(Number(l)+1).fill(c),A=Math.floor((r.BITS-1)/i)*i,H=c;for(let j=A;j>=0;j-=i){y.fill(c);for(let g=0;g<s;g++){let D=n[g],C=Number(D>>BigInt(j)&l);y[C]=y[C].add(t[g])}let k=c;for(let g=y.length-1,D=c;g>0;g--)D=D.add(y[g]),k=k.add(D);if(H=H.add(k),j!==0)for(let g=0;g<i;g++)H=H.double()}return H}function Rt(e){return It(e.Fp),ge(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Ot(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function Rr(e){e.lowS!==void 0&&He("lowS",e.lowS),e.prehash!==void 0&&He("prehash",e.prehash)}function Nn(e){let r=Rt(e);ge(r,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});let{endo:t,Fp:n,a:o}=r;if(t){if(!n.eql(o,n.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...r})}var _t=class extends Error{constructor(r=""){super(r)}},ae={Err:_t,_tlv:{encode:(e,r)=>{let{Err:t}=ae;if(e<0||e>256)throw new t("tlv.encode: wrong tag");if(r.length&1)throw new t("tlv.encode: unpadded data");let n=r.length/2,o=_e(n);if(o.length/2&128)throw new t("tlv.encode: long form length too big");let s=n>127?_e(o.length/2|128):"";return _e(e)+s+o+r},decode(e,r){let{Err:t}=ae,n=0;if(e<0||e>256)throw new t("tlv.encode: wrong tag");if(r.length<2||r[n++]!==e)throw new t("tlv.decode: wrong tlv");let o=r[n++],s=!!(o&128),c=0;if(!s)c=o;else{let i=o&127;if(!i)throw new t("tlv.decode(long): indefinite length not supported");if(i>4)throw new t("tlv.decode(long): byte length is too big");let l=r.subarray(n,n+i);if(l.length!==i)throw new t("tlv.decode: length bytes not complete");if(l[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(let y of l)c=c<<8|y;if(n+=i,c<128)throw new t("tlv.decode(long): not minimal encoding")}let f=r.subarray(n,n+c);if(f.length!==c)throw new t("tlv.decode: wrong value length");return{v:f,l:r.subarray(n+c)}}},_int:{encode(e){let{Err:r}=ae;if(e<ue)throw new r("integer: negative integers are not allowed");let t=_e(e);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new r("unexpected DER parsing assertion: unpadded hex");return t},decode(e){let{Err:r}=ae;if(e[0]&128)throw new r("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new r("invalid signature integer: unnecessary leading zero");return fe(e)}},toSig(e){let{Err:r,_int:t,_tlv:n}=ae,o=X("signature",e),{v:s,l:c}=n.decode(48,o);if(c.length)throw new r("invalid signature: left bytes after parsing");let{v:f,l:i}=n.decode(2,s),{v:l,l:y}=n.decode(2,i);if(y.length)throw new r("invalid signature: left bytes after parsing");return{r:t.decode(f),s:t.decode(l)}},hexFromSig(e){let{_tlv:r,_int:t}=ae,n=r.encode(2,t.encode(e.r)),o=r.encode(2,t.encode(e.s)),s=n+o;return r.encode(48,s)}};function qt(e,r){return ze(he(e,r))}var ue=BigInt(0),M=BigInt(1),jo=BigInt(2),$t=BigInt(3),Tn=BigInt(4);function Rn(e){let r=Nn(e),{Fp:t}=r,n=ke(r.n,r.nBitLength),o=r.toBytes||((O,a,h)=>{let w=a.toAffine();return je(Uint8Array.from([4]),t.toBytes(w.x),t.toBytes(w.y))}),s=r.fromBytes||(O=>{let a=O.subarray(1),h=t.fromBytes(a.subarray(0,t.BYTES)),w=t.fromBytes(a.subarray(t.BYTES,2*t.BYTES));return{x:h,y:w}});function c(O){let{a,b:h}=r,w=t.sqr(O),S=t.mul(w,O);return t.add(t.add(S,t.mul(O,a)),h)}function f(O,a){let h=t.sqr(a),w=c(O);return t.eql(h,w)}if(!f(r.Gx,r.Gy))throw new Error("bad curve params: generator point");let i=t.mul(t.pow(r.a,$t),Tn),l=t.mul(t.sqr(r.b),BigInt(27));if(t.is0(t.add(i,l)))throw new Error("bad curve params: a or b");function y(O){return De(O,M,r.n)}function A(O){let{allowedPrivateKeyLengths:a,nByteLength:h,wrapPrivateKey:w,n:S}=r;if(a&&typeof O!="bigint"){if(Pe(O)&&(O=ze(O)),typeof O!="string"||!a.includes(O.length))throw new Error("invalid private key");O=O.padStart(h*2,"0")}let R;try{R=typeof O=="bigint"?O:fe(X("private key",O,h))}catch{throw new Error("invalid private key, expected hex or "+h+" bytes, got "+typeof O)}return w&&(R=K(R,S)),ye("private key",R,M,S),R}function H(O){if(!(O instanceof g))throw new Error("ProjectivePoint expected")}let j=St((O,a)=>{let{px:h,py:w,pz:S}=O;if(t.eql(S,t.ONE))return{x:h,y:w};let R=O.is0();a==null&&(a=R?t.ONE:t.inv(S));let _=t.mul(h,a),$=t.mul(w,a),B=t.mul(S,a);if(R)return{x:t.ZERO,y:t.ZERO};if(!t.eql(B,t.ONE))throw new Error("invZ was invalid");return{x:_,y:$}}),k=St(O=>{if(O.is0()){if(r.allowInfinityPoint&&!t.is0(O.py))return;throw new Error("bad point: ZERO")}let{x:a,y:h}=O.toAffine();if(!t.isValid(a)||!t.isValid(h))throw new Error("bad point: x or y not FE");if(!f(a,h))throw new Error("bad point: equation left != right");if(!O.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class g{constructor(a,h,w){if(a==null||!t.isValid(a))throw new Error("x required");if(h==null||!t.isValid(h)||t.is0(h))throw new Error("y required");if(w==null||!t.isValid(w))throw new Error("z required");this.px=a,this.py=h,this.pz=w,Object.freeze(this)}static fromAffine(a){let{x:h,y:w}=a||{};if(!a||!t.isValid(h)||!t.isValid(w))throw new Error("invalid affine point");if(a instanceof g)throw new Error("projective point not allowed");let S=R=>t.eql(R,t.ZERO);return S(h)&&S(w)?g.ZERO:new g(h,w,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(a){let h=At(t,a.map(w=>w.pz));return a.map((w,S)=>w.toAffine(h[S])).map(g.fromAffine)}static fromHex(a){let h=g.fromAffine(s(X("pointHex",a)));return h.assertValidity(),h}static fromPrivateKey(a){return g.BASE.multiply(A(a))}static msm(a,h){return Tr(g,n,a,h)}_setWindowSize(a){oe.setWindowSize(this,a)}assertValidity(){k(this)}hasEvenY(){let{y:a}=this.toAffine();if(t.isOdd)return!t.isOdd(a);throw new Error("Field doesn't support isOdd")}equals(a){H(a);let{px:h,py:w,pz:S}=this,{px:R,py:_,pz:$}=a,B=t.eql(t.mul(h,$),t.mul(R,S)),z=t.eql(t.mul(w,$),t.mul(_,S));return B&&z}negate(){return new g(this.px,t.neg(this.py),this.pz)}double(){let{a,b:h}=r,w=t.mul(h,$t),{px:S,py:R,pz:_}=this,$=t.ZERO,B=t.ZERO,z=t.ZERO,E=t.mul(S,S),V=t.mul(R,R),d=t.mul(_,_),u=t.mul(S,R);return u=t.add(u,u),z=t.mul(S,_),z=t.add(z,z),$=t.mul(a,z),B=t.mul(w,d),B=t.add($,B),$=t.sub(V,B),B=t.add(V,B),B=t.mul($,B),$=t.mul(u,$),z=t.mul(w,z),d=t.mul(a,d),u=t.sub(E,d),u=t.mul(a,u),u=t.add(u,z),z=t.add(E,E),E=t.add(z,E),E=t.add(E,d),E=t.mul(E,u),B=t.add(B,E),d=t.mul(R,_),d=t.add(d,d),E=t.mul(d,u),$=t.sub($,E),z=t.mul(d,V),z=t.add(z,z),z=t.add(z,z),new g($,B,z)}add(a){H(a);let{px:h,py:w,pz:S}=this,{px:R,py:_,pz:$}=a,B=t.ZERO,z=t.ZERO,E=t.ZERO,V=r.a,d=t.mul(r.b,$t),u=t.mul(h,R),b=t.mul(w,_),P=t.mul(S,$),v=t.add(h,w),I=t.add(R,_);v=t.mul(v,I),I=t.add(u,b),v=t.sub(v,I),I=t.add(h,S);let L=t.add(R,$);return I=t.mul(I,L),L=t.add(u,P),I=t.sub(I,L),L=t.add(w,S),B=t.add(_,$),L=t.mul(L,B),B=t.add(b,P),L=t.sub(L,B),E=t.mul(V,I),B=t.mul(d,P),E=t.add(B,E),B=t.sub(b,E),E=t.add(b,E),z=t.mul(B,E),b=t.add(u,u),b=t.add(b,u),P=t.mul(V,P),I=t.mul(d,I),b=t.add(b,P),P=t.sub(u,P),P=t.mul(V,P),I=t.add(I,P),u=t.mul(b,I),z=t.add(z,u),u=t.mul(L,I),B=t.mul(v,B),B=t.sub(B,u),u=t.mul(v,b),E=t.mul(L,E),E=t.add(E,u),new g(B,z,E)}subtract(a){return this.add(a.negate())}is0(){return this.equals(g.ZERO)}wNAF(a){return oe.wNAFCached(this,a,g.normalizeZ)}multiplyUnsafe(a){let{endo:h,n:w}=r;ye("scalar",a,ue,w);let S=g.ZERO;if(a===ue)return S;if(this.is0()||a===M)return this;if(!h||oe.hasPrecomputes(this))return oe.wNAFCachedUnsafe(this,a,g.normalizeZ);let{k1neg:R,k1:_,k2neg:$,k2:B}=h.splitScalar(a),z=S,E=S,V=this;for(;_>ue||B>ue;)_&M&&(z=z.add(V)),B&M&&(E=E.add(V)),V=V.double(),_>>=M,B>>=M;return R&&(z=z.negate()),$&&(E=E.negate()),E=new g(t.mul(E.px,h.beta),E.py,E.pz),z.add(E)}multiply(a){let{endo:h,n:w}=r;ye("scalar",a,M,w);let S,R;if(h){let{k1neg:_,k1:$,k2neg:B,k2:z}=h.splitScalar(a),{p:E,f:V}=this.wNAF($),{p:d,f:u}=this.wNAF(z);E=oe.constTimeNegate(_,E),d=oe.constTimeNegate(B,d),d=new g(t.mul(d.px,h.beta),d.py,d.pz),S=E.add(d),R=V.add(u)}else{let{p:_,f:$}=this.wNAF(a);S=_,R=$}return g.normalizeZ([S,R])[0]}multiplyAndAddUnsafe(a,h,w){let S=g.BASE,R=($,B)=>B===ue||B===M||!$.equals(S)?$.multiplyUnsafe(B):$.multiply(B),_=R(this,h).add(R(a,w));return _.is0()?void 0:_}toAffine(a){return j(this,a)}isTorsionFree(){let{h:a,isTorsionFree:h}=r;if(a===M)return!0;if(h)return h(g,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:a,clearCofactor:h}=r;return a===M?this:h?h(g,this):this.multiplyUnsafe(r.h)}toRawBytes(a=!0){return He("isCompressed",a),this.assertValidity(),o(g,this,a)}toHex(a=!0){return He("isCompressed",a),ze(this.toRawBytes(a))}}g.BASE=new g(r.Gx,r.Gy,t.ONE),g.ZERO=new g(t.ZERO,t.ONE,t.ZERO);let{endo:D,nBitLength:C}=r,oe=Nr(g,D?Math.ceil(C/2):C);return{CURVE:r,ProjectivePoint:g,normPrivateKeyToScalar:A,weierstrassEquation:c,isWithinCurveOrder:y}}function qn(e){let r=Rt(e);return ge(r,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...r})}function qr(e){let r=qn(e),{Fp:t,n,nByteLength:o,nBitLength:s}=r,c=t.BYTES+1,f=2*t.BYTES+1;function i(d){return K(d,n)}function l(d){return Ye(d,n)}let{ProjectivePoint:y,normPrivateKeyToScalar:A,weierstrassEquation:H,isWithinCurveOrder:j}=Rn({...r,toBytes(d,u,b){let P=u.toAffine(),v=t.toBytes(P.x),I=je;return He("isCompressed",b),b?I(Uint8Array.from([u.hasEvenY()?2:3]),v):I(Uint8Array.from([4]),v,t.toBytes(P.y))},fromBytes(d){let u=d.length,b=d[0],P=d.subarray(1);if(u===c&&(b===2||b===3)){let v=fe(P);if(!De(v,M,t.ORDER))throw new Error("Point is not on curve");let I=H(v),L;try{L=t.sqrt(I)}catch(re){let G=re instanceof Error?": "+re.message:"";throw new Error("Point is not on curve"+G)}let Y=(L&M)===M;return(b&1)===1!==Y&&(L=t.neg(L)),{x:v,y:L}}else if(u===f&&b===4){let v=t.fromBytes(P.subarray(0,t.BYTES)),I=t.fromBytes(P.subarray(t.BYTES,2*t.BYTES));return{x:v,y:I}}else{let v=c,I=f;throw new Error("invalid Point, expected length of "+v+", or uncompressed "+I+", got "+u)}}});function k(d){let u=n>>M;return d>u}function g(d){return k(d)?i(-d):d}let D=(d,u,b)=>fe(d.slice(u,b));class C{constructor(u,b,P){ye("r",u,M,n),ye("s",b,M,n),this.r=u,this.s=b,P!=null&&(this.recovery=P),Object.freeze(this)}static fromCompact(u){let b=o;return u=X("compactSignature",u,b*2),new C(D(u,0,b),D(u,b,2*b))}static fromDER(u){let{r:b,s:P}=ae.toSig(X("DER",u));return new C(b,P)}assertValidity(){}addRecoveryBit(u){return new C(this.r,this.s,u)}recoverPublicKey(u){let{r:b,s:P,recovery:v}=this,I=S(X("msgHash",u));if(v==null||![0,1,2,3].includes(v))throw new Error("recovery id invalid");let L=v===2||v===3?b+r.n:b;if(L>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");let Y=(v&1)===0?"02":"03",ie=y.fromHex(Y+qt(L,t.BYTES)),re=l(L),G=i(-I*re),Ie=i(P*re),de=y.BASE.multiplyAndAddUnsafe(ie,G,Ie);if(!de)throw new Error("point at infinify");return de.assertValidity(),de}hasHighS(){return k(this.s)}normalizeS(){return this.hasHighS()?new C(this.r,i(-this.s),this.recovery):this}toDERRawBytes(){return Le(this.toDERHex())}toDERHex(){return ae.hexFromSig(this)}toCompactRawBytes(){return Le(this.toCompactHex())}toCompactHex(){let u=o;return qt(this.r,u)+qt(this.s,u)}}let oe={isValidPrivateKey(d){try{return A(d),!0}catch{return!1}},normPrivateKeyToScalar:A,randomPrivateKey:()=>{let d=Pt(r.n);return Or(r.randomBytes(d),r.n)},precompute(d=8,u=y.BASE){return u._setWindowSize(d),u.multiply(BigInt(3)),u}};function O(d,u=!0){return y.fromPrivateKey(d).toRawBytes(u)}function a(d){if(typeof d=="bigint")return!1;if(d instanceof y)return!0;let b=X("key",d).length,P=t.BYTES,v=P+1,I=2*P+1;if(!(r.allowedPrivateKeyLengths||o===v))return b===v||b===I}function h(d,u,b=!0){if(a(d)===!0)throw new Error("first arg must be private key");if(a(u)===!1)throw new Error("second arg must be public key");return y.fromHex(u).multiply(A(d)).toRawBytes(b)}let w=r.bits2int||function(d){if(d.length>8192)throw new Error("input is too large");let u=fe(d),b=d.length*8-s;return b>0?u>>BigInt(b):u},S=r.bits2int_modN||function(d){return i(w(d))},R=be(s);function _(d){return ye("num < 2^"+s,d,ue,R),he(d,o)}function $(d,u,b=B){if(["recovered","canonical"].some(xe=>xe in b))throw new Error("sign() legacy options not supported");let{hash:P,randomBytes:v}=r,{lowS:I,prehash:L,extraEntropy:Y}=b;I==null&&(I=!0),d=X("msgHash",d),Rr(b),L&&(d=X("prehashed msgHash",P(d)));let ie=S(d),re=A(u),G=[_(re),_(ie)];if(Y!=null&&Y!==!1){let xe=Y===!0?v(t.BYTES):Y;G.push(X("extraEntropy",xe))}let Ie=je(...G),de=ie;function xt(xe){let Ae=w(xe);if(!j(Ae))return;let pt=l(Ae),qe=y.BASE.multiply(Ae).toAffine(),pe=i(qe.x);if(pe===ue)return;let $e=i(pt*i(de+pe*re));if($e===ue)return;let Oe=(qe.x===pe?0:2)|Number(qe.y&M),cr=$e;return I&&k($e)&&(cr=g($e),Oe^=1),new C(pe,cr,Oe)}return{seed:Ie,k2sig:xt}}let B={lowS:r.lowS,prehash:!1},z={lowS:r.lowS,prehash:!1};function E(d,u,b=B){let{seed:P,k2sig:v}=$(d,u,b),I=r;return wr(I.hash.outputLen,I.nByteLength,I.hmac)(P,v)}y.BASE._setWindowSize(8);function V(d,u,b,P=z){let v=d;u=X("msgHash",u),b=X("publicKey",b);let{lowS:I,prehash:L,format:Y}=P;if(Rr(P),"strict"in P)throw new Error("options.strict was renamed to lowS");if(Y!==void 0&&Y!=="compact"&&Y!=="der")throw new Error("format must be compact or der");let ie=typeof v=="string"||Pe(v),re=!ie&&!Y&&typeof v=="object"&&v!==null&&typeof v.r=="bigint"&&typeof v.s=="bigint";if(!ie&&!re)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let G,Ie;try{if(re&&(G=new C(v.r,v.s)),ie){try{Y!=="compact"&&(G=C.fromDER(v))}catch(Oe){if(!(Oe instanceof ae.Err))throw Oe}!G&&Y!=="der"&&(G=C.fromCompact(v))}Ie=y.fromHex(b)}catch{return!1}if(!G||I&&G.hasHighS())return!1;L&&(u=r.hash(u));let{r:de,s:xt}=G,xe=S(u),Ae=l(xt),pt=i(xe*Ae),qe=i(de*Ae),pe=y.BASE.multiplyAndAddUnsafe(Ie,pt,qe)?.toAffine();return pe?i(pe.x)===de:!1}return{CURVE:r,getPublicKey:O,getSharedSecret:h,sign:E,verify:V,ProjectivePoint:y,Signature:C,utils:oe}}function $n(e){return{hash:e,hmac:(r,...t)=>xr(e,r,ur(...t)),randomBytes:lr}}function $r(e,r){let t=n=>qr({...e,...$n(n)});return{...t(r),create:t}}var jr=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),_r=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_n=BigInt(0),Ln=BigInt(1),Lt=BigInt(2),Lr=(e,r)=>(e+r/Lt)/r;function jn(e){let r=jr,t=BigInt(3),n=BigInt(6),o=BigInt(11),s=BigInt(22),c=BigInt(23),f=BigInt(44),i=BigInt(88),l=e*e*e%r,y=l*l*e%r,A=J(y,t,r)*y%r,H=J(A,t,r)*y%r,j=J(H,Lt,r)*l%r,k=J(j,o,r)*j%r,g=J(k,s,r)*k%r,D=J(g,f,r)*g%r,C=J(D,i,r)*D%r,oe=J(C,f,r)*g%r,O=J(oe,t,r)*y%r,a=J(O,c,r)*k%r,h=J(a,n,r)*l%r,w=J(h,Lt,r);if(!jt.eql(jt.sqr(w),e))throw new Error("Cannot find square root");return w}var jt=ke(jr,void 0,void 0,{sqrt:jn}),Q=$r({a:_n,b:BigInt(7),Fp:jt,n:_r,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let r=_r,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Ln*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=t,c=BigInt("0x100000000000000000000000000000000"),f=Lr(s*e,r),i=Lr(-n*e,r),l=K(e-f*t-i*o,r),y=K(-f*n-i*s,r),A=l>c,H=y>c;if(A&&(l=r-l),H&&(y=r-y),l>c||y>c)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:A,k1:l,k2neg:H,k2:y}}}},mr);m();p();x();m();p();x();m();p();x();m();p();x();var kr="0.1.1";function Cr(){return kr}var q=class e extends Error{constructor(r,t={}){let n=(()=>{if(t.cause instanceof e){if(t.cause.details)return t.cause.details;if(t.cause.shortMessage)return t.cause.shortMessage}return t.cause&&"details"in t.cause&&typeof t.cause.details=="string"?t.cause.details:t.cause?.message?t.cause.message:t.details})(),o=t.cause instanceof e&&t.cause.docsPath||t.docsPath,c=`https://oxlib.sh${o??""}`,f=[r||"An error occurred.",...t.metaMessages?["",...t.metaMessages]:[],...n||o?["",n?`Details: ${n}`:void 0,o?`See: ${c}`:void 0]:[]].filter(i=>typeof i=="string").join(`
`);super(f,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${Cr()}`}),this.cause=t.cause,this.details=n,this.docs=c,this.docsPath=o,this.shortMessage=r}walk(r){return Mr(this,r)}};function Mr(e,r){return r?.(e)?e:e&&typeof e=="object"&&"cause"in e&&e.cause?Mr(e.cause,r):r?null:e}m();p();x();m();p();x();function Vr(e,r){if(kt(e)>r)throw new We({givenSize:kt(e),maxSize:r})}var le={zero:48,nine:57,A:65,F:70,a:97,f:102};function Ct(e){if(e>=le.zero&&e<=le.nine)return e-le.zero;if(e>=le.A&&e<=le.F)return e-(le.A-10);if(e>=le.a&&e<=le.f)return e-(le.a-10)}function Kr(e,r={}){let{dir:t,size:n=32}=r;if(n===0)return e;if(e.length>n)throw new Ge({size:e.length,targetSize:n,type:"Bytes"});let o=new Uint8Array(n);for(let s=0;s<n;s++){let c=t==="right";o[c?s:n-s-1]=e[c?s:e.length-s-1]}return o}m();p();x();function Xe(e,r){if(te(e)>r)throw new Je({givenSize:te(e),maxSize:r})}function Zr(e,r){if(typeof r=="number"&&r>0&&r>te(e)-1)throw new Ce({offset:r,position:"start",size:te(e)})}function Dr(e,r,t){if(typeof r=="number"&&typeof t=="number"&&te(e)!==t-r)throw new Ce({offset:t,position:"end",size:te(e)})}function Mt(e,r={}){let{dir:t,size:n=32}=r;if(n===0)return e;let o=e.replace("0x","");if(o.length>n*2)throw new Qe({size:Math.ceil(o.length/2),targetSize:n,type:"Hex"});return`0x${o[t==="right"?"padEnd":"padStart"](n*2,"0")}`}function Yr(e,r={}){let{dir:t="left"}=r,n=e.replace("0x",""),o=0;for(let s=0;s<n.length-1&&n[t==="left"?s:n.length-s-1].toString()==="0";s++)o++;return n=t==="left"?n.slice(o):n.slice(0,n.length-o),n==="0"?"0x":t==="right"&&n.length%2===1?`0x${n}0`:`0x${n}`}m();p();x();var Cn="#__bigint";function me(e,r,t){return JSON.stringify(e,(n,o)=>typeof r=="function"?r(n,o):typeof o=="bigint"?o.toString()+Cn:o,t)}var Mn=Array.from({length:256},(e,r)=>r.toString(16).padStart(2,"0"));function Vn(e,r={}){let{strict:t=!1}=r;if(!e)throw new Fe(e);if(typeof e!="string")throw new Fe(e);if(t&&!/^0x[0-9a-fA-F]*$/.test(e))throw new et(e);if(!e.startsWith("0x"))throw new et(e)}function tt(...e){return`0x${e.reduce((r,t)=>r+t.replace("0x",""),"")}`}function se(e){return e instanceof Uint8Array?F(e):Array.isArray(e)?F(new Uint8Array(e)):e}function F(e,r={}){let t="";for(let o=0;o<e.length;o++)t+=Mn[e[o]];let n=`0x${t}`;return typeof r.size=="number"?(Xe(n,r.size),Kt(n,r.size)):n}function ee(e,r={}){let{signed:t,size:n}=r,o=BigInt(e),s;n?t?s=(1n<<BigInt(n)*8n-1n)-1n:s=2n**(BigInt(n)*8n)-1n:typeof e=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));let c=typeof s=="bigint"&&t?-s-1n:0;if(s&&o>s||o<c){let l=typeof e=="bigint"?"n":"";throw new Vt({max:s?`${s}${l}`:void 0,min:`${c}${l}`,signed:t,size:n,value:`${e}${l}`})}let i=`0x${(t&&o<0?(1n<<BigInt(n*8))+BigInt(o):o).toString(16)}`;return n?Kn(i,n):i}function Kn(e,r){return Mt(e,{dir:"left",size:r})}function Kt(e,r){return Mt(e,{dir:"right",size:r})}function ne(e,r,t,n={}){let{strict:o}=n;Zr(e,r);let s=`0x${e.replace("0x","").slice((r??0)*2,(t??e.length)*2)}`;return o&&Dr(s,r,t),s}function te(e){return Math.ceil((e.length-2)/2)}function Zt(e){return Yr(e,{dir:"left"})}function Dt(e,r={}){let{strict:t=!1}=r;try{return Vn(e,{strict:t}),!0}catch{return!1}}var Vt=class extends q{constructor({max:r,min:t,signed:n,size:o,value:s}){super(`Number \`${s}\` is not in safe${o?` ${o*8}-bit`:""}${n?" signed":" unsigned"} integer range ${r?`(\`${t}\` to \`${r}\`)`:`(above \`${t}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}};var Fe=class extends q{constructor(r){super(`Value \`${typeof r=="object"?me(r):r}\` of type \`${typeof r}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}},et=class extends q{constructor(r){super(`Value \`${r}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}};var Je=class extends q{constructor({givenSize:r,maxSize:t}){super(`Size cannot exceed \`${t}\` bytes. Given size: \`${r}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}},Ce=class extends q{constructor({offset:r,position:t,size:n}){super(`Slice ${t==="start"?"starting":"ending"} at offset \`${r}\` is out-of-bounds (size: \`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}},Qe=class extends q{constructor({size:r,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${r}\`) exceeds padding size (\`${t}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};var Zn=new TextEncoder;function Dn(e){if(!(e instanceof Uint8Array)){if(!e)throw new Ne(e);if(typeof e!="object")throw new Ne(e);if(!("BYTES_PER_ELEMENT"in e))throw new Ne(e);if(e.BYTES_PER_ELEMENT!==1||e.constructor.name!=="Uint8Array")throw new Ne(e)}}function Te(e){return e instanceof Uint8Array?e:typeof e=="string"?Ve(e):Yn(e)}function Yn(e){return e instanceof Uint8Array?e:new Uint8Array(e)}function Ve(e,r={}){let{size:t}=r,n=e;t&&(Xe(e,t),n=Kt(e,t));let o=n.slice(2);o.length%2&&(o=`0${o}`);let s=o.length/2,c=new Uint8Array(s);for(let f=0,i=0;f<s;f++){let l=Ct(o.charCodeAt(i++)),y=Ct(o.charCodeAt(i++));if(l===void 0||y===void 0)throw new q(`Invalid byte sequence ("${o[i-2]}${o[i-1]}" in "${o}").`);c[f]=l*16+y}return c}function Gr(e,r={}){let{size:t}=r,n=Zn.encode(e);return typeof t=="number"?(Vr(n,t),Wn(n,t)):n}function Wn(e,r){return Kr(e,{dir:"right",size:r})}function kt(e){return e.length}function Xr(e){try{return Dn(e),!0}catch{return!1}}var Ne=class extends q{constructor(r){super(`Value \`${typeof r=="object"?me(r):r}\` of type \`${typeof r}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}},We=class extends q{constructor({givenSize:r,maxSize:t}){super(`Size cannot exceed \`${t}\` bytes. Given size: \`${r}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}};var Ge=class extends q{constructor({size:r,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${r}\`) exceeds padding size (\`${t}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}};m();p();x();var Ls=2n**(8n-1n)-1n,js=2n**(16n-1n)-1n,ks=2n**(24n-1n)-1n,Cs=2n**(32n-1n)-1n,Ms=2n**(40n-1n)-1n,Vs=2n**(48n-1n)-1n,Ks=2n**(56n-1n)-1n,Zs=2n**(64n-1n)-1n,Ds=2n**(72n-1n)-1n,Ys=2n**(80n-1n)-1n,Ws=2n**(88n-1n)-1n,Gs=2n**(96n-1n)-1n,Xs=2n**(104n-1n)-1n,Js=2n**(112n-1n)-1n,Qs=2n**(120n-1n)-1n,Fs=2n**(128n-1n)-1n,ei=2n**(136n-1n)-1n,ti=2n**(144n-1n)-1n,ri=2n**(152n-1n)-1n,ni=2n**(160n-1n)-1n,oi=2n**(168n-1n)-1n,si=2n**(176n-1n)-1n,ii=2n**(184n-1n)-1n,ci=2n**(192n-1n)-1n,fi=2n**(200n-1n)-1n,ai=2n**(208n-1n)-1n,ui=2n**(216n-1n)-1n,li=2n**(224n-1n)-1n,di=2n**(232n-1n)-1n,mi=2n**(240n-1n)-1n,xi=2n**(248n-1n)-1n,pi=2n**(256n-1n)-1n,hi=-(2n**(8n-1n)),yi=-(2n**(16n-1n)),bi=-(2n**(24n-1n)),gi=-(2n**(32n-1n)),wi=-(2n**(40n-1n)),Bi=-(2n**(48n-1n)),Ei=-(2n**(56n-1n)),vi=-(2n**(64n-1n)),Si=-(2n**(72n-1n)),Ii=-(2n**(80n-1n)),Ai=-(2n**(88n-1n)),Oi=-(2n**(96n-1n)),Pi=-(2n**(104n-1n)),Hi=-(2n**(112n-1n)),zi=-(2n**(120n-1n)),Ui=-(2n**(128n-1n)),Ni=-(2n**(136n-1n)),Ti=-(2n**(144n-1n)),Ri=-(2n**(152n-1n)),qi=-(2n**(160n-1n)),$i=-(2n**(168n-1n)),_i=-(2n**(176n-1n)),Li=-(2n**(184n-1n)),ji=-(2n**(192n-1n)),ki=-(2n**(200n-1n)),Ci=-(2n**(208n-1n)),Mi=-(2n**(216n-1n)),Vi=-(2n**(224n-1n)),Ki=-(2n**(232n-1n)),Zi=-(2n**(240n-1n)),Di=-(2n**(248n-1n)),Yi=-(2n**(256n-1n)),Wi=2n**8n-1n,Gi=2n**16n-1n,Xi=2n**24n-1n,Ji=2n**32n-1n,Qi=2n**40n-1n,Fi=2n**48n-1n,ec=2n**56n-1n,tc=2n**64n-1n,rc=2n**72n-1n,nc=2n**80n-1n,oc=2n**88n-1n,sc=2n**96n-1n,ic=2n**104n-1n,cc=2n**112n-1n,fc=2n**120n-1n,ac=2n**128n-1n,uc=2n**136n-1n,lc=2n**144n-1n,dc=2n**152n-1n,mc=2n**160n-1n,xc=2n**168n-1n,pc=2n**176n-1n,hc=2n**184n-1n,yc=2n**192n-1n,bc=2n**200n-1n,gc=2n**208n-1n,wc=2n**216n-1n,Bc=2n**224n-1n,Ec=2n**232n-1n,vc=2n**240n-1n,Sc=2n**248n-1n,Yt=2n**256n-1n;function it(e,r={}){let{recovered:t}=r;if(typeof e.r>"u")throw new Re({signature:e});if(typeof e.s>"u")throw new Re({signature:e});if(t&&typeof e.yParity>"u")throw new Re({signature:e});if(e.r<0n||e.r>Yt)throw new nt({value:e.r});if(e.s<0n||e.s>Yt)throw new ot({value:e.s});if(typeof e.yParity=="number"&&e.yParity!==0&&e.yParity!==1)throw new ve({value:e.yParity})}function Qr(e){return Wt(F(e))}function Wt(e){if(e.length!==130&&e.length!==132)throw new rt({signature:e});let r=BigInt(ne(e,0,32)),t=BigInt(ne(e,32,64)),n=(()=>{let o=+`0x${e.slice(130)}`;if(!Number.isNaN(o))try{return ct(o)}catch{throw new ve({value:o})}})();return typeof n>"u"?{r,s:t}:{r,s:t,yParity:n}}function Gn(e){if(!(typeof e.r>"u")&&!(typeof e.s>"u"))return Gt(e)}function Gt(e){let r=typeof e=="string"?Wt(e):e instanceof Uint8Array?Qr(e):typeof e.r=="string"?tn(e):e.v?en(e):{r:e.r,s:e.s,...typeof e.yParity<"u"?{yParity:e.yParity}:{}};return it(r),r}function Xn(e){return Fr(F(e))}function Fr(e){let{r,s:t}=Q.Signature.fromDER(se(e).slice(2));return{r,s:t}}function en(e){return{r:e.r,s:e.s,yParity:ct(e.v)}}function tn(e){let r=(()=>{let t=e.v?Number(e.v):void 0,n=e.yParity?Number(e.yParity):void 0;if(typeof t=="number"&&typeof n!="number"&&(n=ct(t)),typeof n!="number")throw new ve({value:e.yParity});return n})();return{r:BigInt(e.r),s:BigInt(e.s),yParity:r}}function Jn(e){let[r,t,n]=e;return Gt({r:t==="0x"?0n:BigInt(t),s:n==="0x"?0n:BigInt(n),yParity:r==="0x"?0:Number(r)})}function Qn(e){return Ve(rn(e))}function rn(e){it(e);let r=e.r,t=e.s;return tt(ee(r,{size:32}),ee(t,{size:32}),typeof e.yParity=="number"?ee(Xt(e.yParity),{size:1}):"0x")}function Fn(e){return new Q.Signature(e.r,e.s).toDERRawBytes()}function eo(e){return`0x${new Q.Signature(e.r,e.s).toDERHex()}`}function to(e){return{r:e.r,s:e.s,v:Xt(e.yParity)}}function ro(e){let{r,s:t,yParity:n}=e;return{r:ee(r,{size:32}),s:ee(t,{size:32}),yParity:n===0?"0x0":"0x1"}}function no(e){let{r,s:t,yParity:n}=e;return[n?"0x01":"0x",r===0n?"0x":Zt(ee(r)),t===0n?"0x":Zt(ee(t))]}function oo(e,r={}){try{return it(e,r),!0}catch{return!1}}function ct(e){if(e===0||e===27)return 0;if(e===1||e===28)return 1;if(e>=35)return e%2===0?1:0;throw new st({value:e})}function Xt(e){if(e===0)return 27;if(e===1)return 28;throw new ve({value:e})}var rt=class extends q{constructor({signature:r}){super(`Value \`${r}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${te(se(r))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}},Re=class extends q{constructor({signature:r}){super(`Signature \`${me(r)}\` is missing either an \`r\`, \`s\`, or \`yParity\` property.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.MissingPropertiesError"})}},nt=class extends q{constructor({value:r}){super(`Value \`${r}\` is an invalid r value. r must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidRError"})}},ot=class extends q{constructor({value:r}){super(`Value \`${r}\` is an invalid s value. s must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSError"})}},ve=class extends q{constructor({value:r}){super(`Value \`${r}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}},st=class extends q{constructor({value:r}){super(`Value \`${r}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}};var gn={};fr(gn,{createKeyPair:()=>lo,getPublicKey:()=>pn,getSharedSecret:()=>mo,noble:()=>uo,randomPrivateKey:()=>hn,recoverAddress:()=>yn,recoverPublicKey:()=>bn,sign:()=>xo,verify:()=>po});m();p();x();m();p();x();m();p();x();m();p();x();var ft=class extends Map{constructor(r){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=r}get(r){let t=super.get(r);return super.has(r)&&t!==void 0&&(this.delete(r),super.set(r,t)),t}set(r,t){if(super.set(r,t),this.maxSize&&this.size>this.maxSize){let n=this.keys().next().value;n&&this.delete(n)}return this}};var so={checksum:new ft(8192)},at=so.checksum;m();p();x();function Jt(e,r={}){let{as:t=typeof e=="string"?"Hex":"Bytes"}=r,n=dr(Te(e));return t==="Bytes"?n:F(n)}m();p();x();function cn(e,r={}){let{compressed:t}=r,{prefix:n,x:o,y:s}=e;if(t===!1||typeof o=="bigint"&&typeof s=="bigint"){if(n!==4)throw new ut({prefix:n,cause:new er});return}if(t===!0||typeof o=="bigint"&&typeof s>"u"){if(n!==3&&n!==2)throw new ut({prefix:n,cause:new Ft});return}throw new Qt({publicKey:e})}function rr(e){let r=(()=>{if(Dt(e))return fn(e);if(Xr(e))return io(e);let{prefix:t,x:n,y:o}=e;return typeof n=="bigint"&&typeof o=="bigint"?{prefix:t??4,x:n,y:o}:{prefix:t,x:n}})();return cn(r),r}function io(e){return fn(F(e))}function fn(e){if(e.length!==132&&e.length!==130&&e.length!==68)throw new tr({publicKey:e});if(e.length===130){let n=BigInt(ne(e,0,32)),o=BigInt(ne(e,32,64));return{prefix:4,x:n,y:o}}if(e.length===132){let n=Number(ne(e,0,1)),o=BigInt(ne(e,1,33)),s=BigInt(ne(e,33,65));return{prefix:n,x:o,y:s}}let r=Number(ne(e,0,1)),t=BigInt(ne(e,1,33));return{prefix:r,x:t}}function an(e,r={}){return Ve(Ke(e,r))}function Ke(e,r={}){cn(e);let{prefix:t,x:n,y:o}=e,{includePrefix:s=!0}=r;return tt(s?ee(t,{size:1}):"0x",ee(n,{size:32}),typeof o=="bigint"?ee(o,{size:32}):"0x")}var Qt=class extends q{constructor({publicKey:r}){super(`Value \`${me(r)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}},ut=class extends q{constructor({prefix:r,cause:t}){super(`Prefix "${r}" is invalid.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}},Ft=class extends q{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}},er=class extends q{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}},tr=class extends q{constructor({publicKey:r}){super(`Value \`${r}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${te(se(r))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}};var co=/^0x[a-fA-F0-9]{40}$/;function lt(e,r={}){let{strict:t=!0}=r;if(!co.test(e))throw new dt({address:e,cause:new or});if(t){if(e.toLowerCase()===e)return;if(un(e)!==e)throw new dt({address:e,cause:new sr})}}function un(e){if(at.has(e))return at.get(e);lt(e,{strict:!1});let r=e.substring(2).toLowerCase(),t=Jt(Gr(r),{as:"Bytes"}),n=r.split("");for(let s=0;s<40;s+=2)t[s>>1]>>4>=8&&n[s]&&(n[s]=n[s].toUpperCase()),(t[s>>1]&15)>=8&&n[s+1]&&(n[s+1]=n[s+1].toUpperCase());let o=`0x${n.join("")}`;return at.set(e,o),o}function fo(e,r={}){let{checksum:t=!1}=r;return lt(e),t?un(e):e}function ln(e,r={}){let t=Jt(`0x${Ke(e).slice(4)}`).substring(26);return fo(`0x${t}`,r)}function dn(e,r){return lt(e,{strict:!1}),lt(r,{strict:!1}),e.toLowerCase()===r.toLowerCase()}var dt=class extends q{constructor({address:r,cause:t}){super(`Address "${r}" is invalid.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}},or=class extends q{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}},sr=class extends q{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}};m();p();x();var xn=!1;var uo=Q;function lo(e={}){let{as:r="Hex"}=e,t=hn({as:r}),n=pn({privateKey:t});return{privateKey:t,publicKey:n}}function pn(e){let{privateKey:r}=e,t=Q.ProjectivePoint.fromPrivateKey(se(r).slice(2));return rr(t)}function mo(e){let{as:r="Hex",privateKey:t,publicKey:n}=e,c=Q.ProjectivePoint.fromHex(Ke(n).slice(2)).multiply(Q.utils.normPrivateKeyToScalar(se(t).slice(2))).toRawBytes(!0);return r==="Hex"?F(c):c}function hn(e={}){let{as:r="Hex"}=e,t=Q.utils.randomPrivateKey();return r==="Hex"?F(t):t}function yn(e){return ln(bn(e))}function bn(e){let{payload:r,signature:t}=e,{r:n,s:o,yParity:s}=t,f=new Q.Signature(BigInt(n),BigInt(o)).addRecoveryBit(s).recoverPublicKey(se(r).substring(2));return rr(f)}function xo(e){let{extraEntropy:r=xn,hash:t,payload:n,privateKey:o}=e,{r:s,s:c,recovery:f}=Q.sign(Te(n),Te(o),{extraEntropy:typeof r=="boolean"?r:se(r).slice(2),lowS:!0,...t?{prehash:!0}:{}});return{r:s,s:c,yParity:f}}function po(e){let{address:r,hash:t,payload:n,publicKey:o,signature:s}=e;return r?dn(r,yn({payload:n,signature:s})):Q.verify(s,Te(n),an(o),...t?[{prehash:!0,lowS:!0}]:[])}m();p();x();m();p();x();m();p();x();m();p();x();function Se(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ze(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Se(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function ho(e,r){r||(r=e.reduce((o,s)=>o+s.length,0));let t=Ze(r),n=0;for(let o of e)t.set(o,n),n+=o.length;return Se(t)}m();p();x();m();p();x();function Bn(e,r,t,n){return{name:e,prefix:r,encoder:{name:e,prefix:r,encode:t},decoder:{decode:n}}}var wn=Bn("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),ir=Bn("ascii","a",e=>{let r="a";for(let t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r},e=>{e=e.substring(1);let r=Ze(e.length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}),yo={utf8:wn,"utf-8":wn,hex:ht.base16,latin1:ir,ascii:ir,binary:ir,...ht},mt=yo;function bo(e,r="utf8"){let t=mt[r];if(!t)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Se(globalThis.Buffer.from(e,"utf-8")):t.decoder.decode(`${t.prefix}${e}`)}m();p();x();function go(e,r="utf8"){let t=mt[r];if(!t)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):t.encoder.encode(e).substring(1)}m();p();x();m();p();x();m();p();x();m();p();x();export{nn as a,gn as b,ho as c,bo as d,go as e};
/*! Bundled license information:

@noble/curves/esm/abstract/utils.js:
@noble/curves/esm/abstract/modular.js:
@noble/curves/esm/abstract/curve.js:
@noble/curves/esm/abstract/weierstrass.js:
@noble/curves/esm/_shortw_utils.js:
@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
