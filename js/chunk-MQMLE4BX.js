import{D as I,G as T,I as m,J as F,a as g,h as B,i as L,j as A,k as b,t as p,u as x,w as d,x as H,y as S,z as k}from"./chunk-EDRI7XUL.js";import{i as O,k as w,o as y}from"./chunk-JY5TIRRF.js";O();y();w();var v=BigInt(0),a=BigInt(1),z=BigInt(2),C=BigInt(7),D=BigInt(256),G=BigInt(113),U=[],P=[],M=[];for(let n=0,t=a,s=1,o=0;n<24;n++){[s,o]=[o,(2*s+3*o)%5],U.push(2*(5*o+s)),P.push((n+1)*(n+2)/2%64);let i=v;for(let r=0;r<7;r++)t=(t<<a^(t>>C)*G)%D,t&z&&(i^=a<<(a<<BigInt(r))-a);M.push(i)}var R=g(M,!0),J=R[0],N=R[1],X=(n,t,s)=>s>32?A(n,t,s):B(n,t,s),E=(n,t,s)=>s>32?b(n,t,s):L(n,t,s);function Q(n,t=24){let s=new Uint32Array(10);for(let o=24-t;o<24;o++){for(let e=0;e<10;e++)s[e]=n[e]^n[e+10]^n[e+20]^n[e+30]^n[e+40];for(let e=0;e<10;e+=2){let h=(e+8)%10,f=(e+2)%10,u=s[f],c=s[f+1],j=X(u,c,1)^s[h],q=E(u,c,1)^s[h+1];for(let l=0;l<50;l+=10)n[e+l]^=j,n[e+l+1]^=q}let i=n[2],r=n[3];for(let e=0;e<24;e++){let h=P[e],f=X(i,r,h),u=E(i,r,h),c=U[e];i=n[c],r=n[c+1],n[c]=f,n[c+1]=u}for(let e=0;e<50;e+=10){for(let h=0;h<10;h++)s[h]=n[e+h];for(let h=0;h<10;h++)n[e+h]^=~s[(h+2)%10]&s[(h+4)%10]}n[0]^=J[o],n[1]^=N[o]}k(s)}var _=class n extends m{constructor(t,s,o,i=!1,r=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=s,this.outputLen=o,this.enableXOF=i,this.rounds=r,p(o),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=S(this.state)}clone(){return this._cloneInto()}keccak(){I(this.state32),Q(this.state32,this.rounds),I(this.state32),this.posOut=0,this.pos=0}update(t){d(this),t=T(t),x(t);let{blockLen:s,state:o}=this,i=t.length;for(let r=0;r<i;){let e=Math.min(s-this.pos,i-r);for(let h=0;h<e;h++)o[this.pos++]^=t[r++];this.pos===s&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:s,pos:o,blockLen:i}=this;t[o]^=s,(s&128)!==0&&o===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){d(this,!1),x(t),this.finish();let s=this.state,{blockLen:o}=this;for(let i=0,r=t.length;i<r;){this.posOut>=o&&this.keccak();let e=Math.min(o-this.posOut,r-i);t.set(s.subarray(this.posOut,this.posOut+e),i),this.posOut+=e,i+=e}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return p(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(H(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,k(this.state)}_cloneInto(t){let{blockLen:s,suffix:o,outputLen:i,rounds:r,enableXOF:e}=this;return t||(t=new n(s,o,i,e,r)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=r,t.suffix=o,t.outputLen=i,t.enableXOF=e,t.destroyed=this.destroyed,t}},V=(n,t,s)=>F(()=>new _(t,n,s));var st=V(1,136,256/8);export{st as a};
