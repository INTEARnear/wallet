import{a as R}from"./chunk-4PLPFPWC.js";import{c as I}from"./chunk-W4MYE3I6.js";import{C as f,F as C,K as x,M as B,f as D,q as N,r as h,s as u}from"./chunk-N2WXLAZF.js";import{i as E,k as W,o as y}from"./chunk-JY5TIRRF.js";E();y();W();E();y();W();var O={getConnectorsByType(e,n,r){let{customWallets:s}=u.state,l=N.getRecentWallets(),i=g.filterOutDuplicateWallets(n),o=g.filterOutDuplicateWallets(r),t=e.filter(c=>c.type==="MULTI_CHAIN"),m=e.filter(c=>c.type==="ANNOUNCED"),d=e.filter(c=>c.type==="INJECTED"),p=e.filter(c=>c.type==="EXTERNAL");return{custom:s,recent:l,external:p,multiChain:t,announced:m,injected:d,recommended:i,featured:o}},showConnector(e){let n=e.info?.rdns,r=!!n&&f.state.excludedWallets.some(l=>!!l.rdns&&l.rdns===n),s=!!e.name&&f.state.excludedWallets.some(l=>I.isLowerCaseMatch(l.name,e.name));return!(e.type==="INJECTED"&&(e.name==="Browser Wallet"&&(!h.isMobile()||h.isMobile()&&!n&&!x.checkInstalled())||r||s)||(e.type==="ANNOUNCED"||e.type==="EXTERNAL")&&(r||s))},getIsConnectedWithWC(){return Array.from(B.state.chains.values()).some(r=>C.getConnectorId(r.namespace)===D.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:e,featured:n,custom:r,recent:s,announced:l,injected:i,multiChain:o,external:t,overriddenConnectors:m=u.state.features?.connectorTypeOrder??[]}){let c=[{type:"walletConnect",isEnabled:u.state.enableWalletConnect},{type:"recent",isEnabled:s.length>0},{type:"injected",isEnabled:[...i,...l,...o].length>0},{type:"featured",isEnabled:n.length>0},{type:"custom",isEnabled:r&&r.length>0},{type:"external",isEnabled:t.length>0},{type:"recommended",isEnabled:e.length>0}].filter(a=>a.isEnabled),T=new Set(c.map(a=>a.type)),b=m.filter(a=>T.has(a)).map(a=>({type:a,isEnabled:!0})),A=c.filter(({type:a})=>!b.some(({type:U})=>U===a));return Array.from(new Set([...b,...A].map(({type:a})=>a)))},getAuthName({email:e,socialUsername:n,socialProvider:r}){return n?r&&r==="discord"&&n.endsWith("0")?n.slice(0,-1):n:e.length>30?`${e.slice(0,-3)}...`:e},async fetchProviderData(e){try{if(e.name==="Browser Wallet"&&!h.isMobile())return{accounts:[],chainId:void 0};if(e.id===D.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};let[n,r]=await Promise.all([e.provider?.request({method:"eth_accounts"}),e.provider?.request({method:"eth_chainId"}).then(s=>Number(s))]);return{accounts:n,chainId:r}}catch(n){return console.warn(`Failed to fetch provider data for ${e.name}`,n),{accounts:[],chainId:void 0}}}};var g={filterOutDuplicatesByRDNS(e){let n=u.state.enableEIP6963?C.state.connectors:[],r=N.getRecentWallets(),s=n.map(t=>t.info?.rdns).filter(Boolean),l=r.map(t=>t.rdns).filter(Boolean),i=s.concat(l);if(i.includes("io.metamask.mobile")&&h.isMobile()){let t=i.indexOf("io.metamask.mobile");i[t]="io.metamask"}return e.filter(t=>!(t?.rdns&&i.includes(String(t.rdns))||!t?.rdns&&n.some(d=>d.name===t.name)))},filterOutDuplicatesByIds(e){let n=C.state.connectors.filter(t=>t.type==="ANNOUNCED"||t.type==="INJECTED"),r=N.getRecentWallets(),s=n.map(t=>t.explorerId),l=r.map(t=>t.id),i=s.concat(l);return e.filter(t=>!i.includes(t?.id))},filterOutDuplicateWallets(e){let n=this.filterOutDuplicatesByRDNS(e);return this.filterOutDuplicatesByIds(n)},markWalletsAsInstalled(e){let{connectors:n}=C.state,{featuredWalletIds:r}=u.state,s=n.filter(o=>o.type==="ANNOUNCED").reduce((o,t)=>(t.info?.rdns&&(o[t.info.rdns]=!0),o),{});return e.map(o=>({...o,installed:!!o.rdns&&!!s[o.rdns??""]})).sort((o,t)=>{let m=Number(t.installed)-Number(o.installed);if(m!==0)return m;if(r?.length){let d=r.indexOf(o.id),p=r.indexOf(t.id);if(d!==-1&&p!==-1)return d-p;if(d!==-1)return-1;if(p!==-1)return 1}return 0})},getConnectOrderMethod(e,n){let r=e?.connectMethodsOrder||u.state.features?.connectMethodsOrder,s=n||C.state.connectors;if(r)return r;let{injected:l,announced:i}=O.getConnectorsByType(s,f.state.recommended,f.state.featured),o=l.filter(O.showConnector),t=i.filter(O.showConnector);return o.length||t.length?["wallet","email","social"]:R.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(e){let n=!!e.rdns&&f.state.excludedWallets.some(s=>s.rdns===e.rdns),r=!!e.name&&f.state.excludedWallets.some(s=>I.isLowerCaseMatch(s.name,e.name));return n||r}};export{g as a,O as b};
