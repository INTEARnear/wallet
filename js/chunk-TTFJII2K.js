import{D as a,F as n,b as f,j as m,k as t,p as u,r as i,t as p,z as s}from"./chunk-ORERQN7J.js";function S(){try{return t.returnOpenHref(`${f.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes")}catch{throw new Error("Could not open social popup")}}async function h(){i.push("ConnectingFarcaster");let o=p.getAuthConnector();if(o&&!n.state.farcasterUrl)try{let{url:e}=await o.provider.getFarcasterUri();n.setFarcasterUrl(e,a.state.activeChain)}catch(e){i.goBack(),s.showError(e)}}async function C(o){i.push("ConnectingSocial");let e=p.getAuthConnector(),r=null;try{let c=setTimeout(()=>{throw new Error("Social login timed out. Please try again.")},45e3);if(e&&o){if(t.isTelegram()||(r=S()),r)n.setSocialWindow(r,a.state.activeChain);else if(!t.isTelegram())throw new Error("Could not create social popup");let{uri:l}=await e.provider.getSocialRedirectUri({provider:o});if(!l)throw r?.close(),new Error("Could not fetch the social redirect uri");if(r&&(r.location.href=l),t.isTelegram()){m.setTelegramSocialProvider(o);let g=t.formatTelegramSocialLoginUrl(l);t.openHref(g,"_top")}clearTimeout(c)}}catch(c){r?.close(),s.showError(c?.message)}}async function w(o){n.setSocialProvider(o,a.state.activeChain),u.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:o}}),o==="farcaster"?await h():await C(o)}export{w as a};
