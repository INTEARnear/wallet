import{a as x}from"./chunk-KG5GTMNR.js";import{c as N}from"./chunk-C76LFVKJ.js";import{D as g,G as b,b as I,k as W,l as h,m as d,r as u,u as m}from"./chunk-AXPE5NAX.js";var E={getConnectorsByType(e,o,n){let{customWallets:r}=d.state,l=W.getRecentWallets(),i=y.filterOutDuplicateWallets(o),s=y.filterOutDuplicateWallets(n),t=e.filter(c=>c.type==="MULTI_CHAIN"),C=e.filter(c=>c.type==="ANNOUNCED"),f=e.filter(c=>c.type==="INJECTED"),p=e.filter(c=>c.type==="EXTERNAL");return{custom:r,recent:l,external:p,multiChain:t,announced:C,injected:f,recommended:i,featured:s}},showConnector(e){let o=e.info?.rdns,n=!!o&&u.state.excludedWallets.some(l=>!!l.rdns&&l.rdns===o),r=!!e.name&&u.state.excludedWallets.some(l=>N.isLowerCaseMatch(l.name,e.name));return!(e.type==="INJECTED"&&(e.name==="Browser Wallet"&&(!h.isMobile()||h.isMobile()&&!o&&!g.checkInstalled())||n||r)||(e.type==="ANNOUNCED"||e.type==="EXTERNAL")&&(n||r))},getIsConnectedWithWC(){return Array.from(b.state.chains.values()).some(n=>m.getConnectorId(n.namespace)===I.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:e,featured:o,custom:n,recent:r,announced:l,injected:i,multiChain:s,external:t,overriddenConnectors:C=d.state.features?.connectorTypeOrder??[]}){let f=E.getIsConnectedWithWC(),O=[{type:"walletConnect",isEnabled:d.state.enableWalletConnect&&!f},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...l,...s].length>0},{type:"featured",isEnabled:o.length>0},{type:"custom",isEnabled:n&&n.length>0},{type:"external",isEnabled:t.length>0},{type:"recommended",isEnabled:e.length>0}].filter(a=>a.isEnabled),B=new Set(O.map(a=>a.type)),D=C.filter(a=>B.has(a)).map(a=>({type:a,isEnabled:!0})),R=O.filter(({type:a})=>!D.some(({type:U})=>U===a));return Array.from(new Set([...D,...R].map(({type:a})=>a)))}};var y={filterOutDuplicatesByRDNS(e){let o=d.state.enableEIP6963?m.state.connectors:[],n=W.getRecentWallets(),r=o.map(t=>t.info?.rdns).filter(Boolean),l=n.map(t=>t.rdns).filter(Boolean),i=r.concat(l);if(i.includes("io.metamask.mobile")&&h.isMobile()){let t=i.indexOf("io.metamask.mobile");i[t]="io.metamask"}return e.filter(t=>!i.includes(String(t?.rdns)))},filterOutDuplicatesByIds(e){let o=m.state.connectors.filter(t=>t.type==="ANNOUNCED"||t.type==="INJECTED"),n=W.getRecentWallets(),r=o.map(t=>t.explorerId),l=n.map(t=>t.id),i=r.concat(l);return e.filter(t=>!i.includes(t?.id))},filterOutDuplicateWallets(e){let o=this.filterOutDuplicatesByRDNS(e);return this.filterOutDuplicatesByIds(o)},markWalletsAsInstalled(e){let{connectors:o}=m.state,{featuredWalletIds:n}=d.state,r=o.filter(s=>s.type==="ANNOUNCED").reduce((s,t)=>(t.info?.rdns&&(s[t.info.rdns]=!0),s),{});return e.map(s=>({...s,installed:!!s.rdns&&!!r[s.rdns??""]})).sort((s,t)=>{let C=Number(t.installed)-Number(s.installed);if(C!==0)return C;if(n?.length){let f=n.indexOf(s.id),p=n.indexOf(t.id);if(f!==-1&&p!==-1)return f-p;if(f!==-1)return-1;if(p!==-1)return 1}return 0})},getConnectOrderMethod(e,o){let n=e?.connectMethodsOrder||d.state.features?.connectMethodsOrder,r=o||m.state.connectors;if(n)return n;let{injected:l,announced:i}=E.getConnectorsByType(r,u.state.recommended,u.state.featured),s=l.filter(E.showConnector),t=i.filter(E.showConnector);return s.length||t.length?["wallet","email","social"]:x.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(e){let o=!!e.rdns&&u.state.excludedWallets.some(r=>r.rdns===e.rdns),n=!!e.name&&u.state.excludedWallets.some(r=>N.isLowerCaseMatch(r.name,e.name));return o||n}};export{y as a,E as b};
