import{D as p,F as n,b as h,j as C,k as t,p as g,r as l,t as m,z as u}from"./chunk-WYPOXQ7L.js";import{h as i,j as a,n as c}from"./chunk-KGCAX4NX.js";i();c();a();function T(){try{return t.returnOpenHref(`${h.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes")}catch{throw new Error("Could not open social popup")}}async function S(){l.push("ConnectingFarcaster");let o=m.getAuthConnector();if(o&&!n.state.farcasterUrl)try{let{url:e}=await o.provider.getFarcasterUri();n.setFarcasterUrl(e,p.state.activeChain)}catch(e){l.goBack(),u.showError(e)}}async function w(o){l.push("ConnectingSocial");let e=m.getAuthConnector(),r=null;try{let s=setTimeout(()=>{throw new Error("Social login timed out. Please try again.")},45e3);if(e&&o){if(t.isTelegram()||(r=T()),r)n.setSocialWindow(r,p.state.activeChain);else if(!t.isTelegram())throw new Error("Could not create social popup");let{uri:f}=await e.provider.getSocialRedirectUri({provider:o});if(!f)throw r?.close(),new Error("Could not fetch the social redirect uri");if(r&&(r.location.href=f),t.isTelegram()){C.setTelegramSocialProvider(o);let U=t.formatTelegramSocialLoginUrl(f);t.openHref(U,"_top")}clearTimeout(s)}}catch(s){r?.close(),u.showError(s?.message)}}async function y(o){n.setSocialProvider(o,p.state.activeChain),g.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:o}}),o==="farcaster"?await S():await w(o)}i();c();a();export{y as a};
