import{a as cp,b as Fa}from"./chunk-HQPTEMSB.js";import{a as Se,f as lp}from"./chunk-IDZGCU4F.js";import{a as Dt,b as pt,e as Ki,f as ee,k as cn}from"./chunk-ZS2R6O6N.js";import{a as $a,b as Is,c as _s,d as Yh,e as Jh,f as Qh,g as Wn,h as Da,i as ep,j as tp,k as rp,l as C1,m as sp,n as np,o as ip,p as an,q as op,r as I1,s as ap}from"./chunk-SQN7L5MN.js";import{a as on}from"./chunk-7GZ7JYLK.js";import{a as ja,b as Xh,d as Ir,e as _r,f as Ct,g as Wr,h as Hi,k as Zn,l as Yn,m as Zt,n as jt,o as qa,p as Xn,q as Vi}from"./chunk-6HADIPAO.js";import{a as Cs,b as fr,d as zi}from"./chunk-XQOHLC2A.js";import{A as Vn,B as Re,C as sn,H as Oe,I as _e,J as Le,L as Wt,O as nt,P as Fi,S as ye,U as pr,V as Kn,X as Gr,Y as Gn,aa as ht,ba as Zh,d as lt,da as Mi,e as $t,ea as nn,ga as J,h as ut,i as La,ia as St,j as we,l as Ce,q as Es,s as Fh,x as Ua,y as Mh,z as Ss}from"./chunk-OXOEMY67.js";import{b as Gh,e as Wh}from"./chunk-6ZQQ3XQO.js";import{a as Kh}from"./chunk-MQMLE4BX.js";import{H as Hh,K as Vh,t as zh}from"./chunk-EDRI7XUL.js";import{e as qh,g as xs,i as m,j as $,k as y,l as P,o as w}from"./chunk-JY5TIRRF.js";m();w();y();var Jn={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},Ma={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},_1={providers:Ua,selectedProvider:null,error:null,purchaseCurrency:Jn,paymentCurrency:Ma,purchaseCurrencies:[Jn],paymentCurrencies:[],quotesLoading:!1},le=lt(_1),T1={state:le,subscribe(e){return $t(le,()=>e(le))},subscribeKey(e,t){return ut(le,e,t)},setSelectedProvider(e){if(e&&e.name==="meld"){let t=J.state.activeChain,r=t===we.CHAIN.SOLANA?"SOL":"USDC",s=t?J.state.chains.get(t)?.accountState?.address??"":"",n=new URL(e.url);n.searchParams.append("publicKey",Mh),n.searchParams.append("destinationCurrencyCode",r),n.searchParams.append("walletAddress",s),n.searchParams.append("externalCustomerId",Oe.state.projectId),le.selectedProvider={...e,url:n.toString()}}else le.selectedProvider=e},setOnrampProviders(e){if(Array.isArray(e)&&e.every(t=>typeof t=="string")){let t=e,r=Ua.filter(s=>t.includes(s.name));le.providers=r}else le.providers=[]},setPurchaseCurrency(e){le.purchaseCurrency=e},setPaymentCurrency(e){le.paymentCurrency=e},setPurchaseAmount(e){za.state.purchaseAmount=e},setPaymentAmount(e){za.state.paymentAmount=e},async getAvailableCurrencies(){let e=await Le.getOnrampOptions();le.purchaseCurrencies=e.purchaseCurrencies,le.paymentCurrencies=e.paymentCurrencies,le.paymentCurrency=e.paymentCurrencies[0]||Ma,le.purchaseCurrency=e.purchaseCurrencies[0]||Jn,await Fi.fetchCurrencyImages(e.paymentCurrencies.map(t=>t.id)),await Fi.fetchTokenImages(e.purchaseCurrencies.map(t=>t.symbol))},async getQuote(){le.quotesLoading=!0;try{let e=await Le.getOnrampQuote({purchaseCurrency:le.purchaseCurrency,paymentCurrency:le.paymentCurrency,amount:le.paymentAmount?.toString()||"0",network:le.purchaseCurrency?.symbol});return le.quotesLoading=!1,le.purchaseAmount=Number(e?.purchaseAmount.amount),e}catch(e){return le.error=e.message,le.quotesLoading=!1,null}finally{le.quotesLoading=!1}},resetState(){le.selectedProvider=null,le.error=null,le.purchaseCurrency=Jn,le.paymentCurrency=Ma,le.purchaseCurrencies=[Jn],le.paymentCurrencies=[],le.paymentAmount=void 0,le.purchaseAmount=void 0,le.quotesLoading=!1}},za=Wt(T1);m();w();y();m();w();y();var up={convertEVMChainIdToCoinType(e){if(e>=2147483648)throw new Error("Invalid chainId");return(2147483648|e)>>>0}};var qt=lt({suggestions:[],loading:!1}),A1={state:qt,subscribe(e){return $t(qt,()=>e(qt))},subscribeKey(e,t){return ut(qt,e,t)},async resolveName(e){try{return await Le.lookupEnsName(e)}catch(t){let r=t;throw new Error(r?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(e){try{return await Le.lookupEnsName(e),!0}catch{return!1}},async getSuggestions(e){try{qt.loading=!0,qt.suggestions=[];let t=await Le.getEnsNameSuggestions(e);return qt.suggestions=t.suggestions||[],qt.suggestions}catch(t){let r=ln.parseEnsApiError(t,"Error fetching name suggestions");throw new Error(r)}finally{qt.loading=!1}},async getNamesForAddress(e){try{if(!J.state.activeCaipNetwork)return[];let r=Vn.getEnsFromCacheForAddress(e);if(r)return r;let s=await Le.reverseLookupEnsName({address:e});return Vn.updateEnsCache({address:e,ens:s,timestamp:Date.now()}),s}catch(t){let r=ln.parseEnsApiError(t,"Error fetching names for address");throw new Error(r)}},async registerName(e){let t=J.state.activeCaipNetwork,r=J.getAccountData(t?.chainNamespace)?.address,s=pr.getAuthConnector();if(!t)throw new Error("Network not found");if(!r||!s)throw new Error("Address or auth connector not found");qt.loading=!0;try{let n=JSON.stringify({name:e,attributes:{},timestamp:Math.floor(Date.now()/1e3)});ye.pushTransactionStack({onCancel(){ye.replace("RegisterAccountName")}});let i=await ht.signMessage(n);qt.loading=!1;let o=t.id;if(!o)throw new Error("Network not found");let a=up.convertEVMChainIdToCoinType(Number(o));await Le.registerEnsName({coinType:a,address:r,signature:i,message:n}),J.setAccountProp("profileName",e,t.chainNamespace),Vn.updateEnsCache({address:r,ens:[{name:e,registered_at:new Date().toISOString(),updated_at:void 0,addresses:{},attributes:[]}],timestamp:Date.now()}),ye.replace("RegisterAccountNameSuccess")}catch(n){let i=ln.parseEnsApiError(n,`Error registering name ${e}`);throw ye.replace("RegisterAccountName"),new Error(i)}finally{qt.loading=!1}},validateName(e){return/^[a-zA-Z0-9-]{4,}$/u.test(e)},parseEnsApiError(e,t){return e?.reasons?.[0]?.description||t}},ln=Wt(A1);m();w();y();m();w();y();m();w();y();zi();m();w();y();zi();m();w();y();var dr={exports:{}};function P1(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}var O1=k1;function k1(e,t,r){var s=r&&r.stringify||P1,n=1;if(typeof e=="object"&&e!==null){var i=t.length+n;if(i===1)return e;var o=new Array(i);o[0]=s(e);for(var a=1;a<i;a++)o[a]=s(t[a]);return o.join(" ")}if(typeof e!="string")return e;var c=t.length;if(c===0)return e;for(var l="",u=1-n,h=-1,p=e&&e.length||0,f=0;f<p;){if(e.charCodeAt(f)===37&&f+1<p){switch(h=h>-1?h:0,e.charCodeAt(f+1)){case 100:case 102:if(u>=c||t[u]==null)break;h<f&&(l+=e.slice(h,f)),l+=Number(t[u]),h=f+2,f++;break;case 105:if(u>=c||t[u]==null)break;h<f&&(l+=e.slice(h,f)),l+=Math.floor(Number(t[u])),h=f+2,f++;break;case 79:case 111:case 106:if(u>=c||t[u]===void 0)break;h<f&&(l+=e.slice(h,f));var g=typeof t[u];if(g==="string"){l+="'"+t[u]+"'",h=f+2,f++;break}if(g==="function"){l+=t[u].name||"<anonymous>",h=f+2,f++;break}l+=s(t[u]),h=f+2,f++;break;case 115:if(u>=c)break;h<f&&(l+=e.slice(h,f)),l+=String(t[u]),h=f+2,f++;break;case 37:h<f&&(l+=e.slice(h,f)),l+="%",h=f+2,f++,u--;break}++u}++f}return h===-1?e:(h<p&&(l+=e.slice(h)),l)}var hp=O1;dr.exports=Tr;var Qn=K1().console||{},N1={mapHttpRequest:Gi,mapHttpResponse:Gi,wrapRequestSerializer:Ha,wrapResponseSerializer:Ha,wrapErrorSerializer:Ha,req:Gi,res:Gi,err:fp,errWithCause:fp};function Yr(e,t){return e==="silent"?1/0:t.levels.values[e]}var Ya=Symbol("pino.logFuncs"),Va=Symbol("pino.hierarchy"),R1={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function pp(e,t){let r={logger:t,parent:e[Va]};t[Va]=r}function B1(e,t,r){let s={};t.forEach(n=>{s[n]=r[n]?r[n]:Qn[n]||Qn[R1[n]||"log"]||un}),e[Ya]=s}function L1(e,t){return Array.isArray(e)?e.filter(function(r){return r!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function Tr(e){e=e||{},e.browser=e.browser||{};let t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");let r=e.browser.write||Qn;e.browser.write&&(e.browser.asObject=!0);let s=e.serializers||{},n=L1(e.browser.serialize,s),i=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);let o=Object.keys(e.customLevels||{}),a=["error","fatal","warn","info","debug","trace"].concat(o);typeof r=="function"&&a.forEach(function(d){r[d]=r}),(e.enabled===!1||e.browser.disabled)&&(e.level="silent");let c=e.level||"info",l=Object.create(r);l.log||(l.log=un),B1(l,a,r),pp({},l),Object.defineProperty(l,"levelVal",{get:h}),Object.defineProperty(l,"level",{get:p,set:f});let u={transmit:t,serialize:n,asObject:e.browser.asObject,asObjectBindingsOnly:e.browser.asObjectBindingsOnly,formatters:e.browser.formatters,levels:a,timestamp:z1(e),messageKey:e.messageKey||"msg",onChild:e.onChild||un};l.levels=U1(e),l.level=c,l.isLevelEnabled=function(d){return this.levels.values[d]?this.levels.values[d]>=this.levels.values[this.level]:!1},l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=un,l.serializers=s,l._serialize=n,l._stdErrSerialize=i,l.child=function(...d){return g.call(this,u,...d)},t&&(l._logEvent=Ka());function h(){return Yr(this.level,this)}function p(){return this._level}function f(d){if(d!=="silent"&&!this.levels.values[d])throw Error("unknown level "+d);this._level=d,Ts(this,u,l,"error"),Ts(this,u,l,"fatal"),Ts(this,u,l,"warn"),Ts(this,u,l,"info"),Ts(this,u,l,"debug"),Ts(this,u,l,"trace"),o.forEach(b=>{Ts(this,u,l,b)})}function g(d,b,k){if(!b)throw new Error("missing bindings for child Pino");k=k||{},n&&b.serializers&&(k.serializers=b.serializers);let q=k.serializers;if(n&&q){var T=Object.assign({},s,q),I=e.browser.serialize===!0?Object.keys(T):n;delete b.serializers,Xa([b],I,T,this._stdErrSerialize)}function L(j){this._childLevel=(j._childLevel|0)+1,this.bindings=b,T&&(this.serializers=T,this._serialize=I),t&&(this._logEvent=Ka([].concat(j._logEvent.bindings,b)))}L.prototype=this;let R=new L(this);return pp(this,R),R.child=function(...j){return g.call(this,d,...j)},R.level=k.level||this.level,d.onChild(R),R}return l}function U1(e){let t=e.customLevels||{},r=Object.assign({},Tr.levels.values,t),s=Object.assign({},Tr.levels.labels,$1(t));return{values:r,labels:s}}function $1(e){let t={};return Object.keys(e).forEach(function(r){t[e[r]]=r}),t}Tr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Tr.stdSerializers=N1,Tr.stdTimeFunctions=Object.assign({},{nullTime:yp,epochTime:wp,unixTime:H1,isoTime:V1});function j1(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[Va];for(;r.parent;)r=r.parent,r.logger.bindings&&t.push(r.logger.bindings);return t.reverse()}function Ts(e,t,r,s){if(Object.defineProperty(e,s,{value:Yr(e.level,r)>Yr(s,r)?un:r[Ya][s],writable:!0,enumerable:!0,configurable:!0}),e[s]===un){if(!t.transmit)return;let i=t.transmit.level||e.level,o=Yr(i,r);if(Yr(s,r)<o)return}e[s]=q1(e,t,r,s);let n=j1(e);n.length!==0&&(e[s]=D1(n,e[s]))}function D1(e,t){return function(){return t.apply(this,[...e,...arguments])}}function q1(e,t,r,s){return function(n){return function(){let i=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Qn?Qn:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];var l=!1;if(t.serialize&&(Xa(o,this._serialize,this.serializers,this._stdErrSerialize),l=!0),t.asObject||t.formatters?n.call(a,...F1(this,s,o,i,t)):n.apply(a,o),t.transmit){let u=t.transmit.level||e._level,h=Yr(u,r),p=Yr(s,r);if(p<h)return;M1(this,{ts:i,methodLevel:s,methodValue:p,transmitLevel:u,transmitValue:r.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:Yr(e._level,r)},o,l)}}}(e[Ya][s])}function F1(e,t,r,s,n){let{level:i,log:o=h=>h}=n.formatters||{},a=r.slice(),c=a[0],l={},u=(e._childLevel|0)+1;if(u<1&&(u=1),s&&(l.time=s),i){let h=i(t,e.levels.values[t]);Object.assign(l,h)}else l.level=e.levels.values[t];if(n.asObjectBindingsOnly){if(c!==null&&typeof c=="object")for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());return[o(l),...a]}else{if(c!==null&&typeof c=="object"){for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());c=a.length?hp(a.shift(),a):void 0}else typeof c=="string"&&(c=hp(a.shift(),a));return c!==void 0&&(l[n.messageKey]=c),[o(l)]}}function Xa(e,t,r,s){for(let n in e)if(s&&e[n]instanceof Error)e[n]=Tr.stdSerializers.err(e[n]);else if(typeof e[n]=="object"&&!Array.isArray(e[n])&&t)for(let i in e[n])t.indexOf(i)>-1&&i in r&&(e[n][i]=r[i](e[n][i]))}function M1(e,t,r,s=!1){let n=t.send,i=t.ts,o=t.methodLevel,a=t.methodValue,c=t.val,l=e._logEvent.bindings;s||Xa(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter(function(u){return l.indexOf(u)===-1}),e._logEvent.level.label=o,e._logEvent.level.value=a,n(o,e._logEvent,c),e._logEvent=Ka(l)}function Ka(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function fp(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)t[r]===void 0&&(t[r]=e[r]);return t}function z1(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?yp:wp}function Gi(){return{}}function Ha(e){return e}function un(){}function yp(){return!1}function wp(){return Date.now()}function H1(){return Math.round(Date.now()/1e3)}function V1(){return new Date(Date.now()).toISOString()}function K1(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}dr.exports.default=Tr;var gS=dr.exports.pino=Tr,G1={level:"info"},Qi="custom_context",Ja=1e3*1024,W1=Object.defineProperty,Z1=(e,t,r)=>t in e?W1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Zr=(e,t,r)=>Z1(e,typeof t!="symbol"?t+"":t,r),Ga=class{constructor(t){Zr(this,"nodeValue"),Zr(this,"sizeInBytes"),Zr(this,"next"),this.nodeValue=t,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Zi=class{constructor(t){Zr(this,"lengthInNodes"),Zr(this,"sizeInBytes"),Zr(this,"head"),Zr(this,"tail"),Zr(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=t,this.sizeInBytes=0}append(t){let r=new Ga(t);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${t} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;let t=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=t.size}toArray(){let t=[],r=this.head;for(;r!==null;)t.push(r.value),r=r.next;return t}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let t=this.head;return{next:()=>{if(!t)return{done:!0,value:null};let r=t.value;return t=t.next,{done:!1,value:r}}}}},Y1=e=>JSON.stringify(e,(t,r)=>typeof r=="bigint"?r.toString()+"n":r);function dp(e){return typeof e=="string"?e:Y1(e)||""}var X1=Object.defineProperty,J1=(e,t,r)=>t in e?X1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Wi=(e,t,r)=>J1(e,typeof t!="symbol"?t+"":t,r),Yi=class{constructor(t,r=Ja){Wi(this,"logs"),Wi(this,"level"),Wi(this,"levelValue"),Wi(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=t??"error",this.levelValue=dr.exports.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new Zi(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(t,r){r===dr.exports.levels.values.error?console.error(t):r===dr.exports.levels.values.warn?console.warn(t):r===dr.exports.levels.values.debug?console.debug(t):r===dr.exports.levels.values.trace?console.trace(t):console.log(t)}appendToLogs(t){this.logs.append(dp({timestamp:new Date().toISOString(),log:t}));let r=typeof t=="string"?JSON.parse(t).level:t.level;r>=this.levelValue&&this.forwardToConsole(t,r)}getLogs(){return this.logs}clearLogs(){this.logs=new Zi(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(t){let r=this.getLogArray();return r.push(dp({extraMetadata:t})),new Blob(r,{type:"application/json"})}},Q1=Object.defineProperty,ey=(e,t,r)=>t in e?Q1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ty=(e,t,r)=>ey(e,typeof t!="symbol"?t+"":t,r),Wa=class{constructor(t,r=Ja){ty(this,"baseChunkLogger"),this.baseChunkLogger=new Yi(t,r)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}downloadLogsBlobInBrowser(t){let r=URL.createObjectURL(this.logsToBlob(t)),s=document.createElement("a");s.href=r,s.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}},ry=Object.defineProperty,sy=(e,t,r)=>t in e?ry(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ny=(e,t,r)=>sy(e,typeof t!="symbol"?t+"":t,r),Za=class{constructor(t,r=Ja){ny(this,"baseChunkLogger"),this.baseChunkLogger=new Yi(t,r)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}},iy=Object.defineProperty,oy=Object.defineProperties,ay=Object.getOwnPropertyDescriptors,gp=Object.getOwnPropertySymbols,cy=Object.prototype.hasOwnProperty,ly=Object.prototype.propertyIsEnumerable,mp=(e,t,r)=>t in e?iy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Xi=(e,t)=>{for(var r in t||(t={}))cy.call(t,r)&&mp(e,r,t[r]);if(gp)for(var r of gp(t))ly.call(t,r)&&mp(e,r,t[r]);return e},Ji=(e,t)=>oy(e,ay(t));function bp(e){return Ji(Xi({},e),{level:e?.level||G1.level})}function uy(e,t,r=Qi){return e[r]=t,e}function ft(e,t=Qi){return e[t]||""}function hy(e,t,r=Qi){let s=ft(e,r);return s.trim()?`${s}/${t}`:t}function dt(e,t,r=Qi){let s=hy(e,t,r),n=e.child({context:s});return uy(n,s,r)}function py(e){var t,r;let s=new Wa((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:dr.exports(Ji(Xi({},e.opts),{level:"trace",browser:Ji(Xi({},(r=e.opts)==null?void 0:r.browser),{write:n=>s.write(n)})})),chunkLoggerController:s}}function fy(e){var t;let r=new Za((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:dr.exports(Ji(Xi({},e.opts),{level:"trace"}),r),chunkLoggerController:r}}function vp(e){return typeof e.loggerOverride<"u"&&typeof e.loggerOverride!="string"?{logger:e.loggerOverride,chunkLoggerController:null}:typeof window<"u"?py(e):fy(e)}m();w();y();zi();var dy=Object.defineProperty,gy=(e,t,r)=>t in e?dy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,xp=(e,t,r)=>gy(e,typeof t!="symbol"?t+"":t,r),eo=class extends Is{constructor(t){super(),this.opts=t,xp(this,"protocol","wc"),xp(this,"version",2)}};var my=Object.defineProperty,yy=(e,t,r)=>t in e?my(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,wy=(e,t,r)=>yy(e,typeof t!="symbol"?t+"":t,r),to=class extends Is{constructor(t,r){super(),this.core=t,this.logger=r,wy(this,"records",new Map)}},ro=class{constructor(t,r){this.logger=t,this.core=r}},so=class extends Is{constructor(t,r){super(),this.relayer=t,this.logger=r}},no=class extends Is{constructor(t){super()}},io=class{constructor(t,r,s,n){this.core=t,this.logger=r,this.name=s}};var oo=class extends Is{constructor(t,r){super(),this.relayer=t,this.logger=r}};var ao=class extends Is{constructor(t,r){super(),this.core=t,this.logger=r}};var co=class{constructor(t,r,s){this.core=t,this.logger=r,this.store=s}},lo=class{constructor(t,r){this.projectId=t,this.logger=r}},uo=class{constructor(t,r,s){this.core=t,this.logger=r,this.telemetryEnabled=s}},by=Object.defineProperty,vy=(e,t,r)=>t in e?by(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ep=(e,t,r)=>vy(e,typeof t!="symbol"?t+"":t,r);var ho=class{constructor(t){this.opts=t,Ep(this,"protocol","wc"),Ep(this,"version",2)}};var po=class{constructor(t){this.client=t}};var Y=xs($a(),1);m();w();y();var jr=xs($a(),1),tr=xs(rp(),1),yd=xs(C1(),1);m();w();y();m();w();y();m();w();y();m();w();y();var Sp="0.1.1";function Cp(){return Sp}var pe=class e extends Error{constructor(t,r={}){let s=(()=>{if(r.cause instanceof e){if(r.cause.details)return r.cause.details;if(r.cause.shortMessage)return r.cause.shortMessage}return r.cause&&"details"in r.cause&&typeof r.cause.details=="string"?r.cause.details:r.cause?.message?r.cause.message:r.details})(),n=r.cause instanceof e&&r.cause.docsPath||r.docsPath,o=`https://oxlib.sh${n??""}`,a=[t||"An error occurred.",...r.metaMessages?["",...r.metaMessages]:[],...s||n?["",s?`Details: ${s}`:void 0,n?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${Cp()}`}),this.cause=r.cause,this.details=s,this.docs=o,this.docsPath=n,this.shortMessage=t}walk(t){return Ip(this,t)}};function Ip(e,t){return t?.(e)?e:e&&typeof e=="object"&&"cause"in e&&e.cause?Ip(e.cause,t):t?null:e}m();w();y();m();w();y();m();w();y();var rc=BigInt(0),tc=BigInt(1);function pn(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function sc(e){if(!pn(e))throw new Error("Uint8Array expected")}function fn(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}function ei(e){let t=e.toString(16);return t.length&1?"0"+t:t}function Ap(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?rc:BigInt("0x"+e)}var Pp=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",xy=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function dn(e){if(sc(e),Pp)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=xy[e[r]];return t}var Ar={_0:48,_9:57,A:65,F:70,a:97,f:102};function _p(e){if(e>=Ar._0&&e<=Ar._9)return e-Ar._0;if(e>=Ar.A&&e<=Ar.F)return e-(Ar.A-10);if(e>=Ar.a&&e<=Ar.f)return e-(Ar.a-10)}function ti(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Pp)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let s=new Uint8Array(r);for(let n=0,i=0;n<r;n++,i+=2){let o=_p(e.charCodeAt(i)),a=_p(e.charCodeAt(i+1));if(o===void 0||a===void 0){let c=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}s[n]=o*16+a}return s}function Pr(e){return Ap(dn(e))}function nc(e){return sc(e),Ap(dn(Uint8Array.from(e).reverse()))}function As(e,t){return ti(e.toString(16).padStart(t*2,"0"))}function ic(e,t){return As(e,t).reverse()}function gt(e,t,r){let s;if(typeof t=="string")try{s=ti(t)}catch(i){throw new Error(e+" must be hex string or Uint8Array, cause: "+i)}else if(pn(t))s=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let n=s.length;if(typeof r=="number"&&n!==r)throw new Error(e+" of length "+r+" expected, got "+n);return s}function ri(...e){let t=0;for(let s=0;s<e.length;s++){let n=e[s];sc(n),t+=n.length}let r=new Uint8Array(t);for(let s=0,n=0;s<e.length;s++){let i=e[s];r.set(i,n),n+=i.length}return r}var Qa=e=>typeof e=="bigint"&&rc<=e;function fo(e,t,r){return Qa(e)&&Qa(t)&&Qa(r)&&t<=e&&e<r}function Ps(e,t,r,s){if(!fo(t,r,s))throw new Error("expected valid "+e+": "+r+" <= n < "+s+", got "+t)}function Op(e){let t;for(t=0;e>rc;e>>=tc,t+=1);return t}var Os=e=>(tc<<BigInt(e))-tc,ec=e=>new Uint8Array(e),Tp=e=>Uint8Array.from(e);function kp(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let s=ec(e),n=ec(e),i=0,o=()=>{s.fill(1),n.fill(0),i=0},a=(...h)=>r(n,s,...h),c=(h=ec(0))=>{n=a(Tp([0]),h),s=a(),h.length!==0&&(n=a(Tp([1]),h),s=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,p=[];for(;h<t;){s=a();let f=s.slice();p.push(f),h+=s.length}return ri(...p)};return(h,p)=>{o(),c(h);let f;for(;!(f=p(l()));)c();return o(),f}}var Ey={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||pn(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function ks(e,t,r={}){let s=(n,i,o)=>{let a=Ey[i];if(typeof a!="function")throw new Error("invalid validator function");let c=e[n];if(!(o&&c===void 0)&&!a(c,e))throw new Error("param "+String(n)+" is invalid. Expected "+i+", got "+c)};for(let[n,i]of Object.entries(t))s(n,i,!1);for(let[n,i]of Object.entries(r))s(n,i,!0);return e}function oc(e){let t=new WeakMap;return(r,...s)=>{let n=t.get(r);if(n!==void 0)return n;let i=e(r,...s);return t.set(r,i),i}}m();w();y();m();w();y();function Np(e,t){if(ac(e)>t)throw new go({givenSize:ac(e),maxSize:t})}var Or={zero:48,nine:57,A:65,F:70,a:97,f:102};function cc(e){if(e>=Or.zero&&e<=Or.nine)return e-Or.zero;if(e>=Or.A&&e<=Or.F)return e-(Or.A-10);if(e>=Or.a&&e<=Or.f)return e-(Or.a-10)}function Rp(e,t={}){let{dir:r,size:s=32}=t;if(s===0)return e;if(e.length>s)throw new mo({size:e.length,targetSize:s,type:"Bytes"});let n=new Uint8Array(s);for(let i=0;i<s;i++){let o=r==="right";n[o?i:s-i-1]=e[o?i:e.length-i-1]}return n}m();w();y();function yo(e,t){if(Ft(e)>t)throw new wo({givenSize:Ft(e),maxSize:t})}function Bp(e,t){if(typeof t=="number"&&t>0&&t>Ft(e)-1)throw new si({offset:t,position:"start",size:Ft(e)})}function Lp(e,t,r){if(typeof t=="number"&&typeof r=="number"&&Ft(e)!==r-t)throw new si({offset:r,position:"end",size:Ft(e)})}function lc(e,t={}){let{dir:r,size:s=32}=t;if(s===0)return e;let n=e.replace("0x","");if(n.length>s*2)throw new bo({size:Math.ceil(n.length/2),targetSize:s,type:"Hex"});return`0x${n[r==="right"?"padEnd":"padStart"](s*2,"0")}`}function Up(e,t={}){let{dir:r="left"}=t,s=e.replace("0x",""),n=0;for(let i=0;i<s.length-1&&s[r==="left"?i:s.length-i-1].toString()==="0";i++)n++;return s=r==="left"?s.slice(n):s.slice(0,s.length-n),s==="0"?"0x":r==="right"&&s.length%2===1?`0x${s}0`:`0x${s}`}m();w();y();var Cy="#__bigint";function Xr(e,t,r){return JSON.stringify(e,(s,n)=>typeof t=="function"?t(s,n):typeof n=="bigint"?n.toString()+Cy:n,r)}var Iy=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function _y(e,t={}){let{strict:r=!1}=t;if(!e)throw new vo(e);if(typeof e!="string")throw new vo(e);if(r&&!/^0x[0-9a-fA-F]*$/.test(e))throw new xo(e);if(!e.startsWith("0x"))throw new xo(e)}function Eo(...e){return`0x${e.reduce((t,r)=>t+r.replace("0x",""),"")}`}function gr(e){return e instanceof Uint8Array?It(e):Array.isArray(e)?It(new Uint8Array(e)):e}function It(e,t={}){let r="";for(let n=0;n<e.length;n++)r+=Iy[e[n]];let s=`0x${r}`;return typeof t.size=="number"?(yo(s,t.size),hc(s,t.size)):s}function _t(e,t={}){let{signed:r,size:s}=t,n=BigInt(e),i;s?r?i=(1n<<BigInt(s)*8n-1n)-1n:i=2n**(BigInt(s)*8n)-1n:typeof e=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));let o=typeof i=="bigint"&&r?-i-1n:0;if(i&&n>i||n<o){let l=typeof e=="bigint"?"n":"";throw new uc({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:r,size:s,value:`${e}${l}`})}let c=`0x${(r&&n<0?(1n<<BigInt(s*8))+BigInt(n):n).toString(16)}`;return s?Ty(c,s):c}function Ty(e,t){return lc(e,{dir:"left",size:t})}function hc(e,t){return lc(e,{dir:"right",size:t})}function Yt(e,t,r,s={}){let{strict:n}=s;Bp(e,t);let i=`0x${e.replace("0x","").slice((t??0)*2,(r??e.length)*2)}`;return n&&Lp(i,t,r),i}function Ft(e){return Math.ceil((e.length-2)/2)}function pc(e){return Up(e,{dir:"left"})}function fc(e,t={}){let{strict:r=!1}=t;try{return _y(e,{strict:r}),!0}catch{return!1}}var uc=class extends pe{constructor({max:t,min:r,signed:s,size:n,value:i}){super(`Number \`${i}\` is not in safe${n?` ${n*8}-bit`:""}${s?" signed":" unsigned"} integer range ${t?`(\`${r}\` to \`${t}\`)`:`(above \`${r}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}};var vo=class extends pe{constructor(t){super(`Value \`${typeof t=="object"?Xr(t):t}\` of type \`${typeof t}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}},xo=class extends pe{constructor(t){super(`Value \`${t}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}};var wo=class extends pe{constructor({givenSize:t,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${t}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}},si=class extends pe{constructor({offset:t,position:r,size:s}){super(`Slice ${r==="start"?"starting":"ending"} at offset \`${t}\` is out-of-bounds (size: \`${s}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}},bo=class extends pe{constructor({size:t,targetSize:r,type:s}){super(`${s.charAt(0).toUpperCase()}${s.slice(1).toLowerCase()} size (\`${t}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};var Ay=new TextEncoder;function Py(e){if(!(e instanceof Uint8Array)){if(!e)throw new gn(e);if(typeof e!="object")throw new gn(e);if(!("BYTES_PER_ELEMENT"in e))throw new gn(e);if(e.BYTES_PER_ELEMENT!==1||e.constructor.name!=="Uint8Array")throw new gn(e)}}function mn(e){return e instanceof Uint8Array?e:typeof e=="string"?ii(e):Oy(e)}function Oy(e){return e instanceof Uint8Array?e:new Uint8Array(e)}function ii(e,t={}){let{size:r}=t,s=e;r&&(yo(e,r),s=hc(e,r));let n=s.slice(2);n.length%2&&(n=`0${n}`);let i=n.length/2,o=new Uint8Array(i);for(let a=0,c=0;a<i;a++){let l=cc(n.charCodeAt(c++)),u=cc(n.charCodeAt(c++));if(l===void 0||u===void 0)throw new pe(`Invalid byte sequence ("${n[c-2]}${n[c-1]}" in "${n}").`);o[a]=l*16+u}return o}function jp(e,t={}){let{size:r}=t,s=Ay.encode(e);return typeof r=="number"?(Np(s,r),ky(s,r)):s}function ky(e,t){return Rp(e,{dir:"right",size:t})}function ac(e){return e.length}function Dp(e){try{return Py(e),!0}catch{return!1}}var gn=class extends pe{constructor(t){super(`Value \`${typeof t=="object"?Xr(t):t}\` of type \`${typeof t}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}},go=class extends pe{constructor({givenSize:t,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${t}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}};var mo=class extends pe{constructor({size:t,targetSize:r,type:s}){super(`${s.charAt(0).toUpperCase()}${s.slice(1).toLowerCase()} size (\`${t}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}};function dc(e,t={}){let{as:r=typeof e=="string"?"Hex":"Bytes"}=t,s=Kh(mn(e));return r==="Bytes"?s:It(s)}m();w();y();m();w();y();m();w();y();var So=class extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}get(t){let r=super.get(t);return super.has(t)&&r!==void 0&&(this.delete(t),super.set(t,r)),r}set(t,r){if(super.set(t,r),this.maxSize&&this.size>this.maxSize){let s=this.keys().next().value;s&&this.delete(s)}return this}};var Ny={checksum:new So(8192)},Co=Ny.checksum;m();w();y();function Mp(e,t={}){let{compressed:r}=t,{prefix:s,x:n,y:i}=e;if(r===!1||typeof n=="bigint"&&typeof i=="bigint"){if(s!==4)throw new Io({prefix:s,cause:new yc});return}if(r===!0||typeof n=="bigint"&&typeof i>"u"){if(s!==3&&s!==2)throw new Io({prefix:s,cause:new mc});return}throw new gc({publicKey:e})}function bc(e){let t=(()=>{if(fc(e))return zp(e);if(Dp(e))return Ry(e);let{prefix:r,x:s,y:n}=e;return typeof s=="bigint"&&typeof n=="bigint"?{prefix:r??4,x:s,y:n}:{prefix:r,x:s}})();return Mp(t),t}function Ry(e){return zp(It(e))}function zp(e){if(e.length!==132&&e.length!==130&&e.length!==68)throw new wc({publicKey:e});if(e.length===130){let s=BigInt(Yt(e,0,32)),n=BigInt(Yt(e,32,64));return{prefix:4,x:s,y:n}}if(e.length===132){let s=Number(Yt(e,0,1)),n=BigInt(Yt(e,1,33)),i=BigInt(Yt(e,33,65));return{prefix:s,x:n,y:i}}let t=Number(Yt(e,0,1)),r=BigInt(Yt(e,1,33));return{prefix:t,x:r}}function Hp(e,t={}){return ii(oi(e,t))}function oi(e,t={}){Mp(e);let{prefix:r,x:s,y:n}=e,{includePrefix:i=!0}=t;return Eo(i?_t(r,{size:1}):"0x",_t(s,{size:32}),typeof n=="bigint"?_t(n,{size:32}):"0x")}var gc=class extends pe{constructor({publicKey:t}){super(`Value \`${Xr(t)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}},Io=class extends pe{constructor({prefix:t,cause:r}){super(`Prefix "${t}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}},mc=class extends pe{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}},yc=class extends pe{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}},wc=class extends pe{constructor({publicKey:t}){super(`Value \`${t}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${Ft(gr(t))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}};var By=/^0x[a-fA-F0-9]{40}$/;function _o(e,t={}){let{strict:r=!0}=t;if(!By.test(e))throw new To({address:e,cause:new xc});if(r){if(e.toLowerCase()===e)return;if(Vp(e)!==e)throw new To({address:e,cause:new Ec})}}function Vp(e){if(Co.has(e))return Co.get(e);_o(e,{strict:!1});let t=e.substring(2).toLowerCase(),r=dc(jp(t),{as:"Bytes"}),s=t.split("");for(let i=0;i<40;i+=2)r[i>>1]>>4>=8&&s[i]&&(s[i]=s[i].toUpperCase()),(r[i>>1]&15)>=8&&s[i+1]&&(s[i+1]=s[i+1].toUpperCase());let n=`0x${s.join("")}`;return Co.set(e,n),n}function Ly(e,t={}){let{checksum:r=!1}=t;return _o(e),r?Vp(e):e}function Kp(e,t={}){let r=dc(`0x${oi(e).slice(4)}`).substring(26);return Ly(`0x${r}`,t)}function Gp(e,t){return _o(e,{strict:!1}),_o(t,{strict:!1}),e.toLowerCase()===t.toLowerCase()}var To=class extends pe{constructor({address:t,cause:r}){super(`Address "${t}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}},xc=class extends pe{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}},Ec=class extends pe{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}};m();w();y();var A9=2n**(8n-1n)-1n,P9=2n**(16n-1n)-1n,O9=2n**(24n-1n)-1n,k9=2n**(32n-1n)-1n,N9=2n**(40n-1n)-1n,R9=2n**(48n-1n)-1n,B9=2n**(56n-1n)-1n,L9=2n**(64n-1n)-1n,U9=2n**(72n-1n)-1n,$9=2n**(80n-1n)-1n,j9=2n**(88n-1n)-1n,D9=2n**(96n-1n)-1n,q9=2n**(104n-1n)-1n,F9=2n**(112n-1n)-1n,M9=2n**(120n-1n)-1n,z9=2n**(128n-1n)-1n,H9=2n**(136n-1n)-1n,V9=2n**(144n-1n)-1n,K9=2n**(152n-1n)-1n,G9=2n**(160n-1n)-1n,W9=2n**(168n-1n)-1n,Z9=2n**(176n-1n)-1n,Y9=2n**(184n-1n)-1n,X9=2n**(192n-1n)-1n,J9=2n**(200n-1n)-1n,Q9=2n**(208n-1n)-1n,e7=2n**(216n-1n)-1n,t7=2n**(224n-1n)-1n,r7=2n**(232n-1n)-1n,s7=2n**(240n-1n)-1n,n7=2n**(248n-1n)-1n,i7=2n**(256n-1n)-1n,o7=-(2n**(8n-1n)),a7=-(2n**(16n-1n)),c7=-(2n**(24n-1n)),l7=-(2n**(32n-1n)),u7=-(2n**(40n-1n)),h7=-(2n**(48n-1n)),p7=-(2n**(56n-1n)),f7=-(2n**(64n-1n)),d7=-(2n**(72n-1n)),g7=-(2n**(80n-1n)),m7=-(2n**(88n-1n)),y7=-(2n**(96n-1n)),w7=-(2n**(104n-1n)),b7=-(2n**(112n-1n)),v7=-(2n**(120n-1n)),x7=-(2n**(128n-1n)),E7=-(2n**(136n-1n)),S7=-(2n**(144n-1n)),C7=-(2n**(152n-1n)),I7=-(2n**(160n-1n)),_7=-(2n**(168n-1n)),T7=-(2n**(176n-1n)),A7=-(2n**(184n-1n)),P7=-(2n**(192n-1n)),O7=-(2n**(200n-1n)),k7=-(2n**(208n-1n)),N7=-(2n**(216n-1n)),R7=-(2n**(224n-1n)),B7=-(2n**(232n-1n)),L7=-(2n**(240n-1n)),U7=-(2n**(248n-1n)),$7=-(2n**(256n-1n)),j7=2n**8n-1n,D7=2n**16n-1n,q7=2n**24n-1n,F7=2n**32n-1n,M7=2n**40n-1n,z7=2n**48n-1n,H7=2n**56n-1n,V7=2n**64n-1n,K7=2n**72n-1n,G7=2n**80n-1n,W7=2n**88n-1n,Z7=2n**96n-1n,Y7=2n**104n-1n,X7=2n**112n-1n,J7=2n**120n-1n,Q7=2n**128n-1n,eC=2n**136n-1n,tC=2n**144n-1n,rC=2n**152n-1n,sC=2n**160n-1n,nC=2n**168n-1n,iC=2n**176n-1n,oC=2n**184n-1n,aC=2n**192n-1n,cC=2n**200n-1n,lC=2n**208n-1n,uC=2n**216n-1n,hC=2n**224n-1n,pC=2n**232n-1n,fC=2n**240n-1n,dC=2n**248n-1n,Sc=2n**256n-1n;var Lo={};qh(Lo,{InvalidRError:()=>Oo,InvalidSError:()=>ko,InvalidSerializedSizeError:()=>Po,InvalidVError:()=>No,InvalidYParityError:()=>Ls,MissingPropertiesError:()=>yn,assert:()=>Ro,extract:()=>Jy,from:()=>qc,fromBytes:()=>mf,fromDerBytes:()=>Qy,fromDerHex:()=>yf,fromHex:()=>Dc,fromLegacy:()=>wf,fromRpc:()=>bf,fromTuple:()=>ew,toBytes:()=>tw,toDerBytes:()=>rw,toDerHex:()=>sw,toHex:()=>vf,toLegacy:()=>nw,toRpc:()=>iw,toTuple:()=>ow,vToYParity:()=>Bo,validate:()=>aw,yParityToV:()=>Fc});m();w();y();m();w();y();m();w();y();m();w();y();m();w();y();m();w();y();var it=BigInt(0),Ve=BigInt(1),Bs=BigInt(2),Uy=BigInt(3),Xp=BigInt(4),Jp=BigInt(5),Qp=BigInt(8);function He(e,t){let r=e%t;return r>=it?r:t+r}function Tt(e,t,r){let s=e;for(;t-- >it;)s*=s,s%=r;return s}function Ao(e,t){if(e===it)throw new Error("invert: expected non-zero number");if(t<=it)throw new Error("invert: expected positive modulus, got "+t);let r=He(e,t),s=t,n=it,i=Ve,o=Ve,a=it;for(;r!==it;){let l=s/r,u=s%r,h=n-o*l,p=i-a*l;s=r,r=u,n=o,i=a,o=h,a=p}if(s!==Ve)throw new Error("invert: does not exist");return He(n,t)}function ef(e,t){let r=(e.ORDER+Ve)/Xp,s=e.pow(t,r);if(!e.eql(e.sqr(s),t))throw new Error("Cannot find square root");return s}function $y(e,t){let r=(e.ORDER-Jp)/Qp,s=e.mul(t,Bs),n=e.pow(s,r),i=e.mul(t,n),o=e.mul(e.mul(i,Bs),n),a=e.mul(i,e.sub(o,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}function jy(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-Ve,r=0;for(;t%Bs===it;)t/=Bs,r++;let s=Bs,n=ai(e);for(;Yp(n,s)===1;)if(s++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return ef;let i=n.pow(s,t),o=(t+Ve)/Bs;return function(c,l){if(c.is0(l))return l;if(Yp(c,l)!==1)throw new Error("Cannot find square root");let u=r,h=c.mul(c.ONE,i),p=c.pow(l,t),f=c.pow(l,o);for(;!c.eql(p,c.ONE);){if(c.is0(p))return c.ZERO;let g=1,d=c.sqr(p);for(;!c.eql(d,c.ONE);)if(g++,d=c.sqr(d),g===u)throw new Error("Cannot find square root");let b=Ve<<BigInt(u-g-1),k=c.pow(h,b);u=g,h=c.sqr(k),p=c.mul(p,h),f=c.mul(f,k)}return f}}function Dy(e){return e%Xp===Uy?ef:e%Qp===Jp?$y:jy(e)}var qy=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Cc(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=qy.reduce((s,n)=>(s[n]="function",s),t);return ks(e,r)}function Fy(e,t,r){if(r<it)throw new Error("invalid exponent, negatives unsupported");if(r===it)return e.ONE;if(r===Ve)return t;let s=e.ONE,n=t;for(;r>it;)r&Ve&&(s=e.mul(s,n)),n=e.sqr(n),r>>=Ve;return s}function Ic(e,t,r=!1){let s=new Array(t.length).fill(r?e.ZERO:void 0),n=t.reduce((o,a,c)=>e.is0(a)?o:(s[c]=o,e.mul(o,a)),e.ONE),i=e.inv(n);return t.reduceRight((o,a,c)=>e.is0(a)?o:(s[c]=e.mul(o,s[c]),e.mul(o,a)),i),s}function Yp(e,t){let r=(e.ORDER-Ve)/Bs,s=e.pow(t,r),n=e.eql(s,e.ONE),i=e.eql(s,e.ZERO),o=e.eql(s,e.neg(e.ONE));if(!n&&!i&&!o)throw new Error("invalid Legendre symbol result");return n?1:i?0:-1}function _c(e,t){t!==void 0&&zh(t);let r=t!==void 0?t:e.toString(2).length,s=Math.ceil(r/8);return{nBitLength:r,nByteLength:s}}function ai(e,t,r=!1,s={}){if(e<=it)throw new Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:n,nByteLength:i}=_c(e,t);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o,a=Object.freeze({ORDER:e,isLE:r,BITS:n,BYTES:i,MASK:Os(n),ZERO:it,ONE:Ve,create:c=>He(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return it<=c&&c<e},is0:c=>c===it,isOdd:c=>(c&Ve)===Ve,neg:c=>He(-c,e),eql:(c,l)=>c===l,sqr:c=>He(c*c,e),add:(c,l)=>He(c+l,e),sub:(c,l)=>He(c-l,e),mul:(c,l)=>He(c*l,e),pow:(c,l)=>Fy(a,c,l),div:(c,l)=>He(c*Ao(l,e),e),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Ao(c,e),sqrt:s.sqrt||(c=>(o||(o=Dy(e)),o(a,c))),toBytes:c=>r?ic(c,i):As(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return r?nc(c):Pr(c)},invertBatch:c=>Ic(a,c),cmov:(c,l,u)=>u?l:c});return Object.freeze(a)}function tf(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function Tc(e){let t=tf(e);return t+Math.ceil(t/2)}function rf(e,t,r=!1){let s=e.length,n=tf(t),i=Tc(t);if(s<16||s<i||s>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+s);let o=r?nc(e):Pr(e),a=He(o,t-Ve)+Ve;return r?ic(a,n):As(a,n)}var sf=BigInt(0),Nc=BigInt(1);function Ac(e,t){let r=t.negate();return e?r:t}function of(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Pc(e,t){of(e,t);let r=Math.ceil(t/e)+1,s=2**(e-1),n=2**e,i=Os(e),o=BigInt(e);return{windows:r,windowSize:s,mask:i,maxNumber:n,shiftBy:o}}function nf(e,t,r){let{windowSize:s,mask:n,maxNumber:i,shiftBy:o}=r,a=Number(e&n),c=e>>o;a>s&&(a-=i,c+=Nc);let l=t*s,u=l+Math.abs(a)-1,h=a===0,p=a<0,f=t%2!==0;return{nextN:c,offset:u,isZero:h,isNeg:p,isNegF:f,offsetF:l}}function My(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((r,s)=>{if(!(r instanceof t))throw new Error("invalid point at index "+s)})}function zy(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((r,s)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+s)})}var Oc=new WeakMap,af=new WeakMap;function kc(e){return af.get(e)||1}function cf(e,t){return{constTimeNegate:Ac,hasPrecomputes(r){return kc(r)!==1},unsafeLadder(r,s,n=e.ZERO){let i=r;for(;s>sf;)s&Nc&&(n=n.add(i)),i=i.double(),s>>=Nc;return n},precomputeWindow(r,s){let{windows:n,windowSize:i}=Pc(s,t),o=[],a=r,c=a;for(let l=0;l<n;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,s,n){let i=e.ZERO,o=e.BASE,a=Pc(r,t);for(let c=0;c<a.windows;c++){let{nextN:l,offset:u,isZero:h,isNeg:p,isNegF:f,offsetF:g}=nf(n,c,a);n=l,h?o=o.add(Ac(f,s[g])):i=i.add(Ac(p,s[u]))}return{p:i,f:o}},wNAFUnsafe(r,s,n,i=e.ZERO){let o=Pc(r,t);for(let a=0;a<o.windows&&n!==sf;a++){let{nextN:c,offset:l,isZero:u,isNeg:h}=nf(n,a,o);if(n=c,!u){let p=s[l];i=i.add(h?p.negate():p)}}return i},getPrecomputes(r,s,n){let i=Oc.get(s);return i||(i=this.precomputeWindow(s,r),r!==1&&Oc.set(s,n(i))),i},wNAFCached(r,s,n){let i=kc(r);return this.wNAF(i,this.getPrecomputes(i,r,n),s)},wNAFCachedUnsafe(r,s,n,i){let o=kc(r);return o===1?this.unsafeLadder(r,s,i):this.wNAFUnsafe(o,this.getPrecomputes(o,r,n),s,i)},setWindowSize(r,s){of(s,t),af.set(r,s),Oc.delete(r)}}}function lf(e,t,r,s){My(r,e),zy(s,t);let n=r.length,i=s.length;if(n!==i)throw new Error("arrays of points and scalars must have equal length");let o=e.ZERO,a=Op(BigInt(n)),c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);let l=Os(c),u=new Array(Number(l)+1).fill(o),h=Math.floor((t.BITS-1)/c)*c,p=o;for(let f=h;f>=0;f-=c){u.fill(o);for(let d=0;d<i;d++){let b=s[d],k=Number(b>>BigInt(f)&l);u[k]=u[k].add(r[d])}let g=o;for(let d=u.length-1,b=o;d>0;d--)b=b.add(u[d]),g=g.add(b);if(p=p.add(g),f!==0)for(let d=0;d<c;d++)p=p.double()}return p}function Rc(e){return Cc(e.Fp),ks(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({..._c(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function uf(e){e.lowS!==void 0&&fn("lowS",e.lowS),e.prehash!==void 0&&fn("prehash",e.prehash)}function Hy(e){let t=Rc(e);ks(t,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});let{endo:r,Fp:s,a:n}=t;if(r){if(!s.eql(n,s.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...t})}var Uc=class extends Error{constructor(t=""){super(t)}},kr={Err:Uc,_tlv:{encode:(e,t)=>{let{Err:r}=kr;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");let s=t.length/2,n=ei(s);if(n.length/2&128)throw new r("tlv.encode: long form length too big");let i=s>127?ei(n.length/2|128):"";return ei(e)+i+n+t},decode(e,t){let{Err:r}=kr,s=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[s++]!==e)throw new r("tlv.decode: wrong tlv");let n=t[s++],i=!!(n&128),o=0;if(!i)o=n;else{let c=n&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");let l=t.subarray(s,s+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let u of l)o=o<<8|u;if(s+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}let a=t.subarray(s,s+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(s+o)}}},_int:{encode(e){let{Err:t}=kr;if(e<Nr)throw new t("integer: negative integers are not allowed");let r=ei(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=kr;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Pr(e)}},toSig(e){let{Err:t,_int:r,_tlv:s}=kr,n=gt("signature",e),{v:i,l:o}=s.decode(48,n);if(o.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:c}=s.decode(2,i),{v:l,l:u}=s.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(e){let{_tlv:t,_int:r}=kr,s=t.encode(2,r.encode(e.r)),n=t.encode(2,r.encode(e.s)),i=s+n;return t.encode(48,i)}};function Bc(e,t){return dn(As(e,t))}var Nr=BigInt(0),Ue=BigInt(1),RC=BigInt(2),Lc=BigInt(3),Vy=BigInt(4);function Ky(e){let t=Hy(e),{Fp:r}=t,s=ai(t.n,t.nBitLength),n=t.toBytes||((T,I,L)=>{let R=I.toAffine();return ri(Uint8Array.from([4]),r.toBytes(R.x),r.toBytes(R.y))}),i=t.fromBytes||(T=>{let I=T.subarray(1),L=r.fromBytes(I.subarray(0,r.BYTES)),R=r.fromBytes(I.subarray(r.BYTES,2*r.BYTES));return{x:L,y:R}});function o(T){let{a:I,b:L}=t,R=r.sqr(T),j=r.mul(R,T);return r.add(r.add(j,r.mul(T,I)),L)}function a(T,I){let L=r.sqr(I),R=o(T);return r.eql(L,R)}if(!a(t.Gx,t.Gy))throw new Error("bad curve params: generator point");let c=r.mul(r.pow(t.a,Lc),Vy),l=r.mul(r.sqr(t.b),BigInt(27));if(r.is0(r.add(c,l)))throw new Error("bad curve params: a or b");function u(T){return fo(T,Ue,t.n)}function h(T){let{allowedPrivateKeyLengths:I,nByteLength:L,wrapPrivateKey:R,n:j}=t;if(I&&typeof T!="bigint"){if(pn(T)&&(T=dn(T)),typeof T!="string"||!I.includes(T.length))throw new Error("invalid private key");T=T.padStart(L*2,"0")}let H;try{H=typeof T=="bigint"?T:Pr(gt("private key",T,L))}catch{throw new Error("invalid private key, expected hex or "+L+" bytes, got "+typeof T)}return R&&(H=He(H,j)),Ps("private key",H,Ue,j),H}function p(T){if(!(T instanceof d))throw new Error("ProjectivePoint expected")}let f=oc((T,I)=>{let{px:L,py:R,pz:j}=T;if(r.eql(j,r.ONE))return{x:L,y:R};let H=T.is0();I==null&&(I=H?r.ONE:r.inv(j));let N=r.mul(L,I),M=r.mul(R,I),V=r.mul(j,I);if(H)return{x:r.ZERO,y:r.ZERO};if(!r.eql(V,r.ONE))throw new Error("invZ was invalid");return{x:N,y:M}}),g=oc(T=>{if(T.is0()){if(t.allowInfinityPoint&&!r.is0(T.py))return;throw new Error("bad point: ZERO")}let{x:I,y:L}=T.toAffine();if(!r.isValid(I)||!r.isValid(L))throw new Error("bad point: x or y not FE");if(!a(I,L))throw new Error("bad point: equation left != right");if(!T.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class d{constructor(I,L,R){if(I==null||!r.isValid(I))throw new Error("x required");if(L==null||!r.isValid(L)||r.is0(L))throw new Error("y required");if(R==null||!r.isValid(R))throw new Error("z required");this.px=I,this.py=L,this.pz=R,Object.freeze(this)}static fromAffine(I){let{x:L,y:R}=I||{};if(!I||!r.isValid(L)||!r.isValid(R))throw new Error("invalid affine point");if(I instanceof d)throw new Error("projective point not allowed");let j=H=>r.eql(H,r.ZERO);return j(L)&&j(R)?d.ZERO:new d(L,R,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(I){let L=Ic(r,I.map(R=>R.pz));return I.map((R,j)=>R.toAffine(L[j])).map(d.fromAffine)}static fromHex(I){let L=d.fromAffine(i(gt("pointHex",I)));return L.assertValidity(),L}static fromPrivateKey(I){return d.BASE.multiply(h(I))}static msm(I,L){return lf(d,s,I,L)}_setWindowSize(I){q.setWindowSize(this,I)}assertValidity(){g(this)}hasEvenY(){let{y:I}=this.toAffine();if(r.isOdd)return!r.isOdd(I);throw new Error("Field doesn't support isOdd")}equals(I){p(I);let{px:L,py:R,pz:j}=this,{px:H,py:N,pz:M}=I,V=r.eql(r.mul(L,M),r.mul(H,j)),B=r.eql(r.mul(R,M),r.mul(N,j));return V&&B}negate(){return new d(this.px,r.neg(this.py),this.pz)}double(){let{a:I,b:L}=t,R=r.mul(L,Lc),{px:j,py:H,pz:N}=this,M=r.ZERO,V=r.ZERO,B=r.ZERO,E=r.mul(j,j),_=r.mul(H,H),v=r.mul(N,N),x=r.mul(j,H);return x=r.add(x,x),B=r.mul(j,N),B=r.add(B,B),M=r.mul(I,B),V=r.mul(R,v),V=r.add(M,V),M=r.sub(_,V),V=r.add(_,V),V=r.mul(M,V),M=r.mul(x,M),B=r.mul(R,B),v=r.mul(I,v),x=r.sub(E,v),x=r.mul(I,x),x=r.add(x,B),B=r.add(E,E),E=r.add(B,E),E=r.add(E,v),E=r.mul(E,x),V=r.add(V,E),v=r.mul(H,N),v=r.add(v,v),E=r.mul(v,x),M=r.sub(M,E),B=r.mul(v,_),B=r.add(B,B),B=r.add(B,B),new d(M,V,B)}add(I){p(I);let{px:L,py:R,pz:j}=this,{px:H,py:N,pz:M}=I,V=r.ZERO,B=r.ZERO,E=r.ZERO,_=t.a,v=r.mul(t.b,Lc),x=r.mul(L,H),A=r.mul(R,N),U=r.mul(j,M),C=r.add(L,R),O=r.add(H,N);C=r.mul(C,O),O=r.add(x,A),C=r.sub(C,O),O=r.add(L,j);let z=r.add(H,M);return O=r.mul(O,z),z=r.add(x,U),O=r.sub(O,z),z=r.add(R,j),V=r.add(N,M),z=r.mul(z,V),V=r.add(A,U),z=r.sub(z,V),E=r.mul(_,O),V=r.mul(v,U),E=r.add(V,E),V=r.sub(A,E),E=r.add(A,E),B=r.mul(V,E),A=r.add(x,x),A=r.add(A,x),U=r.mul(_,U),O=r.mul(v,O),A=r.add(A,U),U=r.sub(x,U),U=r.mul(_,U),O=r.add(O,U),x=r.mul(A,O),B=r.add(B,x),x=r.mul(z,O),V=r.mul(C,V),V=r.sub(V,x),x=r.mul(C,A),E=r.mul(z,E),E=r.add(E,x),new d(V,B,E)}subtract(I){return this.add(I.negate())}is0(){return this.equals(d.ZERO)}wNAF(I){return q.wNAFCached(this,I,d.normalizeZ)}multiplyUnsafe(I){let{endo:L,n:R}=t;Ps("scalar",I,Nr,R);let j=d.ZERO;if(I===Nr)return j;if(this.is0()||I===Ue)return this;if(!L||q.hasPrecomputes(this))return q.wNAFCachedUnsafe(this,I,d.normalizeZ);let{k1neg:H,k1:N,k2neg:M,k2:V}=L.splitScalar(I),B=j,E=j,_=this;for(;N>Nr||V>Nr;)N&Ue&&(B=B.add(_)),V&Ue&&(E=E.add(_)),_=_.double(),N>>=Ue,V>>=Ue;return H&&(B=B.negate()),M&&(E=E.negate()),E=new d(r.mul(E.px,L.beta),E.py,E.pz),B.add(E)}multiply(I){let{endo:L,n:R}=t;Ps("scalar",I,Ue,R);let j,H;if(L){let{k1neg:N,k1:M,k2neg:V,k2:B}=L.splitScalar(I),{p:E,f:_}=this.wNAF(M),{p:v,f:x}=this.wNAF(B);E=q.constTimeNegate(N,E),v=q.constTimeNegate(V,v),v=new d(r.mul(v.px,L.beta),v.py,v.pz),j=E.add(v),H=_.add(x)}else{let{p:N,f:M}=this.wNAF(I);j=N,H=M}return d.normalizeZ([j,H])[0]}multiplyAndAddUnsafe(I,L,R){let j=d.BASE,H=(M,V)=>V===Nr||V===Ue||!M.equals(j)?M.multiplyUnsafe(V):M.multiply(V),N=H(this,L).add(H(I,R));return N.is0()?void 0:N}toAffine(I){return f(this,I)}isTorsionFree(){let{h:I,isTorsionFree:L}=t;if(I===Ue)return!0;if(L)return L(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:I,clearCofactor:L}=t;return I===Ue?this:L?L(d,this):this.multiplyUnsafe(t.h)}toRawBytes(I=!0){return fn("isCompressed",I),this.assertValidity(),n(d,this,I)}toHex(I=!0){return fn("isCompressed",I),dn(this.toRawBytes(I))}}d.BASE=new d(t.Gx,t.Gy,r.ONE),d.ZERO=new d(r.ZERO,r.ONE,r.ZERO);let{endo:b,nBitLength:k}=t,q=cf(d,b?Math.ceil(k/2):k);return{CURVE:t,ProjectivePoint:d,normPrivateKeyToScalar:h,weierstrassEquation:o,isWithinCurveOrder:u}}function Gy(e){let t=Rc(e);return ks(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function hf(e){let t=Gy(e),{Fp:r,n:s,nByteLength:n,nBitLength:i}=t,o=r.BYTES+1,a=2*r.BYTES+1;function c(v){return He(v,s)}function l(v){return Ao(v,s)}let{ProjectivePoint:u,normPrivateKeyToScalar:h,weierstrassEquation:p,isWithinCurveOrder:f}=Ky({...t,toBytes(v,x,A){let U=x.toAffine(),C=r.toBytes(U.x),O=ri;return fn("isCompressed",A),A?O(Uint8Array.from([x.hasEvenY()?2:3]),C):O(Uint8Array.from([4]),C,r.toBytes(U.y))},fromBytes(v){let x=v.length,A=v[0],U=v.subarray(1);if(x===o&&(A===2||A===3)){let C=Pr(U);if(!fo(C,Ue,r.ORDER))throw new Error("Point is not on curve");let O=p(C),z;try{z=r.sqrt(O)}catch(X){let Z=X instanceof Error?": "+X.message:"";throw new Error("Point is not on curve"+Z)}let K=(z&Ue)===Ue;return(A&1)===1!==K&&(z=r.neg(z)),{x:C,y:z}}else if(x===a&&A===4){let C=r.fromBytes(U.subarray(0,r.BYTES)),O=r.fromBytes(U.subarray(r.BYTES,2*r.BYTES));return{x:C,y:O}}else{let C=o,O=a;throw new Error("invalid Point, expected length of "+C+", or uncompressed "+O+", got "+x)}}});function g(v){let x=s>>Ue;return v>x}function d(v){return g(v)?c(-v):v}let b=(v,x,A)=>Pr(v.slice(x,A));class k{constructor(x,A,U){Ps("r",x,Ue,s),Ps("s",A,Ue,s),this.r=x,this.s=A,U!=null&&(this.recovery=U),Object.freeze(this)}static fromCompact(x){let A=n;return x=gt("compactSignature",x,A*2),new k(b(x,0,A),b(x,A,2*A))}static fromDER(x){let{r:A,s:U}=kr.toSig(gt("DER",x));return new k(A,U)}assertValidity(){}addRecoveryBit(x){return new k(this.r,this.s,x)}recoverPublicKey(x){let{r:A,s:U,recovery:C}=this,O=j(gt("msgHash",x));if(C==null||![0,1,2,3].includes(C))throw new Error("recovery id invalid");let z=C===2||C===3?A+t.n:A;if(z>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let K=(C&1)===0?"02":"03",se=u.fromHex(K+Bc(z,r.BYTES)),X=l(z),Z=c(-O*X),ie=c(U*X),re=u.BASE.multiplyAndAddUnsafe(se,Z,ie);if(!re)throw new Error("point at infinify");return re.assertValidity(),re}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new k(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return ti(this.toDERHex())}toDERHex(){return kr.hexFromSig(this)}toCompactRawBytes(){return ti(this.toCompactHex())}toCompactHex(){let x=n;return Bc(this.r,x)+Bc(this.s,x)}}let q={isValidPrivateKey(v){try{return h(v),!0}catch{return!1}},normPrivateKeyToScalar:h,randomPrivateKey:()=>{let v=Tc(t.n);return rf(t.randomBytes(v),t.n)},precompute(v=8,x=u.BASE){return x._setWindowSize(v),x.multiply(BigInt(3)),x}};function T(v,x=!0){return u.fromPrivateKey(v).toRawBytes(x)}function I(v){if(typeof v=="bigint")return!1;if(v instanceof u)return!0;let A=gt("key",v).length,U=r.BYTES,C=U+1,O=2*U+1;if(!(t.allowedPrivateKeyLengths||n===C))return A===C||A===O}function L(v,x,A=!0){if(I(v)===!0)throw new Error("first arg must be private key");if(I(x)===!1)throw new Error("second arg must be public key");return u.fromHex(x).multiply(h(v)).toRawBytes(A)}let R=t.bits2int||function(v){if(v.length>8192)throw new Error("input is too large");let x=Pr(v),A=v.length*8-i;return A>0?x>>BigInt(A):x},j=t.bits2int_modN||function(v){return c(R(v))},H=Os(i);function N(v){return Ps("num < 2^"+i,v,Nr,H),As(v,n)}function M(v,x,A=V){if(["recovered","canonical"].some(ne=>ne in A))throw new Error("sign() legacy options not supported");let{hash:U,randomBytes:C}=t,{lowS:O,prehash:z,extraEntropy:K}=A;O==null&&(O=!0),v=gt("msgHash",v),uf(A),z&&(v=gt("prehashed msgHash",U(v)));let se=j(v),X=h(x),Z=[N(X),N(se)];if(K!=null&&K!==!1){let ne=K===!0?C(r.BYTES):K;Z.push(gt("extraEntropy",ne))}let ie=ri(...Z),re=se;function ge(ne){let me=R(ne);if(!f(me))return;let rt=l(me),ct=u.BASE.multiply(me).toAffine(),st=c(ct.x);if(st===Nr)return;let Ut=c(rt*c(re+st*X));if(Ut===Nr)return;let Kr=(ct.x===st?0:2)|Number(ct.y&Ue),Dh=Ut;return O&&g(Ut)&&(Dh=d(Ut),Kr^=1),new k(st,Dh,Kr)}return{seed:ie,k2sig:ge}}let V={lowS:t.lowS,prehash:!1},B={lowS:t.lowS,prehash:!1};function E(v,x,A=V){let{seed:U,k2sig:C}=M(v,x,A),O=t;return kp(O.hash.outputLen,O.nByteLength,O.hmac)(U,C)}u.BASE._setWindowSize(8);function _(v,x,A,U=B){let C=v;x=gt("msgHash",x),A=gt("publicKey",A);let{lowS:O,prehash:z,format:K}=U;if(uf(U),"strict"in U)throw new Error("options.strict was renamed to lowS");if(K!==void 0&&K!=="compact"&&K!=="der")throw new Error("format must be compact or der");let se=typeof C=="string"||pn(C),X=!se&&!K&&typeof C=="object"&&C!==null&&typeof C.r=="bigint"&&typeof C.s=="bigint";if(!se&&!X)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let Z,ie;try{if(X&&(Z=new k(C.r,C.s)),se){try{K!=="compact"&&(Z=k.fromDER(C))}catch(Kr){if(!(Kr instanceof kr.Err))throw Kr}!Z&&K!=="der"&&(Z=k.fromCompact(C))}ie=u.fromHex(A)}catch{return!1}if(!Z||O&&Z.hasHighS())return!1;z&&(x=t.hash(x));let{r:re,s:ge}=Z,ne=j(x),me=l(ge),rt=c(ne*me),ct=c(re*me),st=u.BASE.multiplyAndAddUnsafe(ie,rt,ct)?.toAffine();return st?c(st.x)===re:!1}return{CURVE:t,getPublicKey:T,getSharedSecret:L,sign:E,verify:_,ProjectivePoint:u,Signature:k,utils:q}}function Wy(e){return{hash:e,hmac:(t,...r)=>Wh(e,t,Hh(...r)),randomBytes:Vh}}function pf(e,t){let r=s=>hf({...e,...Wy(s)});return{...r(t),create:r}}var gf=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),ff=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Zy=BigInt(0),Yy=BigInt(1),$c=BigInt(2),df=(e,t)=>(e+t/$c)/t;function Xy(e){let t=gf,r=BigInt(3),s=BigInt(6),n=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=e*e*e%t,u=l*l*e%t,h=Tt(u,r,t)*u%t,p=Tt(h,r,t)*u%t,f=Tt(p,$c,t)*l%t,g=Tt(f,n,t)*f%t,d=Tt(g,i,t)*g%t,b=Tt(d,a,t)*d%t,k=Tt(b,c,t)*b%t,q=Tt(k,a,t)*d%t,T=Tt(q,r,t)*u%t,I=Tt(T,o,t)*g%t,L=Tt(I,s,t)*l%t,R=Tt(L,$c,t);if(!jc.eql(jc.sqr(R),e))throw new Error("Cannot find square root");return R}var jc=ai(gf,void 0,void 0,{sqrt:Xy}),At=pf({a:Zy,b:BigInt(7),Fp:jc,n:ff,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=ff,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),s=-Yy*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,o=BigInt("0x100000000000000000000000000000000"),a=df(i*e,t),c=df(-s*e,t),l=He(e-a*r-c*n,t),u=He(-a*s-c*i,t),h=l>o,p=u>o;if(h&&(l=t-l),p&&(u=t-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:l,k2neg:p,k2:u}}}},Gh);function Ro(e,t={}){let{recovered:r}=t;if(typeof e.r>"u")throw new yn({signature:e});if(typeof e.s>"u")throw new yn({signature:e});if(r&&typeof e.yParity>"u")throw new yn({signature:e});if(e.r<0n||e.r>Sc)throw new Oo({value:e.r});if(e.s<0n||e.s>Sc)throw new ko({value:e.s});if(typeof e.yParity=="number"&&e.yParity!==0&&e.yParity!==1)throw new Ls({value:e.yParity})}function mf(e){return Dc(It(e))}function Dc(e){if(e.length!==130&&e.length!==132)throw new Po({signature:e});let t=BigInt(Yt(e,0,32)),r=BigInt(Yt(e,32,64)),s=(()=>{let n=+`0x${e.slice(130)}`;if(!Number.isNaN(n))try{return Bo(n)}catch{throw new Ls({value:n})}})();return typeof s>"u"?{r:t,s:r}:{r:t,s:r,yParity:s}}function Jy(e){if(!(typeof e.r>"u")&&!(typeof e.s>"u"))return qc(e)}function qc(e){let t=typeof e=="string"?Dc(e):e instanceof Uint8Array?mf(e):typeof e.r=="string"?bf(e):e.v?wf(e):{r:e.r,s:e.s,...typeof e.yParity<"u"?{yParity:e.yParity}:{}};return Ro(t),t}function Qy(e){return yf(It(e))}function yf(e){let{r:t,s:r}=At.Signature.fromDER(gr(e).slice(2));return{r:t,s:r}}function wf(e){return{r:e.r,s:e.s,yParity:Bo(e.v)}}function bf(e){let t=(()=>{let r=e.v?Number(e.v):void 0,s=e.yParity?Number(e.yParity):void 0;if(typeof r=="number"&&typeof s!="number"&&(s=Bo(r)),typeof s!="number")throw new Ls({value:e.yParity});return s})();return{r:BigInt(e.r),s:BigInt(e.s),yParity:t}}function ew(e){let[t,r,s]=e;return qc({r:r==="0x"?0n:BigInt(r),s:s==="0x"?0n:BigInt(s),yParity:t==="0x"?0:Number(t)})}function tw(e){return ii(vf(e))}function vf(e){Ro(e);let t=e.r,r=e.s;return Eo(_t(t,{size:32}),_t(r,{size:32}),typeof e.yParity=="number"?_t(Fc(e.yParity),{size:1}):"0x")}function rw(e){return new At.Signature(e.r,e.s).toDERRawBytes()}function sw(e){return`0x${new At.Signature(e.r,e.s).toDERHex()}`}function nw(e){return{r:e.r,s:e.s,v:Fc(e.yParity)}}function iw(e){let{r:t,s:r,yParity:s}=e;return{r:_t(t,{size:32}),s:_t(r,{size:32}),yParity:s===0?"0x0":"0x1"}}function ow(e){let{r:t,s:r,yParity:s}=e;return[s?"0x01":"0x",t===0n?"0x":pc(_t(t)),r===0n?"0x":pc(_t(r))]}function aw(e,t={}){try{return Ro(e,t),!0}catch{return!1}}function Bo(e){if(e===0||e===27)return 0;if(e===1||e===28)return 1;if(e>=35)return e%2===0?1:0;throw new No({value:e})}function Fc(e){if(e===0)return 27;if(e===1)return 28;throw new Ls({value:e})}var Po=class extends pe{constructor({signature:t}){super(`Value \`${t}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${Ft(gr(t))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}},yn=class extends pe{constructor({signature:t}){super(`Signature \`${Xr(t)}\` is missing either an \`r\`, \`s\`, or \`yParity\` property.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.MissingPropertiesError"})}},Oo=class extends pe{constructor({value:t}){super(`Value \`${t}\` is an invalid r value. r must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidRError"})}},ko=class extends pe{constructor({value:t}){super(`Value \`${t}\` is an invalid s value. s must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSError"})}},Ls=class extends pe{constructor({value:t}){super(`Value \`${t}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}},No=class extends pe{constructor({value:t}){super(`Value \`${t}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}};var Uo={};qh(Uo,{createKeyPair:()=>uw,getPublicKey:()=>Ef,getSharedSecret:()=>hw,noble:()=>lw,randomPrivateKey:()=>Sf,recoverAddress:()=>Cf,recoverPublicKey:()=>If,sign:()=>pw,verify:()=>fw});m();w();y();m();w();y();var xf=!1;var lw=At;function uw(e={}){let{as:t="Hex"}=e,r=Sf({as:t}),s=Ef({privateKey:r});return{privateKey:r,publicKey:s}}function Ef(e){let{privateKey:t}=e,r=At.ProjectivePoint.fromPrivateKey(gr(t).slice(2));return bc(r)}function hw(e){let{as:t="Hex",privateKey:r,publicKey:s}=e,o=At.ProjectivePoint.fromHex(oi(s).slice(2)).multiply(At.utils.normPrivateKeyToScalar(gr(r).slice(2))).toRawBytes(!0);return t==="Hex"?It(o):o}function Sf(e={}){let{as:t="Hex"}=e,r=At.utils.randomPrivateKey();return t==="Hex"?It(r):r}function Cf(e){return Kp(If(e))}function If(e){let{payload:t,signature:r}=e,{r:s,s:n,yParity:i}=r,a=new At.Signature(BigInt(s),BigInt(n)).addRecoveryBit(i).recoverPublicKey(gr(t).substring(2));return bc(a)}function pw(e){let{extraEntropy:t=xf,hash:r,payload:s,privateKey:n}=e,{r:i,s:o,recovery:a}=At.sign(mn(s),mn(n),{extraEntropy:typeof t=="boolean"?t:gr(t).slice(2),lowS:!0,...r?{prehash:!0}:{}});return{r:i,s:o,yParity:a}}function fw(e){let{address:t,hash:r,payload:s,publicKey:n,signature:i}=e;return t?Gp(t,Cf({payload:s,signature:i})):At.verify(i,mn(s),Hp(n),...r?[{prehash:!0,lowS:!0}]:[])}m();w();y();m();w();y();m();w();y();m();w();y();m();w();y();function Us(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function ci(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Us(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function $s(e,t){t||(t=e.reduce((n,i)=>n+i.length,0));let r=ci(t),s=0;for(let n of e)r.set(n,s),s+=n.length;return Us(r)}m();w();y();m();w();y();m();w();y();function Tf(e,t,r,s){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:s}}}var _f=Tf("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Mc=Tf("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=ci(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),dw={utf8:_f,"utf-8":_f,hex:an.base16,latin1:Mc,ascii:Mc,binary:Mc,...an},$o=dw;function mt(e,t="utf8"){let r=$o[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Us(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}m();w();y();function ot(e,t="utf8"){let r=$o[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}m();w();y();var wd=xs(I1(),1);m();w();y();var mr={exports:{}};function gw(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}var mw=yw;function yw(e,t,r){var s=r&&r.stringify||gw,n=1;if(typeof e=="object"&&e!==null){var i=t.length+n;if(i===1)return e;var o=new Array(i);o[0]=s(e);for(var a=1;a<i;a++)o[a]=s(t[a]);return o.join(" ")}if(typeof e!="string")return e;var c=t.length;if(c===0)return e;for(var l="",u=1-n,h=-1,p=e&&e.length||0,f=0;f<p;){if(e.charCodeAt(f)===37&&f+1<p){switch(h=h>-1?h:0,e.charCodeAt(f+1)){case 100:case 102:if(u>=c||t[u]==null)break;h<f&&(l+=e.slice(h,f)),l+=Number(t[u]),h=f+2,f++;break;case 105:if(u>=c||t[u]==null)break;h<f&&(l+=e.slice(h,f)),l+=Math.floor(Number(t[u])),h=f+2,f++;break;case 79:case 111:case 106:if(u>=c||t[u]===void 0)break;h<f&&(l+=e.slice(h,f));var g=typeof t[u];if(g==="string"){l+="'"+t[u]+"'",h=f+2,f++;break}if(g==="function"){l+=t[u].name||"<anonymous>",h=f+2,f++;break}l+=s(t[u]),h=f+2,f++;break;case 115:if(u>=c)break;h<f&&(l+=e.slice(h,f)),l+=String(t[u]),h=f+2,f++;break;case 37:h<f&&(l+=e.slice(h,f)),l+="%",h=f+2,f++,u--;break}++u}++f}return h===-1?e:(h<p&&(l+=e.slice(h)),l)}var Af=mw;mr.exports=Rr;var li=Nw().console||{},ww={mapHttpRequest:jo,mapHttpResponse:jo,wrapRequestSerializer:zc,wrapResponseSerializer:zc,wrapErrorSerializer:zc,req:jo,res:jo,err:Of,errWithCause:Of};function Qr(e,t){return e==="silent"?1/0:t.levels.values[e]}var Xc=Symbol("pino.logFuncs"),Hc=Symbol("pino.hierarchy"),bw={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function Pf(e,t){let r={logger:t,parent:e[Hc]};t[Hc]=r}function vw(e,t,r){let s={};t.forEach(n=>{s[n]=r[n]?r[n]:li[n]||li[bw[n]||"log"]||wn}),e[Xc]=s}function xw(e,t){return Array.isArray(e)?e.filter(function(r){return r!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function Rr(e){e=e||{},e.browser=e.browser||{};let t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");let r=e.browser.write||li;e.browser.write&&(e.browser.asObject=!0);let s=e.serializers||{},n=xw(e.browser.serialize,s),i=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);let o=Object.keys(e.customLevels||{}),a=["error","fatal","warn","info","debug","trace"].concat(o);typeof r=="function"&&a.forEach(function(d){r[d]=r}),(e.enabled===!1||e.browser.disabled)&&(e.level="silent");let c=e.level||"info",l=Object.create(r);l.log||(l.log=wn),vw(l,a,r),Pf({},l),Object.defineProperty(l,"levelVal",{get:h}),Object.defineProperty(l,"level",{get:p,set:f});let u={transmit:t,serialize:n,asObject:e.browser.asObject,asObjectBindingsOnly:e.browser.asObjectBindingsOnly,formatters:e.browser.formatters,levels:a,timestamp:Pw(e),messageKey:e.messageKey||"msg",onChild:e.onChild||wn};l.levels=Ew(e),l.level=c,l.isLevelEnabled=function(d){return this.levels.values[d]?this.levels.values[d]>=this.levels.values[this.level]:!1},l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=wn,l.serializers=s,l._serialize=n,l._stdErrSerialize=i,l.child=function(...d){return g.call(this,u,...d)},t&&(l._logEvent=Vc());function h(){return Qr(this.level,this)}function p(){return this._level}function f(d){if(d!=="silent"&&!this.levels.values[d])throw Error("unknown level "+d);this._level=d,js(this,u,l,"error"),js(this,u,l,"fatal"),js(this,u,l,"warn"),js(this,u,l,"info"),js(this,u,l,"debug"),js(this,u,l,"trace"),o.forEach(b=>{js(this,u,l,b)})}function g(d,b,k){if(!b)throw new Error("missing bindings for child Pino");k=k||{},n&&b.serializers&&(k.serializers=b.serializers);let q=k.serializers;if(n&&q){var T=Object.assign({},s,q),I=e.browser.serialize===!0?Object.keys(T):n;delete b.serializers,Jc([b],I,T,this._stdErrSerialize)}function L(j){this._childLevel=(j._childLevel|0)+1,this.bindings=b,T&&(this.serializers=T,this._serialize=I),t&&(this._logEvent=Vc([].concat(j._logEvent.bindings,b)))}L.prototype=this;let R=new L(this);return Pf(this,R),R.child=function(...j){return g.call(this,d,...j)},R.level=k.level||this.level,d.onChild(R),R}return l}function Ew(e){let t=e.customLevels||{},r=Object.assign({},Rr.levels.values,t),s=Object.assign({},Rr.levels.labels,Sw(t));return{values:r,labels:s}}function Sw(e){let t={};return Object.keys(e).forEach(function(r){t[e[r]]=r}),t}Rr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Rr.stdSerializers=ww,Rr.stdTimeFunctions=Object.assign({},{nullTime:Bf,epochTime:Lf,unixTime:Ow,isoTime:kw});function Cw(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[Hc];for(;r.parent;)r=r.parent,r.logger.bindings&&t.push(r.logger.bindings);return t.reverse()}function js(e,t,r,s){if(Object.defineProperty(e,s,{value:Qr(e.level,r)>Qr(s,r)?wn:r[Xc][s],writable:!0,enumerable:!0,configurable:!0}),e[s]===wn){if(!t.transmit)return;let i=t.transmit.level||e.level,o=Qr(i,r);if(Qr(s,r)<o)return}e[s]=_w(e,t,r,s);let n=Cw(e);n.length!==0&&(e[s]=Iw(n,e[s]))}function Iw(e,t){return function(){return t.apply(this,[...e,...arguments])}}function _w(e,t,r,s){return function(n){return function(){let i=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===li?li:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];var l=!1;if(t.serialize&&(Jc(o,this._serialize,this.serializers,this._stdErrSerialize),l=!0),t.asObject||t.formatters?n.call(a,...Tw(this,s,o,i,t)):n.apply(a,o),t.transmit){let u=t.transmit.level||e._level,h=Qr(u,r),p=Qr(s,r);if(p<h)return;Aw(this,{ts:i,methodLevel:s,methodValue:p,transmitLevel:u,transmitValue:r.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:Qr(e._level,r)},o,l)}}}(e[Xc][s])}function Tw(e,t,r,s,n){let{level:i,log:o=h=>h}=n.formatters||{},a=r.slice(),c=a[0],l={},u=(e._childLevel|0)+1;if(u<1&&(u=1),s&&(l.time=s),i){let h=i(t,e.levels.values[t]);Object.assign(l,h)}else l.level=e.levels.values[t];if(n.asObjectBindingsOnly){if(c!==null&&typeof c=="object")for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());return[o(l),...a]}else{if(c!==null&&typeof c=="object"){for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());c=a.length?Af(a.shift(),a):void 0}else typeof c=="string"&&(c=Af(a.shift(),a));return c!==void 0&&(l[n.messageKey]=c),[o(l)]}}function Jc(e,t,r,s){for(let n in e)if(s&&e[n]instanceof Error)e[n]=Rr.stdSerializers.err(e[n]);else if(typeof e[n]=="object"&&!Array.isArray(e[n])&&t)for(let i in e[n])t.indexOf(i)>-1&&i in r&&(e[n][i]=r[i](e[n][i]))}function Aw(e,t,r,s=!1){let n=t.send,i=t.ts,o=t.methodLevel,a=t.methodValue,c=t.val,l=e._logEvent.bindings;s||Jc(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter(function(u){return l.indexOf(u)===-1}),e._logEvent.level.label=o,e._logEvent.level.value=a,n(o,e._logEvent,c),e._logEvent=Vc(l)}function Vc(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function Of(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)t[r]===void 0&&(t[r]=e[r]);return t}function Pw(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?Bf:Lf}function jo(){return{}}function zc(e){return e}function wn(){}function Bf(){return!1}function Lf(){return Date.now()}function Ow(){return Math.round(Date.now()/1e3)}function kw(){return new Date(Date.now()).toISOString()}function Nw(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}mr.exports.default=Rr;var vT=mr.exports.pino=Rr;var Qc=1e3*1024,Rw=Object.defineProperty,Bw=(e,t,r)=>t in e?Rw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Jr=(e,t,r)=>Bw(e,typeof t!="symbol"?t+"":t,r),Kc=class{constructor(t){Jr(this,"nodeValue"),Jr(this,"sizeInBytes"),Jr(this,"next"),this.nodeValue=t,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},qo=class{constructor(t){Jr(this,"lengthInNodes"),Jr(this,"sizeInBytes"),Jr(this,"head"),Jr(this,"tail"),Jr(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=t,this.sizeInBytes=0}append(t){let r=new Kc(t);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${t} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;let t=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=t.size}toArray(){let t=[],r=this.head;for(;r!==null;)t.push(r.value),r=r.next;return t}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let t=this.head;return{next:()=>{if(!t)return{done:!0,value:null};let r=t.value;return t=t.next,{done:!1,value:r}}}}},Lw=e=>JSON.stringify(e,(t,r)=>typeof r=="bigint"?r.toString()+"n":r);function kf(e){return typeof e=="string"?e:Lw(e)||""}var Uw=Object.defineProperty,$w=(e,t,r)=>t in e?Uw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Do=(e,t,r)=>$w(e,typeof t!="symbol"?t+"":t,r),Fo=class{constructor(t,r=Qc){Do(this,"logs"),Do(this,"level"),Do(this,"levelValue"),Do(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=t??"error",this.levelValue=mr.exports.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new qo(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(t,r){r===mr.exports.levels.values.error?console.error(t):r===mr.exports.levels.values.warn?console.warn(t):r===mr.exports.levels.values.debug?console.debug(t):r===mr.exports.levels.values.trace?console.trace(t):console.log(t)}appendToLogs(t){this.logs.append(kf({timestamp:new Date().toISOString(),log:t}));let r=typeof t=="string"?JSON.parse(t).level:t.level;r>=this.levelValue&&this.forwardToConsole(t,r)}getLogs(){return this.logs}clearLogs(){this.logs=new qo(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(t){let r=this.getLogArray();return r.push(kf({extraMetadata:t})),new Blob(r,{type:"application/json"})}},jw=Object.defineProperty,Dw=(e,t,r)=>t in e?jw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,qw=(e,t,r)=>Dw(e,typeof t!="symbol"?t+"":t,r),Gc=class{constructor(t,r=Qc){qw(this,"baseChunkLogger"),this.baseChunkLogger=new Fo(t,r)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}downloadLogsBlobInBrowser(t){let r=URL.createObjectURL(this.logsToBlob(t)),s=document.createElement("a");s.href=r,s.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}},Fw=Object.defineProperty,Mw=(e,t,r)=>t in e?Fw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,zw=(e,t,r)=>Mw(e,typeof t!="symbol"?t+"":t,r),Wc=class{constructor(t,r=Qc){zw(this,"baseChunkLogger"),this.baseChunkLogger=new Fo(t,r)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}},Hw=Object.defineProperty,Vw=Object.defineProperties,Kw=Object.getOwnPropertyDescriptors,Nf=Object.getOwnPropertySymbols,Gw=Object.prototype.hasOwnProperty,Ww=Object.prototype.propertyIsEnumerable,Rf=(e,t,r)=>t in e?Hw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Zc=(e,t)=>{for(var r in t||(t={}))Gw.call(t,r)&&Rf(e,r,t[r]);if(Nf)for(var r of Nf(t))Ww.call(t,r)&&Rf(e,r,t[r]);return e},Yc=(e,t)=>Vw(e,Kw(t));function Zw(e){var t,r;let s=new Gc((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:mr.exports(Yc(Zc({},e.opts),{level:"trace",browser:Yc(Zc({},(r=e.opts)==null?void 0:r.browser),{write:n=>s.write(n)})})),chunkLoggerController:s}}function Yw(e){var t;let r=new Wc((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:mr.exports(Yc(Zc({},e.opts),{level:"trace"}),r),chunkLoggerController:r}}function Uf(e){return typeof e.loggerOverride<"u"&&typeof e.loggerOverride!="string"?{logger:e.loggerOverride,chunkLoggerController:null}:typeof window<"u"?Zw(e):Yw(e)}var Xw=":";function sr(e){let[t,r]=e.split(Xw);return{namespace:t,reference:r}}function bd(e,t){return e.includes(":")?[e]:t.chains||[]}var Jw=Object.defineProperty,Qw=Object.defineProperties,e2=Object.getOwnPropertyDescriptors,$f=Object.getOwnPropertySymbols,t2=Object.prototype.hasOwnProperty,r2=Object.prototype.propertyIsEnumerable,pl=(e,t,r)=>t in e?Jw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,jf=(e,t)=>{for(var r in t||(t={}))t2.call(t,r)&&pl(e,r,t[r]);if($f)for(var r of $f(t))r2.call(t,r)&&pl(e,r,t[r]);return e},s2=(e,t)=>Qw(e,e2(t)),Df=(e,t,r)=>pl(e,typeof t!="symbol"?t+"":t,r),n2="ReactNative",wt={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"};var i2="js";function wi(){return typeof $<"u"&&typeof $.versions<"u"&&typeof $.versions.node<"u"}function qr(){return!(0,tr.getDocument)()&&!!(0,tr.getNavigator)()&&navigator.product===n2}function vd(){return qr()&&typeof globalThis<"u"&&typeof globalThis?.Platform<"u"&&globalThis?.Platform.OS==="android"}function xd(){return qr()&&typeof globalThis<"u"&&typeof globalThis?.Platform<"u"&&globalThis?.Platform.OS==="ios"}function Hs(){return!wi()&&!!(0,tr.getNavigator)()&&!!(0,tr.getDocument)()}function bi(){return qr()?wt.reactNative:wi()?wt.node:Hs()?wt.browser:wt.unknown}function Nl(){var e;try{return qr()&&typeof globalThis<"u"&&typeof globalThis?.Application<"u"?(e=globalThis.Application)==null?void 0:e.applicationId:void 0}catch{return}}function o2(e,t){let r=new URLSearchParams(e);return Object.entries(t).sort(([s],[n])=>s.localeCompare(n)).forEach(([s,n])=>{n!=null&&r.set(s,String(n))}),r.toString()}function Ed(e){var t,r;let s=Rl();try{return e!=null&&e.url&&s.url&&new URL(e.url).host!==new URL(s.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${e.url} differs from the actual page url:${s.url}. This is probably unintended and can lead to issues.`),e.url=s.url),(t=e?.icons)!=null&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter(n=>n!=="")),s2(jf(jf({},s),e),{url:e?.url||s.url,name:e?.name||s.name,description:e?.description||s.description,icons:(r=e?.icons)!=null&&r.length&&e.icons.length>0?e.icons:s.icons})}catch(n){return console.warn("Error populating app metadata",n),e||s}}function Rl(){return(0,yd.getWindowMetadata)()||{name:"",description:"",url:"",icons:[""]}}function a2(){if(bi()===wt.reactNative&&typeof globalThis<"u"&&typeof globalThis?.Platform<"u"){let{OS:r,Version:s}=globalThis.Platform;return[r,s].join("-")}let e=tp();if(e===null)return"unknown";let t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function c2(){var e;let t=bi();return t===wt.browser?[t,((e=(0,tr.getLocation)())==null?void 0:e.host)||"unknown"].join(":"):t}function Bl(e,t,r){let s=a2(),n=c2();return[[e,t].join("-"),[i2,r].join("-"),s,n].join("/")}function Sd({protocol:e,version:t,relayUrl:r,sdkVersion:s,auth:n,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){let l=r.split("?"),u=Bl(e,t,s),h={auth:n,ua:u,projectId:i,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0},p=o2(l[1]||"",h);return l[0]+"?"+p}function Ds(e,t){return e.filter(r=>t.includes(r)).length===e.length}function ta(e){return Object.fromEntries(e.entries())}function ra(e){return new Map(Object.entries(e))}function Fr(e=jr.FIVE_MINUTES,t){let r=(0,jr.toMiliseconds)(e||jr.FIVE_MINUTES),s,n,i,o;return{resolve:a=>{i&&s&&(clearTimeout(i),s(a),o=Promise.resolve(a))},reject:a=>{i&&n&&(clearTimeout(i),n(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{let l=new Error(t);o=Promise.reject(l),c(l)},r),s=a,n=c})}}function nr(e,t,r){return new Promise(async(s,n)=>{let i=setTimeout(()=>n(new Error(r)),t);try{let o=await e;s(o)}catch(o){n(o)}clearTimeout(i)})}function Cd(e,t){if(typeof t=="string"&&t.startsWith(`${e}:`))return t;if(e.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(e.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Id(e){return Cd("topic",e)}function _d(e){return Cd("id",e)}function sa(e){let[t,r]=e.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function Ie(e,t){return(0,jr.fromMiliseconds)((t||Date.now())+(0,jr.toMiliseconds)(e))}function Ot(e){return Date.now()>=(0,jr.toMiliseconds)(e)}function fe(e,t){return`${e}${t?`:${t}`:""}`}function Qt(e=[],t=[]){return[...new Set([...e,...t])]}async function Td({id:e,topic:t,wcDeepLink:r}){var s;try{if(!r)return;let n=typeof r=="string"?JSON.parse(r):r,i=n?.href;if(typeof i!="string")return;let o=l2(i,e,t),a=bi();if(a===wt.browser){if(!((s=(0,tr.getDocument)())!=null&&s.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}u2(o)}else a===wt.reactNative&&typeof globalThis?.Linking<"u"&&await globalThis.Linking.openURL(o)}catch(n){console.error(n)}}function l2(e,t,r){let s=`requestId=${t}&sessionTopic=${r}`;e.endsWith("/")&&(e=e.slice(0,-1));let n=`${e}`;if(e.startsWith("https://t.me")){let i=e.includes("?")?"&startapp=":"?startapp=";n=`${n}${i}${f2(s,!0)}`}else n=`${n}/wc?${s}`;return n}function u2(e){let t="_self";p2()?t="_top":(h2()||e.startsWith("https://")||e.startsWith("http://"))&&(t="_blank"),window.open(e,t,"noreferrer noopener")}async function Ad(e,t){let r="";try{if(Hs()&&(r=localStorage.getItem(t),r))return r;r=await e.getItem(t)}catch(s){console.error(s)}return r}function Ll(e,t){if(!e.includes(t))return null;let r=e.split(/([&,?,=])/),s=r.indexOf(t);return r[s+2]}function Ul(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function vi(){return typeof $<"u"&&$.env.IS_VITEST==="true"}function h2(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function p2(){try{return window.self!==window.top}catch{return!1}}function f2(e,t=!1){let r=P.from(e).toString("base64");return t?r.replace(/[=]/g,""):r}function Pd(e){return P.from(e,"base64").toString("utf-8")}function Od(e){return new Promise(t=>setTimeout(t,e))}var Go=class{constructor({limit:t}){Df(this,"limit"),Df(this,"set"),this.limit=t,this.set=new Set}add(t){if(!this.set.has(t)){if(this.set.size>=this.limit){let r=this.set.values().next().value;r&&this.set.delete(r)}this.set.add(t)}}has(t){return this.set.has(t)}},Mo=BigInt(2**32-1),qf=BigInt(32);function kd(e,t=!1){return t?{h:Number(e&Mo),l:Number(e>>qf&Mo)}:{h:Number(e>>qf&Mo)|0,l:Number(e&Mo)|0}}function Nd(e,t=!1){let r=e.length,s=new Uint32Array(r),n=new Uint32Array(r);for(let i=0;i<r;i++){let{h:o,l:a}=kd(e[i],t);[s[i],n[i]]=[o,a]}return[s,n]}var Ff=(e,t,r)=>e>>>r,Mf=(e,t,r)=>e<<32-r|t>>>r,os=(e,t,r)=>e>>>r|t<<32-r,as=(e,t,r)=>e<<32-r|t>>>r,pi=(e,t,r)=>e<<64-r|t>>>r-32,fi=(e,t,r)=>e>>>r-32|t<<64-r,d2=(e,t)=>t,g2=(e,t)=>e,m2=(e,t,r)=>e<<r|t>>>32-r,y2=(e,t,r)=>t<<r|e>>>32-r,w2=(e,t,r)=>t<<r-32|e>>>64-r,b2=(e,t,r)=>e<<r-32|t>>>64-r;function Jt(e,t,r,s){let n=(t>>>0)+(s>>>0);return{h:e+r+(n/2**32|0)|0,l:n|0}}var $l=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),jl=(e,t,r,s)=>t+r+s+(e/2**32|0)|0,v2=(e,t,r,s)=>(e>>>0)+(t>>>0)+(r>>>0)+(s>>>0),x2=(e,t,r,s,n)=>t+r+s+n+(e/2**32|0)|0,E2=(e,t,r,s,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(s>>>0)+(n>>>0),S2=(e,t,r,s,n,i)=>t+r+s+n+i+(e/2**32|0)|0,bn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function na(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Dr(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function rr(e,...t){if(!na(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function ia(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Dr(e.outputLen),Dr(e.blockLen)}function hs(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Dl(e,t){rr(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function gi(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Mt(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function el(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function yr(e,t){return e<<32-t|e>>>t}var Rd=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Bd(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}var Lr=Rd?e=>e:e=>Bd(e);function C2(e){for(let t=0;t<e.length;t++)e[t]=Bd(e[t]);return e}var cs=Rd?e=>e:C2,Ld=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",I2=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function En(e){if(rr(e),Ld)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=I2[e[r]];return t}var Br={_0:48,_9:57,A:65,F:70,a:97,f:102};function zf(e){if(e>=Br._0&&e<=Br._9)return e-Br._0;if(e>=Br.A&&e<=Br.F)return e-(Br.A-10);if(e>=Br.a&&e<=Br.f)return e-(Br.a-10)}function Wo(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Ld)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let s=new Uint8Array(r);for(let n=0,i=0;n<r;n++,i+=2){let o=zf(e.charCodeAt(i)),a=zf(e.charCodeAt(i+1));if(o===void 0||a===void 0){let c=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}s[n]=o*16+a}return s}function Ud(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function er(e){return typeof e=="string"&&(e=Ud(e)),rr(e),e}function ls(...e){let t=0;for(let s=0;s<e.length;s++){let n=e[s];rr(n),t+=n.length}let r=new Uint8Array(t);for(let s=0,n=0;s<e.length;s++){let i=e[s];r.set(i,n),n+=i.length}return r}var Cn=class{};function xi(e){let t=s=>e().update(er(s)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function _2(e){let t=(s,n)=>e(n).update(er(s)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=s=>e(s),t}function Vs(e=32){if(bn&&typeof bn.getRandomValues=="function")return bn.getRandomValues(new Uint8Array(e));if(bn&&typeof bn.randomBytes=="function")return Uint8Array.from(bn.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}var T2=BigInt(0),ui=BigInt(1),A2=BigInt(2),P2=BigInt(7),O2=BigInt(256),k2=BigInt(113),$d=[],jd=[],Dd=[];for(let e=0,t=ui,r=1,s=0;e<24;e++){[r,s]=[s,(2*r+3*s)%5],$d.push(2*(5*s+r)),jd.push((e+1)*(e+2)/2%64);let n=T2;for(let i=0;i<7;i++)t=(t<<ui^(t>>P2)*k2)%O2,t&A2&&(n^=ui<<(ui<<BigInt(i))-ui);Dd.push(n)}var qd=Nd(Dd,!0),N2=qd[0],R2=qd[1],Hf=(e,t,r)=>r>32?w2(e,t,r):m2(e,t,r),Vf=(e,t,r)=>r>32?b2(e,t,r):y2(e,t,r);function B2(e,t=24){let r=new Uint32Array(10);for(let s=24-t;s<24;s++){for(let o=0;o<10;o++)r[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){let a=(o+8)%10,c=(o+2)%10,l=r[c],u=r[c+1],h=Hf(l,u,1)^r[a],p=Vf(l,u,1)^r[a+1];for(let f=0;f<50;f+=10)e[o+f]^=h,e[o+f+1]^=p}let n=e[2],i=e[3];for(let o=0;o<24;o++){let a=jd[o],c=Hf(n,i,a),l=Vf(n,i,a),u=$d[o];n=e[u],i=e[u+1],e[u]=c,e[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}e[0]^=N2[s],e[1]^=R2[s]}Mt(r)}var fl=class e extends Cn{constructor(t,r,s,n=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=r,this.outputLen=s,this.enableXOF=n,this.rounds=i,Dr(s),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=gi(this.state)}clone(){return this._cloneInto()}keccak(){cs(this.state32),B2(this.state32,this.rounds),cs(this.state32),this.posOut=0,this.pos=0}update(t){hs(this),t=er(t),rr(t);let{blockLen:r,state:s}=this,n=t.length;for(let i=0;i<n;){let o=Math.min(r-this.pos,n-i);for(let a=0;a<o;a++)s[this.pos++]^=t[i++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:r,pos:s,blockLen:n}=this;t[s]^=r,(r&128)!==0&&s===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){hs(this,!1),rr(t),this.finish();let r=this.state,{blockLen:s}=this;for(let n=0,i=t.length;n<i;){this.posOut>=s&&this.keccak();let o=Math.min(s-this.posOut,i-n);t.set(r.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Dr(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Dl(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Mt(this.state)}_cloneInto(t){let{blockLen:r,suffix:s,outputLen:n,rounds:i,enableXOF:o}=this;return t||(t=new e(r,s,n,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=s,t.outputLen=n,t.enableXOF=o,t.destroyed=this.destroyed,t}},L2=(e,t,r)=>xi(()=>new fl(t,e,r)),U2=L2(1,136,256/8);function $2(e,t,r,s){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,s);let n=BigInt(32),i=BigInt(4294967295),o=Number(r>>n&i),a=Number(r&i),c=s?4:0,l=s?0:4;e.setUint32(t+c,o,s),e.setUint32(t+l,a,s)}function j2(e,t,r){return e&t^~e&r}function D2(e,t,r){return e&t^e&r^t&r}var Zo=class extends Cn{constructor(t,r,s,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=s,this.isLE=n,this.buffer=new Uint8Array(t),this.view=el(this.buffer)}update(t){hs(this),t=er(t),rr(t);let{view:r,buffer:s,blockLen:n}=this,i=t.length;for(let o=0;o<i;){let a=Math.min(n-this.pos,i-o);if(a===n){let c=el(t);for(;n<=i-o;o+=n)this.process(c,o);continue}s.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){hs(this),Dl(t,this),this.finished=!0;let{buffer:r,view:s,blockLen:n,isLE:i}=this,{pos:o}=this;r[o++]=128,Mt(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(s,0),o=0);for(let h=o;h<n;h++)r[h]=0;$2(s,n-8,BigInt(this.length*8),i),this.process(s,0);let a=el(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],i)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let s=t.slice(0,r);return this.destroy(),s}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:s,length:n,finished:i,destroyed:o,pos:a}=this;return t.destroyed=o,t.finished=i,t.length=n,t.pos=a,n%r&&t.buffer.set(s),t}clone(){return this._cloneInto()}},es=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ke=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Ge=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),q2=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ts=new Uint32Array(64),dl=class extends Zo{constructor(t=32){super(64,t,8,!1),this.A=es[0]|0,this.B=es[1]|0,this.C=es[2]|0,this.D=es[3]|0,this.E=es[4]|0,this.F=es[5]|0,this.G=es[6]|0,this.H=es[7]|0}get(){let{A:t,B:r,C:s,D:n,E:i,F:o,G:a,H:c}=this;return[t,r,s,n,i,o,a,c]}set(t,r,s,n,i,o,a,c){this.A=t|0,this.B=r|0,this.C=s|0,this.D=n|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,r){for(let h=0;h<16;h++,r+=4)ts[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let p=ts[h-15],f=ts[h-2],g=yr(p,7)^yr(p,18)^p>>>3,d=yr(f,17)^yr(f,19)^f>>>10;ts[h]=d+ts[h-7]+g+ts[h-16]|0}let{A:s,B:n,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let h=0;h<64;h++){let p=yr(a,6)^yr(a,11)^yr(a,25),f=u+p+j2(a,c,l)+q2[h]+ts[h]|0,g=(yr(s,2)^yr(s,13)^yr(s,22))+D2(s,n,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=n,n=s,s=f+g|0}s=s+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(s,n,i,o,a,c,l,u)}roundClean(){Mt(ts)}destroy(){this.set(0,0,0,0,0,0,0,0),Mt(this.buffer)}},Fd=Nd(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),F2=Fd[0],M2=Fd[1],rs=new Uint32Array(80),ss=new Uint32Array(80),mi=class extends Zo{constructor(t=64){super(128,t,16,!1),this.Ah=Ge[0]|0,this.Al=Ge[1]|0,this.Bh=Ge[2]|0,this.Bl=Ge[3]|0,this.Ch=Ge[4]|0,this.Cl=Ge[5]|0,this.Dh=Ge[6]|0,this.Dl=Ge[7]|0,this.Eh=Ge[8]|0,this.El=Ge[9]|0,this.Fh=Ge[10]|0,this.Fl=Ge[11]|0,this.Gh=Ge[12]|0,this.Gl=Ge[13]|0,this.Hh=Ge[14]|0,this.Hl=Ge[15]|0}get(){let{Ah:t,Al:r,Bh:s,Bl:n,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:p,Gh:f,Gl:g,Hh:d,Hl:b}=this;return[t,r,s,n,i,o,a,c,l,u,h,p,f,g,d,b]}set(t,r,s,n,i,o,a,c,l,u,h,p,f,g,d,b){this.Ah=t|0,this.Al=r|0,this.Bh=s|0,this.Bl=n|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=p|0,this.Gh=f|0,this.Gl=g|0,this.Hh=d|0,this.Hl=b|0}process(t,r){for(let T=0;T<16;T++,r+=4)rs[T]=t.getUint32(r),ss[T]=t.getUint32(r+=4);for(let T=16;T<80;T++){let I=rs[T-15]|0,L=ss[T-15]|0,R=os(I,L,1)^os(I,L,8)^Ff(I,L,7),j=as(I,L,1)^as(I,L,8)^Mf(I,L,7),H=rs[T-2]|0,N=ss[T-2]|0,M=os(H,N,19)^pi(H,N,61)^Ff(H,N,6),V=as(H,N,19)^fi(H,N,61)^Mf(H,N,6),B=v2(j,V,ss[T-7],ss[T-16]),E=x2(B,R,M,rs[T-7],rs[T-16]);rs[T]=E|0,ss[T]=B|0}let{Ah:s,Al:n,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:p,Fh:f,Fl:g,Gh:d,Gl:b,Hh:k,Hl:q}=this;for(let T=0;T<80;T++){let I=os(h,p,14)^os(h,p,18)^pi(h,p,41),L=as(h,p,14)^as(h,p,18)^fi(h,p,41),R=h&f^~h&d,j=p&g^~p&b,H=E2(q,L,j,M2[T],ss[T]),N=S2(H,k,I,R,F2[T],rs[T]),M=H|0,V=os(s,n,28)^pi(s,n,34)^pi(s,n,39),B=as(s,n,28)^fi(s,n,34)^fi(s,n,39),E=s&i^s&a^i&a,_=n&o^n&c^o&c;k=d|0,q=b|0,d=f|0,b=g|0,f=h|0,g=p|0,{h,l:p}=Jt(l|0,u|0,N|0,M|0),l=a|0,u=c|0,a=i|0,c=o|0,i=s|0,o=n|0;let v=$l(M,B,_);s=jl(v,N,V,E),n=v|0}({h:s,l:n}=Jt(this.Ah|0,this.Al|0,s|0,n|0)),{h:i,l:o}=Jt(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Jt(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Jt(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:p}=Jt(this.Eh|0,this.El|0,h|0,p|0),{h:f,l:g}=Jt(this.Fh|0,this.Fl|0,f|0,g|0),{h:d,l:b}=Jt(this.Gh|0,this.Gl|0,d|0,b|0),{h:k,l:q}=Jt(this.Hh|0,this.Hl|0,k|0,q|0),this.set(s,n,i,o,a,c,l,u,h,p,f,g,d,b,k,q)}roundClean(){Mt(rs,ss)}destroy(){Mt(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},gl=class extends mi{constructor(){super(48),this.Ah=Ke[0]|0,this.Al=Ke[1]|0,this.Bh=Ke[2]|0,this.Bl=Ke[3]|0,this.Ch=Ke[4]|0,this.Cl=Ke[5]|0,this.Dh=Ke[6]|0,this.Dl=Ke[7]|0,this.Eh=Ke[8]|0,this.El=Ke[9]|0,this.Fh=Ke[10]|0,this.Fl=Ke[11]|0,this.Gh=Ke[12]|0,this.Gl=Ke[13]|0,this.Hh=Ke[14]|0,this.Hl=Ke[15]|0}},We=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]),ml=class extends mi{constructor(){super(32),this.Ah=We[0]|0,this.Al=We[1]|0,this.Bh=We[2]|0,this.Bl=We[3]|0,this.Ch=We[4]|0,this.Cl=We[5]|0,this.Dh=We[6]|0,this.Dl=We[7]|0,this.Eh=We[8]|0,this.El=We[9]|0,this.Fh=We[10]|0,this.Fl=We[11]|0,this.Gh=We[12]|0,this.Gl=We[13]|0,this.Hh=We[14]|0,this.Hl=We[15]|0}},oa=xi(()=>new dl),z2=xi(()=>new mi),H2=xi(()=>new gl),V2=xi(()=>new ml),K2=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Be=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),W=new Uint32Array(32);function ns(e,t,r,s,n,i){let o=n[i],a=n[i+1],c=W[2*e],l=W[2*e+1],u=W[2*t],h=W[2*t+1],p=W[2*r],f=W[2*r+1],g=W[2*s],d=W[2*s+1],b=$l(c,u,o);l=jl(b,l,h,a),c=b|0,{Dh:d,Dl:g}={Dh:d^l,Dl:g^c},{Dh:d,Dl:g}={Dh:d2(d,g),Dl:g2(d)},{h:f,l:p}=Jt(f,p,d,g),{Bh:h,Bl:u}={Bh:h^f,Bl:u^p},{Bh:h,Bl:u}={Bh:os(h,u,24),Bl:as(h,u,24)},W[2*e]=c,W[2*e+1]=l,W[2*t]=u,W[2*t+1]=h,W[2*r]=p,W[2*r+1]=f,W[2*s]=g,W[2*s+1]=d}function is(e,t,r,s,n,i){let o=n[i],a=n[i+1],c=W[2*e],l=W[2*e+1],u=W[2*t],h=W[2*t+1],p=W[2*r],f=W[2*r+1],g=W[2*s],d=W[2*s+1],b=$l(c,u,o);l=jl(b,l,h,a),c=b|0,{Dh:d,Dl:g}={Dh:d^l,Dl:g^c},{Dh:d,Dl:g}={Dh:os(d,g,16),Dl:as(d,g,16)},{h:f,l:p}=Jt(f,p,d,g),{Bh:h,Bl:u}={Bh:h^f,Bl:u^p},{Bh:h,Bl:u}={Bh:pi(h,u,63),Bl:fi(h,u,63)},W[2*e]=c,W[2*e+1]=l,W[2*t]=u,W[2*t+1]=h,W[2*r]=p,W[2*r+1]=f,W[2*s]=g,W[2*s+1]=d}function G2(e,t={},r,s,n){if(Dr(r),e<0||e>r)throw new Error("outputLen bigger than keyLen");let{key:i,salt:o,personalization:a}=t;if(i!==void 0&&(i.length<1||i.length>r))throw new Error("key length must be undefined or 1.."+r);if(o!==void 0&&o.length!==s)throw new Error("salt must be undefined or "+s);if(a!==void 0&&a.length!==n)throw new Error("personalization must be undefined or "+n)}var yl=class extends Cn{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Dr(t),Dr(r),this.blockLen=t,this.outputLen=r,this.buffer=new Uint8Array(t),this.buffer32=gi(this.buffer)}update(t){hs(this),t=er(t),rr(t);let{blockLen:r,buffer:s,buffer32:n}=this,i=t.length,o=t.byteOffset,a=t.buffer;for(let c=0;c<i;){this.pos===r&&(cs(n),this.compress(n,0,!1),cs(n),this.pos=0);let l=Math.min(r-this.pos,i-c),u=o+c;if(l===r&&!(u%4)&&c+l<i){let h=new Uint32Array(a,u,Math.floor((i-c)/4));cs(h);for(let p=0;c+r<i;p+=n.length,c+=r)this.length+=r,this.compress(h,p,!1);cs(h);continue}s.set(t.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(t){hs(this),Dl(t,this);let{pos:r,buffer32:s}=this;this.finished=!0,Mt(this.buffer.subarray(r)),cs(s),this.compress(s,0,!0),cs(s);let n=gi(t);this.get().forEach((i,o)=>n[o]=Lr(i))}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let s=t.slice(0,r);return this.destroy(),s}_cloneInto(t){let{buffer:r,length:s,finished:n,destroyed:i,outputLen:o,pos:a}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.buffer.set(r),t.destroyed=i,t.finished=n,t.length=s,t.pos=a,t.outputLen=o,t}clone(){return this._cloneInto()}},wl=class extends yl{constructor(t={}){let r=t.dkLen===void 0?64:t.dkLen;super(128,r),this.v0l=Be[0]|0,this.v0h=Be[1]|0,this.v1l=Be[2]|0,this.v1h=Be[3]|0,this.v2l=Be[4]|0,this.v2h=Be[5]|0,this.v3l=Be[6]|0,this.v3h=Be[7]|0,this.v4l=Be[8]|0,this.v4h=Be[9]|0,this.v5l=Be[10]|0,this.v5h=Be[11]|0,this.v6l=Be[12]|0,this.v6h=Be[13]|0,this.v7l=Be[14]|0,this.v7h=Be[15]|0,G2(r,t,64,16,16);let{key:s,personalization:n,salt:i}=t,o=0;if(s!==void 0&&(s=er(s),o=s.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=er(i);let a=gi(i);this.v4l^=Lr(a[0]),this.v4h^=Lr(a[1]),this.v5l^=Lr(a[2]),this.v5h^=Lr(a[3])}if(n!==void 0){n=er(n);let a=gi(n);this.v6l^=Lr(a[0]),this.v6h^=Lr(a[1]),this.v7l^=Lr(a[2]),this.v7h^=Lr(a[3])}if(s!==void 0){let a=new Uint8Array(this.blockLen);a.set(s),this.update(a)}}get(){let{v0l:t,v0h:r,v1l:s,v1h:n,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:h,v5h:p,v6l:f,v6h:g,v7l:d,v7h:b}=this;return[t,r,s,n,i,o,a,c,l,u,h,p,f,g,d,b]}set(t,r,s,n,i,o,a,c,l,u,h,p,f,g,d,b){this.v0l=t|0,this.v0h=r|0,this.v1l=s|0,this.v1h=n|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=h|0,this.v5h=p|0,this.v6l=f|0,this.v6h=g|0,this.v7l=d|0,this.v7h=b|0}compress(t,r,s){this.get().forEach((c,l)=>W[l]=c),W.set(Be,16);let{h:n,l:i}=kd(BigInt(this.length));W[24]=Be[8]^i,W[25]=Be[9]^n,s&&(W[28]=~W[28],W[29]=~W[29]);let o=0,a=K2;for(let c=0;c<12;c++)ns(0,4,8,12,t,r+2*a[o++]),is(0,4,8,12,t,r+2*a[o++]),ns(1,5,9,13,t,r+2*a[o++]),is(1,5,9,13,t,r+2*a[o++]),ns(2,6,10,14,t,r+2*a[o++]),is(2,6,10,14,t,r+2*a[o++]),ns(3,7,11,15,t,r+2*a[o++]),is(3,7,11,15,t,r+2*a[o++]),ns(0,5,10,15,t,r+2*a[o++]),is(0,5,10,15,t,r+2*a[o++]),ns(1,6,11,12,t,r+2*a[o++]),is(1,6,11,12,t,r+2*a[o++]),ns(2,7,8,13,t,r+2*a[o++]),is(2,7,8,13,t,r+2*a[o++]),ns(3,4,9,14,t,r+2*a[o++]),is(3,4,9,14,t,r+2*a[o++]);this.v0l^=W[0]^W[16],this.v0h^=W[1]^W[17],this.v1l^=W[2]^W[18],this.v1h^=W[3]^W[19],this.v2l^=W[4]^W[20],this.v2h^=W[5]^W[21],this.v3l^=W[6]^W[22],this.v3h^=W[7]^W[23],this.v4l^=W[8]^W[24],this.v4h^=W[9]^W[25],this.v5l^=W[10]^W[26],this.v5h^=W[11]^W[27],this.v6l^=W[12]^W[28],this.v6h^=W[13]^W[29],this.v7l^=W[14]^W[30],this.v7h^=W[15]^W[31],Mt(W)}destroy(){this.destroyed=!0,Mt(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},W2=_2(e=>new wl(e)),Z2="https://rpc.walletconnect.org/v1";function Md(e){let t=`Ethereum Signed Message:
${e.length}`,r=new TextEncoder().encode(t+e);return"0x"+P.from(U2(r)).toString("hex")}async function Y2(e,t,r,s,n,i){switch(r.t){case"eip191":return await X2(e,t,r.s);case"eip1271":return await J2(e,t,r.s,s,n,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}function X2(e,t,r){let s=Lo.fromHex(r);return Uo.recoverAddress({payload:Md(t),signature:s}).toLowerCase()===e.toLowerCase()}async function J2(e,t,r,s,n,i){let o=sr(s);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${s}`);try{let a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=r.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),h=(t.startsWith("0x")?t:Md(t)).substring(2),p=a+h+c+u+l,f=await fetch(`${i||Z2}/?chainId=${s}&projectId=${n}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:Q2(),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:p},"latest"]})}),{result:g}=await f.json();return g?g.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function Q2(){return Date.now()+Math.floor(Math.random()*1e3)}function zd(e){let t=atob(e),r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);let s=r[0];if(s===0)throw new Error("No signatures found");let n=1+s*64;if(r.length<n)throw new Error("Transaction data too short for claimed signature count");if(r.length<100)throw new Error("Transaction too short");let i=P.from(e,"base64").slice(1,65);return on.encode(i)}function Hd(e){let t=new Uint8Array(P.from(e,"base64")),r=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),s=new Uint8Array(r.length+t.length);s.set(r),s.set(t,r.length);let n=W2(s,{dkLen:32});return on.encode(n)}function ql(e){let t=new Uint8Array(oa(eb(e)));return on.encode(t)}function eb(e){if(e instanceof Uint8Array)return e;if(Array.isArray(e))return new Uint8Array(e);if(typeof e=="object"&&e!=null&&e.data)return new Uint8Array(Object.values(e.data));if(typeof e=="object"&&e)return new Uint8Array(Object.values(e));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function Fl(e){let t=P.from(e,"base64"),r=ip(t).txn;if(!r)throw new Error("Invalid signed transaction: missing 'txn' field");let s=np(r),n=P.from("TX"),i=P.concat([n,P.from(s)]),o=V2(i);return sp.encode(o).replace(/=+$/,"")}function tl(e){let t=[],r=BigInt(e);for(;r>=BigInt(128);)t.push(Number(r&BigInt(127)|BigInt(128))),r>>=BigInt(7);return t.push(Number(r)),P.from(t)}function Vd(e){let t=P.from(e.signed.bodyBytes,"base64"),r=P.from(e.signed.authInfoBytes,"base64"),s=P.from(e.signature.signature,"base64"),n=[];n.push(P.from([10])),n.push(tl(t.length)),n.push(t),n.push(P.from([18])),n.push(tl(r.length)),n.push(r),n.push(P.from([26])),n.push(tl(s.length)),n.push(s);let i=P.concat(n),o=oa(i);return P.from(o).toString("hex").toUpperCase()}function Kd(e){var t,r;let s=[];try{if(typeof e=="string")return s.push(e),s;if(typeof e!="object")return s;e!=null&&e.id&&s.push(e.id);let n=(r=(t=e?.capabilities)==null?void 0:t.caip345)==null?void 0:r.transactionHashes;n&&s.push(...n)}catch(n){console.warn("getWalletSendCallsHashes failed: ",n)}return s}var tb=Object.defineProperty,rb=Object.defineProperties,sb=Object.getOwnPropertyDescriptors,Kf=Object.getOwnPropertySymbols,nb=Object.prototype.hasOwnProperty,ib=Object.prototype.propertyIsEnumerable,Gf=(e,t,r)=>t in e?tb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ob=(e,t)=>{for(var r in t||(t={}))nb.call(t,r)&&Gf(e,r,t[r]);if(Kf)for(var r of Kf(t))ib.call(t,r)&&Gf(e,r,t[r]);return e},ab=(e,t)=>rb(e,sb(t)),Gd="did:pkh:",cb={eip155:"Ethereum",solana:"Solana",bip122:"Bitcoin"},lb=e=>e?cb[e]||e:"",aa=e=>e?.split(":"),ub=e=>{let t=e&&aa(e);if(t)return e.includes(Gd)?t[3]:t[1]},hb=e=>{let t=e&&aa(e);if(t)return e.includes(Gd)?t[2]:t[0]},ca=e=>{let t=e&&aa(e);if(t)return t[2]+":"+t[3]},Ei=e=>{let t=e&&aa(e);if(t)return t.pop()};async function Ml(e){let{cacao:t,projectId:r}=e,{s,p:n}=t,i=zl(n,n.iss),o=Ei(n.iss);return await Y2(o,i,s,ca(n.iss),r)}var zl=(e,t)=>{let r=hb(t);if(!r)throw new Error("Invalid issuer: "+t);let s=`${e.domain} wants you to sign in with your ${lb(r)} account:`,n=Ei(t);if(!e.aud&&!e.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=e.statement||void 0,o=`URI: ${e.aud||e.uri}`,a=`Version: ${e.version}`,c=`Chain ID: ${ub(t)}`,l=`Nonce: ${e.nonce}`,u=`Issued At: ${e.iat}`,h=e.exp?`Expiration Time: ${e.exp}`:void 0,p=e.nbf?`Not Before: ${e.nbf}`:void 0,f=e.requestId?`Request ID: ${e.requestId}`:void 0,g=e.resources?`Resources:${e.resources.map(b=>`
- ${b}`).join("")}`:void 0,d=Si(e.resources);if(d){let b=yi(d);i=wb(i,b)}return[s,n,"",i,"",o,a,c,l,u,h,p,f,g].filter(b=>b!=null).join(`
`)};function pb(e){return P.from(JSON.stringify(e)).toString("base64")}function fb(e){return JSON.parse(P.from(e,"base64").toString("utf-8"))}function zs(e){if(!e)throw new Error("No recap provided, value is undefined");if(!e.att)throw new Error("No `att` property found");let t=Object.keys(e.att);if(!(t!=null&&t.length))throw new Error("No resources found in `att` property");t.forEach(r=>{let s=e.att[r];if(Array.isArray(s))throw new Error(`Resource must be an object: ${r}`);if(typeof s!="object")throw new Error(`Resource must be an object: ${r}`);if(!Object.keys(s).length)throw new Error(`Resource object is empty: ${r}`);Object.keys(s).forEach(n=>{let i=s[n];if(!Array.isArray(i))throw new Error(`Ability limits ${n} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${n} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${n}) must be an array of objects, found: ${o}`)})})})}function db(e,t,r,s={}){return r?.sort((n,i)=>n.localeCompare(i)),{att:{[e]:gb(t,r,s)}}}function gb(e,t,r={}){t=t?.sort((n,i)=>n.localeCompare(i));let s=t.map(n=>({[`${e}/${n}`]:[r]}));return Object.assign({},...s)}function Wd(e){return zs(e),`urn:recap:${pb(e).replace(/=/g,"")}`}function yi(e){let t=fb(e.replace("urn:recap:",""));return zs(t),t}function Zd(e,t,r){let s=db(e,t,r);return Wd(s)}function mb(e){return e&&e.includes("urn:recap:")}function Yd(e,t){let r=yi(e),s=yi(t),n=yb(r,s);return Wd(n)}function yb(e,t){zs(e),zs(t);let r=Object.keys(e.att).concat(Object.keys(t.att)).sort((n,i)=>n.localeCompare(i)),s={att:{}};return r.forEach(n=>{var i,o;Object.keys(((i=e.att)==null?void 0:i[n])||{}).concat(Object.keys(((o=t.att)==null?void 0:o[n])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;s.att[n]=ab(ob({},s.att[n]),{[a]:((c=e.att[n])==null?void 0:c[a])||((l=t.att[n])==null?void 0:l[a])})})}),s}function wb(e="",t){zs(t);let r="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(r))return e;let s=[],n=0;Object.keys(t.att).forEach(a=>{let c=Object.keys(t.att[a]).map(h=>({ability:h.split("/")[0],action:h.split("/")[1]}));c.sort((h,p)=>h.action.localeCompare(p.action));let l={};c.forEach(h=>{l[h.ability]||(l[h.ability]=[]),l[h.ability].push(h.action)});let u=Object.keys(l).map(h=>(n++,`(${n}) '${h}': '${l[h].join("', '")}' for '${a}'.`));s.push(u.join(", ").replace(".,","."))});let i=s.join(" "),o=`${r}${i}`;return`${e?e+" ":""}${o}`}function Hl(e){var t;let r=yi(e);zs(r);let s=(t=r.att)==null?void 0:t.eip155;return s?Object.keys(s).map(n=>n.split("/")[1]):[]}function Vl(e){let t=yi(e);zs(t);let r=[];return Object.values(t.att).forEach(s=>{Object.values(s).forEach(n=>{var i;(i=n?.[0])!=null&&i.chains&&r.push(n[0].chains)})}),[...new Set(r.flat())]}function Si(e){if(!e)return;let t=e?.[e.length-1];return mb(t)?t:void 0}function Xd(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function bl(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function rl(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function yt(e,...t){if(!Xd(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Wf(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function bb(e,t){yt(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function us(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function In(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function vb(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}var xb=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Eb(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function vl(e){if(typeof e=="string")e=Eb(e);else if(Xd(e))e=xl(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function Sb(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function Cb(e,t){if(e.length!==t.length)return!1;let r=0;for(let s=0;s<e.length;s++)r|=e[s]^t[s];return r===0}var Ib=(e,t)=>{function r(s,...n){if(yt(s),!xb)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){let l=n[0];if(!l)throw new Error("nonce / iv required");e.varSizeNonce?yt(l):yt(l,e.nonceLength)}let i=e.tagLength;i&&n[1]!==void 0&&yt(n[1]);let o=t(s,...n),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");yt(u)}},c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,yt(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(yt(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(r,e),r};function Zf(e,t,r=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!Tb(t))throw new Error("invalid output, must be aligned");return t}function Yf(e,t,r,s){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,s);let n=BigInt(32),i=BigInt(4294967295),o=Number(r>>n&i),a=Number(r&i),c=s?4:0,l=s?0:4;e.setUint32(t+c,o,s),e.setUint32(t+l,a,s)}function _b(e,t,r){bl(r);let s=new Uint8Array(16),n=vb(s);return Yf(n,0,BigInt(t),r),Yf(n,8,BigInt(e),r),s}function Tb(e){return e.byteOffset%4===0}function xl(e){return Uint8Array.from(e)}var Jd=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),Ab=Jd("expand 16-byte k"),Pb=Jd("expand 32-byte k"),Ob=us(Ab),kb=us(Pb);function ue(e,t){return e<<t|e>>>32-t}function El(e){return e.byteOffset%4===0}var zo=64,Nb=16,Qd=2**32-1,Xf=new Uint32Array;function Rb(e,t,r,s,n,i,o,a){let c=n.length,l=new Uint8Array(zo),u=us(l),h=El(n)&&El(i),p=h?us(n):Xf,f=h?us(i):Xf;for(let g=0;g<c;o++){if(e(t,r,s,u,o,a),o>=Qd)throw new Error("arx: counter overflow");let d=Math.min(zo,c-g);if(h&&d===zo){let b=g/4;if(g%4!==0)throw new Error("arx: invalid block position");for(let k=0,q;k<Nb;k++)q=b+k,f[q]=p[q]^u[k];g+=zo;continue}for(let b=0,k;b<d;b++)k=g+b,i[k]=n[k]^l[b];g+=d}}function Bb(e,t){let{allowShortKeys:r,extendNonceFn:s,counterLength:n,counterRight:i,rounds:o}=Sb({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return rl(n),rl(o),bl(i),bl(r),(a,c,l,u,h=0)=>{yt(a),yt(c),yt(l);let p=l.length;if(u===void 0&&(u=new Uint8Array(p)),yt(u),rl(h),h<0||h>=Qd)throw new Error("arx: counter overflow");if(u.length<p)throw new Error(`arx: output (${u.length}) is shorter than data (${p})`);let f=[],g=a.length,d,b;if(g===32)f.push(d=xl(a)),b=kb;else if(g===16&&r)d=new Uint8Array(32),d.set(a),d.set(a,16),b=Ob,f.push(d);else throw new Error(`arx: invalid 32-byte key, got length=${g}`);El(c)||f.push(c=xl(c));let k=us(d);if(s){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");s(b,k,us(c.subarray(0,16)),k),c=c.subarray(16)}let q=16-n;if(q!==c.length)throw new Error(`arx: nonce must be ${q} or 16 bytes`);if(q!==12){let I=new Uint8Array(12);I.set(c,i?0:12-c.length),c=I,f.push(c)}let T=us(c);return Rb(e,b,k,T,l,u,h,o),In(...f),u}}var De=(e,t)=>e[t++]&255|(e[t++]&255)<<8,Sl=class{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=vl(t),yt(t,32);let r=De(t,0),s=De(t,2),n=De(t,4),i=De(t,6),o=De(t,8),a=De(t,10),c=De(t,12),l=De(t,14);this.r[0]=r&8191,this.r[1]=(r>>>13|s<<3)&8191,this.r[2]=(s>>>10|n<<6)&7939,this.r[3]=(n>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=De(t,16+2*u)}process(t,r,s=!1){let n=s?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],h=o[4],p=o[5],f=o[6],g=o[7],d=o[8],b=o[9],k=De(t,r+0),q=De(t,r+2),T=De(t,r+4),I=De(t,r+6),L=De(t,r+8),R=De(t,r+10),j=De(t,r+12),H=De(t,r+14),N=i[0]+(k&8191),M=i[1]+((k>>>13|q<<3)&8191),V=i[2]+((q>>>10|T<<6)&8191),B=i[3]+((T>>>7|I<<9)&8191),E=i[4]+((I>>>4|L<<12)&8191),_=i[5]+(L>>>1&8191),v=i[6]+((L>>>14|R<<2)&8191),x=i[7]+((R>>>11|j<<5)&8191),A=i[8]+((j>>>8|H<<8)&8191),U=i[9]+(H>>>5|n),C=0,O=C+N*a+M*(5*b)+V*(5*d)+B*(5*g)+E*(5*f);C=O>>>13,O&=8191,O+=_*(5*p)+v*(5*h)+x*(5*u)+A*(5*l)+U*(5*c),C+=O>>>13,O&=8191;let z=C+N*c+M*a+V*(5*b)+B*(5*d)+E*(5*g);C=z>>>13,z&=8191,z+=_*(5*f)+v*(5*p)+x*(5*h)+A*(5*u)+U*(5*l),C+=z>>>13,z&=8191;let K=C+N*l+M*c+V*a+B*(5*b)+E*(5*d);C=K>>>13,K&=8191,K+=_*(5*g)+v*(5*f)+x*(5*p)+A*(5*h)+U*(5*u),C+=K>>>13,K&=8191;let se=C+N*u+M*l+V*c+B*a+E*(5*b);C=se>>>13,se&=8191,se+=_*(5*d)+v*(5*g)+x*(5*f)+A*(5*p)+U*(5*h),C+=se>>>13,se&=8191;let X=C+N*h+M*u+V*l+B*c+E*a;C=X>>>13,X&=8191,X+=_*(5*b)+v*(5*d)+x*(5*g)+A*(5*f)+U*(5*p),C+=X>>>13,X&=8191;let Z=C+N*p+M*h+V*u+B*l+E*c;C=Z>>>13,Z&=8191,Z+=_*a+v*(5*b)+x*(5*d)+A*(5*g)+U*(5*f),C+=Z>>>13,Z&=8191;let ie=C+N*f+M*p+V*h+B*u+E*l;C=ie>>>13,ie&=8191,ie+=_*c+v*a+x*(5*b)+A*(5*d)+U*(5*g),C+=ie>>>13,ie&=8191;let re=C+N*g+M*f+V*p+B*h+E*u;C=re>>>13,re&=8191,re+=_*l+v*c+x*a+A*(5*b)+U*(5*d),C+=re>>>13,re&=8191;let ge=C+N*d+M*g+V*f+B*p+E*h;C=ge>>>13,ge&=8191,ge+=_*u+v*l+x*c+A*a+U*(5*b),C+=ge>>>13,ge&=8191;let ne=C+N*b+M*d+V*g+B*f+E*p;C=ne>>>13,ne&=8191,ne+=_*h+v*u+x*l+A*c+U*a,C+=ne>>>13,ne&=8191,C=(C<<2)+C|0,C=C+O|0,O=C&8191,C=C>>>13,z+=C,i[0]=O,i[1]=z,i[2]=K,i[3]=se,i[4]=X,i[5]=Z,i[6]=ie,i[7]=re,i[8]=ge,i[9]=ne}finalize(){let{h:t,pad:r}=this,s=new Uint16Array(10),n=t[1]>>>13;t[1]&=8191;for(let a=2;a<10;a++)t[a]+=n,n=t[a]>>>13,t[a]&=8191;t[0]+=n*5,n=t[0]>>>13,t[0]&=8191,t[1]+=n,n=t[1]>>>13,t[1]&=8191,t[2]+=n,s[0]=t[0]+5,n=s[0]>>>13,s[0]&=8191;for(let a=1;a<10;a++)s[a]=t[a]+n,n=s[a]>>>13,s[a]&=8191;s[9]-=8192;let i=(n^1)-1;for(let a=0;a<10;a++)s[a]&=i;i=~i;for(let a=0;a<10;a++)t[a]=t[a]&i|s[a];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let o=t[0]+r[0];t[0]=o&65535;for(let a=1;a<8;a++)o=(t[a]+r[a]|0)+(o>>>16)|0,t[a]=o&65535;In(s)}update(t){Wf(this),t=vl(t),yt(t);let{buffer:r,blockLen:s}=this,n=t.length;for(let i=0;i<n;){let o=Math.min(s-this.pos,n-i);if(o===s){for(;s<=n-i;i+=s)this.process(t,i);continue}r.set(t.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===s&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){In(this.h,this.r,this.buffer,this.pad)}digestInto(t){Wf(this),bb(t,this),this.finished=!0;let{buffer:r,h:s}=this,{pos:n}=this;if(n){for(r[n++]=1;n<16;n++)r[n]=0;this.process(r,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)t[i++]=s[o]>>>0,t[i++]=s[o]>>>8;return t}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let s=t.slice(0,r);return this.destroy(),s}};function Lb(e){let t=(s,n)=>e(n).update(vl(s)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=s=>e(s),t}var Ub=Lb(e=>new Sl(e));function $b(e,t,r,s,n,i=20){let o=e[0],a=e[1],c=e[2],l=e[3],u=t[0],h=t[1],p=t[2],f=t[3],g=t[4],d=t[5],b=t[6],k=t[7],q=n,T=r[0],I=r[1],L=r[2],R=o,j=a,H=c,N=l,M=u,V=h,B=p,E=f,_=g,v=d,x=b,A=k,U=q,C=T,O=I,z=L;for(let se=0;se<i;se+=2)R=R+M|0,U=ue(U^R,16),_=_+U|0,M=ue(M^_,12),R=R+M|0,U=ue(U^R,8),_=_+U|0,M=ue(M^_,7),j=j+V|0,C=ue(C^j,16),v=v+C|0,V=ue(V^v,12),j=j+V|0,C=ue(C^j,8),v=v+C|0,V=ue(V^v,7),H=H+B|0,O=ue(O^H,16),x=x+O|0,B=ue(B^x,12),H=H+B|0,O=ue(O^H,8),x=x+O|0,B=ue(B^x,7),N=N+E|0,z=ue(z^N,16),A=A+z|0,E=ue(E^A,12),N=N+E|0,z=ue(z^N,8),A=A+z|0,E=ue(E^A,7),R=R+V|0,z=ue(z^R,16),x=x+z|0,V=ue(V^x,12),R=R+V|0,z=ue(z^R,8),x=x+z|0,V=ue(V^x,7),j=j+B|0,U=ue(U^j,16),A=A+U|0,B=ue(B^A,12),j=j+B|0,U=ue(U^j,8),A=A+U|0,B=ue(B^A,7),H=H+E|0,C=ue(C^H,16),_=_+C|0,E=ue(E^_,12),H=H+E|0,C=ue(C^H,8),_=_+C|0,E=ue(E^_,7),N=N+M|0,O=ue(O^N,16),v=v+O|0,M=ue(M^v,12),N=N+M|0,O=ue(O^N,8),v=v+O|0,M=ue(M^v,7);let K=0;s[K++]=o+R|0,s[K++]=a+j|0,s[K++]=c+H|0,s[K++]=l+N|0,s[K++]=u+M|0,s[K++]=h+V|0,s[K++]=p+B|0,s[K++]=f+E|0,s[K++]=g+_|0,s[K++]=d+v|0,s[K++]=b+x|0,s[K++]=k+A|0,s[K++]=q+U|0,s[K++]=T+C|0,s[K++]=I+O|0,s[K++]=L+z|0}var jb=Bb($b,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Db=new Uint8Array(16),Jf=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(Db.subarray(r))},qb=new Uint8Array(32);function Qf(e,t,r,s,n){let i=e(t,r,qb),o=Ub.create(i);n&&Jf(o,n),Jf(o,s);let a=_b(s.length,n?n.length:0,!0);o.update(a);let c=o.digest();return In(i,a),c}var Fb=e=>(t,r,s)=>({encrypt(n,i){let o=n.length;i=Zf(o+16,i,!1),i.set(n);let a=i.subarray(0,-16);e(t,r,a,a,1);let c=Qf(e,t,r,a,s);return i.set(c,o),In(c),i},decrypt(n,i){i=Zf(n.length-16,i,!1);let o=n.subarray(0,-16),a=n.subarray(-16),c=Qf(e,t,r,o,s);if(!Cb(a,c))throw new Error("invalid tag");return i.set(n.subarray(0,-16)),e(t,r,i,i,1),In(c),i}}),eg=Ib({blockSize:64,nonceLength:12,tagLength:16},Fb(jb)),Yo=class extends Cn{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,ia(t);let s=er(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let n=this.blockLen,i=new Uint8Array(n);i.set(s.length>n?t.create().update(s).digest():s);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=t.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Mt(i)}update(t){return hs(this),this.iHash.update(t),this}digestInto(t){hs(this),rr(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:s,finished:n,destroyed:i,blockLen:o,outputLen:a}=this;return t=t,t.finished=n,t.destroyed=i,t.blockLen=o,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=s._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},la=(e,t,r)=>new Yo(e,t).update(r).digest();la.create=(e,t)=>new Yo(e,t);function Mb(e,t,r){return ia(e),r===void 0&&(r=new Uint8Array(e.outputLen)),la(e,er(r),er(t))}var sl=Uint8Array.from([0]),ed=Uint8Array.of();function zb(e,t,r,s=32){ia(e),Dr(s);let n=e.outputLen;if(s>255*n)throw new Error("Length should be <= 255*HashLen");let i=Math.ceil(s/n);r===void 0&&(r=ed);let o=new Uint8Array(i*n),a=la.create(e,t),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)sl[0]=u+1,c.update(u===0?ed:l).update(r).update(sl).digestInto(l),o.set(l,n*u),a._cloneInto(c);return a.destroy(),c.destroy(),Mt(l,sl),o.slice(0,s)}var Hb=(e,t,r,s,n)=>zb(e,Mb(e,t,r),s,n),ua=oa,Kl=BigInt(0),Cl=BigInt(1);function Xo(e,t=""){if(typeof e!="boolean"){let r=t&&`"${t}"`;throw new Error(r+"expected boolean, got type="+typeof e)}return e}function qs(e,t,r=""){let s=na(e),n=e?.length,i=t!==void 0;if(!s||i&&n!==t){let o=r&&`"${r}" `,a=i?` of length ${t}`:"",c=s?`length=${n}`:`type=${typeof e}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return e}function Ho(e){let t=e.toString(16);return t.length&1?"0"+t:t}function tg(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Kl:BigInt("0x"+e)}function ha(e){return tg(En(e))}function Jo(e){return rr(e),tg(En(Uint8Array.from(e).reverse()))}function Gl(e,t){return Wo(e.toString(16).padStart(t*2,"0"))}function Wl(e,t){return Gl(e,t).reverse()}function Ze(e,t,r){let s;if(typeof t=="string")try{s=Wo(t)}catch(i){throw new Error(e+" must be hex string or Uint8Array, cause: "+i)}else if(na(t))s=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let n=s.length;if(typeof r=="number"&&n!==r)throw new Error(e+" of length "+r+" expected, got "+n);return s}var nl=e=>typeof e=="bigint"&&Kl<=e;function Vb(e,t,r){return nl(e)&&nl(t)&&nl(r)&&t<=e&&e<r}function Il(e,t,r,s){if(!Vb(t,r,s))throw new Error("expected valid "+e+": "+r+" <= n < "+s+", got "+t)}function rg(e){let t;for(t=0;e>Kl;e>>=Cl,t+=1);return t}var Ci=e=>(Cl<<BigInt(e))-Cl;function Kb(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let s=p=>new Uint8Array(p),n=p=>Uint8Array.of(p),i=s(e),o=s(e),a=0,c=()=>{i.fill(1),o.fill(0),a=0},l=(...p)=>r(o,i,...p),u=(p=s(0))=>{o=l(n(0),p),i=l(),p.length!==0&&(o=l(n(1),p),i=l())},h=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let p=0,f=[];for(;p<t;){i=l();let g=i.slice();f.push(g),p+=i.length}return ls(...f)};return(p,f)=>{c(),u(p);let g;for(;!(g=f(h()));)u();return c(),g}}function pa(e,t,r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function s(n,i,o){let a=e[n];if(o&&a===void 0)return;let c=typeof a;if(c!==i||a===null)throw new Error(`param "${n}" is invalid: expected ${i}, got ${c}`)}Object.entries(t).forEach(([n,i])=>s(n,i,!1)),Object.entries(r).forEach(([n,i])=>s(n,i,!0))}function td(e){let t=new WeakMap;return(r,...s)=>{let n=t.get(r);if(n!==void 0)return n;let i=e(r,...s);return t.set(r,i),i}}var bt=BigInt(0),at=BigInt(1),Fs=BigInt(2),sg=BigInt(3),ng=BigInt(4),ig=BigInt(5),Gb=BigInt(7),og=BigInt(8),Wb=BigInt(9),ag=BigInt(16);function Pt(e,t){let r=e%t;return r>=bt?r:t+r}function Xt(e,t,r){let s=e;for(;t-- >bt;)s*=s,s%=r;return s}function rd(e,t){if(e===bt)throw new Error("invert: expected non-zero number");if(t<=bt)throw new Error("invert: expected positive modulus, got "+t);let r=Pt(e,t),s=t,n=bt,i=at;for(;r!==bt;){let o=s/r,a=s%r,c=n-i*o;s=r,r=a,n=i,i=c}if(s!==at)throw new Error("invert: does not exist");return Pt(n,t)}function Zl(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}function cg(e,t){let r=(e.ORDER+at)/ng,s=e.pow(t,r);return Zl(e,s,t),s}function Zb(e,t){let r=(e.ORDER-ig)/og,s=e.mul(t,Fs),n=e.pow(s,r),i=e.mul(t,n),o=e.mul(e.mul(i,Fs),n),a=e.mul(i,e.sub(o,e.ONE));return Zl(e,a,t),a}function Yb(e){let t=ds(e),r=lg(e),s=r(t,t.neg(t.ONE)),n=r(t,s),i=r(t,t.neg(s)),o=(e+Gb)/ag;return(a,c)=>{let l=a.pow(c,o),u=a.mul(l,s),h=a.mul(l,n),p=a.mul(l,i),f=a.eql(a.sqr(u),c),g=a.eql(a.sqr(h),c);l=a.cmov(l,u,f),u=a.cmov(p,h,g);let d=a.eql(a.sqr(u),c),b=a.cmov(l,u,d);return Zl(a,b,c),b}}function lg(e){if(e<sg)throw new Error("sqrt is not defined for small field");let t=e-at,r=0;for(;t%Fs===bt;)t/=Fs,r++;let s=Fs,n=ds(e);for(;sd(n,s)===1;)if(s++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return cg;let i=n.pow(s,t),o=(t+at)/Fs;return function(a,c){if(a.is0(c))return c;if(sd(a,c)!==1)throw new Error("Cannot find square root");let l=r,u=a.mul(a.ONE,i),h=a.pow(c,t),p=a.pow(c,o);for(;!a.eql(h,a.ONE);){if(a.is0(h))return a.ZERO;let f=1,g=a.sqr(h);for(;!a.eql(g,a.ONE);)if(f++,g=a.sqr(g),f===l)throw new Error("Cannot find square root");let d=at<<BigInt(l-f-1),b=a.pow(u,d);l=f,u=a.sqr(b),h=a.mul(h,u),p=a.mul(p,b)}return p}}function Xb(e){return e%ng===sg?cg:e%og===ig?Zb:e%ag===Wb?Yb(e):lg(e)}var Jb=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Qb(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=Jb.reduce((s,n)=>(s[n]="function",s),t);return pa(e,r),e}function ev(e,t,r){if(r<bt)throw new Error("invalid exponent, negatives unsupported");if(r===bt)return e.ONE;if(r===at)return t;let s=e.ONE,n=t;for(;r>bt;)r&at&&(s=e.mul(s,n)),n=e.sqr(n),r>>=at;return s}function ug(e,t,r=!1){let s=new Array(t.length).fill(r?e.ZERO:void 0),n=t.reduce((o,a,c)=>e.is0(a)?o:(s[c]=o,e.mul(o,a)),e.ONE),i=e.inv(n);return t.reduceRight((o,a,c)=>e.is0(a)?o:(s[c]=e.mul(o,s[c]),e.mul(o,a)),i),s}function sd(e,t){let r=(e.ORDER-at)/Fs,s=e.pow(t,r),n=e.eql(s,e.ONE),i=e.eql(s,e.ZERO),o=e.eql(s,e.neg(e.ONE));if(!n&&!i&&!o)throw new Error("invalid Legendre symbol result");return n?1:i?0:-1}function hg(e,t){t!==void 0&&Dr(t);let r=t!==void 0?t:e.toString(2).length,s=Math.ceil(r/8);return{nBitLength:r,nByteLength:s}}function ds(e,t,r=!1,s={}){if(e<=bt)throw new Error("invalid field: expected ORDER > 0, got "+e);let n,i,o=!1,a;if(typeof t=="object"&&t!=null){if(s.sqrt||r)throw new Error("cannot specify opts in two arguments");let p=t;p.BITS&&(n=p.BITS),p.sqrt&&(i=p.sqrt),typeof p.isLE=="boolean"&&(r=p.isLE),typeof p.modFromBytes=="boolean"&&(o=p.modFromBytes),a=p.allowedLengths}else typeof t=="number"&&(n=t),s.sqrt&&(i=s.sqrt);let{nBitLength:c,nByteLength:l}=hg(e,n);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u,h=Object.freeze({ORDER:e,isLE:r,BITS:c,BYTES:l,MASK:Ci(c),ZERO:bt,ONE:at,allowedLengths:a,create:p=>Pt(p,e),isValid:p=>{if(typeof p!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof p);return bt<=p&&p<e},is0:p=>p===bt,isValidNot0:p=>!h.is0(p)&&h.isValid(p),isOdd:p=>(p&at)===at,neg:p=>Pt(-p,e),eql:(p,f)=>p===f,sqr:p=>Pt(p*p,e),add:(p,f)=>Pt(p+f,e),sub:(p,f)=>Pt(p-f,e),mul:(p,f)=>Pt(p*f,e),pow:(p,f)=>ev(h,p,f),div:(p,f)=>Pt(p*rd(f,e),e),sqrN:p=>p*p,addN:(p,f)=>p+f,subN:(p,f)=>p-f,mulN:(p,f)=>p*f,inv:p=>rd(p,e),sqrt:i||(p=>(u||(u=Xb(e)),u(h,p))),toBytes:p=>r?Wl(p,l):Gl(p,l),fromBytes:(p,f=!0)=>{if(a){if(!a.includes(p.length)||p.length>l)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+p.length);let d=new Uint8Array(l);d.set(p,r?0:d.length-p.length),p=d}if(p.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+p.length);let g=r?Jo(p):ha(p);if(o&&(g=Pt(g,e)),!f&&!h.isValid(g))throw new Error("invalid field element: outside of range 0..ORDER");return g},invertBatch:p=>ug(h,p),cmov:(p,f,g)=>g?f:p});return Object.freeze(h)}function pg(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function fg(e){let t=pg(e);return t+Math.ceil(t/2)}function tv(e,t,r=!1){let s=e.length,n=pg(t),i=fg(t);if(s<16||s<i||s>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+s);let o=r?Jo(e):ha(e),a=Pt(o,t-at)+at;return r?Wl(a,n):Gl(a,n)}var _n=BigInt(0),Ms=BigInt(1);function Qo(e,t){let r=t.negate();return e?r:t}function il(e,t){let r=ug(e.Fp,t.map(s=>s.Z));return t.map((s,n)=>e.fromAffine(s.toAffine(r[n])))}function dg(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function ol(e,t){dg(e,t);let r=Math.ceil(t/e)+1,s=2**(e-1),n=2**e,i=Ci(e),o=BigInt(e);return{windows:r,windowSize:s,mask:i,maxNumber:n,shiftBy:o}}function nd(e,t,r){let{windowSize:s,mask:n,maxNumber:i,shiftBy:o}=r,a=Number(e&n),c=e>>o;a>s&&(a-=i,c+=Ms);let l=t*s,u=l+Math.abs(a)-1,h=a===0,p=a<0,f=t%2!==0;return{nextN:c,offset:u,isZero:h,isNeg:p,isNegF:f,offsetF:l}}function rv(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((r,s)=>{if(!(r instanceof t))throw new Error("invalid point at index "+s)})}function sv(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((r,s)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+s)})}var al=new WeakMap,gg=new WeakMap;function cl(e){return gg.get(e)||1}function id(e){if(e!==_n)throw new Error("invalid wNAF")}var _l=class{constructor(t,r){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=r}_unsafeLadder(t,r,s=this.ZERO){let n=t;for(;r>_n;)r&Ms&&(s=s.add(n)),n=n.double(),r>>=Ms;return s}precomputeWindow(t,r){let{windows:s,windowSize:n}=ol(r,this.bits),i=[],o=t,a=o;for(let c=0;c<s;c++){a=o,i.push(a);for(let l=1;l<n;l++)a=a.add(o),i.push(a);o=a.double()}return i}wNAF(t,r,s){if(!this.Fn.isValid(s))throw new Error("invalid scalar");let n=this.ZERO,i=this.BASE,o=ol(t,this.bits);for(let a=0;a<o.windows;a++){let{nextN:c,offset:l,isZero:u,isNeg:h,isNegF:p,offsetF:f}=nd(s,a,o);s=c,u?i=i.add(Qo(p,r[f])):n=n.add(Qo(h,r[l]))}return id(s),{p:n,f:i}}wNAFUnsafe(t,r,s,n=this.ZERO){let i=ol(t,this.bits);for(let o=0;o<i.windows&&s!==_n;o++){let{nextN:a,offset:c,isZero:l,isNeg:u}=nd(s,o,i);if(s=a,!l){let h=r[c];n=n.add(u?h.negate():h)}}return id(s),n}getPrecomputes(t,r,s){let n=al.get(r);return n||(n=this.precomputeWindow(r,t),t!==1&&(typeof s=="function"&&(n=s(n)),al.set(r,n))),n}cached(t,r,s){let n=cl(t);return this.wNAF(n,this.getPrecomputes(n,t,s),r)}unsafe(t,r,s,n){let i=cl(t);return i===1?this._unsafeLadder(t,r,n):this.wNAFUnsafe(i,this.getPrecomputes(i,t,s),r,n)}createCache(t,r){dg(r,this.bits),gg.set(t,r),al.delete(t)}hasCache(t){return cl(t)!==1}};function nv(e,t,r,s){let n=t,i=e.ZERO,o=e.ZERO;for(;r>_n||s>_n;)r&Ms&&(i=i.add(n)),s&Ms&&(o=o.add(n)),n=n.double(),r>>=Ms,s>>=Ms;return{p1:i,p2:o}}function iv(e,t,r,s){rv(r,e),sv(s,t);let n=r.length,i=s.length;if(n!==i)throw new Error("arrays of points and scalars must have equal length");let o=e.ZERO,a=rg(BigInt(n)),c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);let l=Ci(c),u=new Array(Number(l)+1).fill(o),h=Math.floor((t.BITS-1)/c)*c,p=o;for(let f=h;f>=0;f-=c){u.fill(o);for(let d=0;d<i;d++){let b=s[d],k=Number(b>>BigInt(f)&l);u[k]=u[k].add(r[d])}let g=o;for(let d=u.length-1,b=o;d>0;d--)b=b.add(u[d]),g=g.add(b);if(p=p.add(g),f!==0)for(let d=0;d<c;d++)p=p.double()}return p}function od(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Qb(t),t}else return ds(e,{isLE:r})}function ov(e,t,r={},s){if(s===void 0&&(s=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(let a of["p","n","h"]){let c=t[a];if(!(typeof c=="bigint"&&c>_n))throw new Error(`CURVE.${a} must be positive bigint`)}let n=od(t.p,r.Fp,s),i=od(t.n,r.Fn,s),o=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(let a of o)if(!n.isValid(t[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:n,Fn:i}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),Ud("HashToScalar-");var hi=BigInt(0),vn=BigInt(1),Vo=BigInt(2);function av(e){return pa(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}function cv(e){let t=av(e),{P:r,type:s,adjustScalarBytes:n,powPminus2:i,randomBytes:o}=t,a=s==="x25519";if(!a&&s!=="x448")throw new Error("invalid type");let c=o||Vs,l=a?255:448,u=a?32:56,h=BigInt(a?9:5),p=BigInt(a?121665:39081),f=a?Vo**BigInt(254):Vo**BigInt(447),g=a?BigInt(8)*Vo**BigInt(251)-vn:BigInt(4)*Vo**BigInt(445)-vn,d=f+g+vn,b=B=>Pt(B,r),k=q(h);function q(B){return Wl(b(B),u)}function T(B){let E=Ze("u coordinate",B,u);return a&&(E[31]&=127),b(Jo(E))}function I(B){return Jo(n(Ze("scalar",B,u)))}function L(B,E){let _=H(T(E),I(B));if(_===hi)throw new Error("invalid private or public key received");return q(_)}function R(B){return L(B,k)}function j(B,E,_){let v=b(B*(E-_));return E=b(E-v),_=b(_+v),{x_2:E,x_3:_}}function H(B,E){Il("u",B,hi,r),Il("scalar",E,f,d);let _=E,v=B,x=vn,A=hi,U=B,C=vn,O=hi;for(let K=BigInt(l-1);K>=hi;K--){let se=_>>K&vn;O^=se,{x_2:x,x_3:U}=j(O,x,U),{x_2:A,x_3:C}=j(O,A,C),O=se;let X=x+A,Z=b(X*X),ie=x-A,re=b(ie*ie),ge=Z-re,ne=U+C,me=U-C,rt=b(me*X),ct=b(ne*ie),st=rt+ct,Ut=rt-ct;U=b(st*st),C=b(v*b(Ut*Ut)),x=b(Z*re),A=b(ge*(Z+b(p*ge)))}({x_2:x,x_3:U}=j(O,x,U)),{x_2:A,x_3:C}=j(O,A,C);let z=i(A);return b(x*z)}let N={secretKey:u,publicKey:u,seed:u},M=(B=c(u))=>(rr(B,N.seed),B);function V(B){let E=M(B);return{secretKey:E,publicKey:R(E)}}return{keygen:V,getSharedSecret:(B,E)=>L(B,E),getPublicKey:B=>R(B),scalarMult:L,scalarMultBase:R,utils:{randomSecretKey:M,randomPrivateKey:M},GuBytes:k.slice(),lengths:N}}var lv=BigInt(1),ad=BigInt(2),uv=BigInt(3),hv=BigInt(5),pv=BigInt(8),mg=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),fv={p:mg,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:pv,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function dv(e){let t=BigInt(10),r=BigInt(20),s=BigInt(40),n=BigInt(80),i=mg,o=e*e%i*e%i,a=Xt(o,ad,i)*o%i,c=Xt(a,lv,i)*e%i,l=Xt(c,hv,i)*c%i,u=Xt(l,t,i)*l%i,h=Xt(u,r,i)*u%i,p=Xt(h,s,i)*h%i,f=Xt(p,n,i)*p%i,g=Xt(f,n,i)*p%i,d=Xt(g,t,i)*l%i;return{pow_p_5_8:Xt(d,ad,i)*e%i,b2:o}}function gv(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}var mv=ds(fv.p,{isLE:!0}),Tl=(()=>{let e=mv.ORDER;return cv({P:e,type:"x25519",powPminus2:t=>{let{pow_p_5_8:r,b2:s}=dv(t);return Pt(Xt(r,uv,e)*s,e)},adjustScalarBytes:gv})})(),cd=(e,t)=>(e+(e>=0?t:-t)/yg)/t;function yv(e,t,r){let[[s,n],[i,o]]=t,a=cd(o*e,r),c=cd(-n*e,r),l=e-a*s-c*i,u=-a*n-c*o,h=l<$r,p=u<$r;h&&(l=-l),p&&(u=-u);let f=Ci(Math.ceil(rg(r)/2))+Sn;if(l<$r||l>=f||u<$r||u>=f)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:h,k1:l,k2neg:p,k2:u}}function Al(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function ll(e,t){let r={};for(let s of Object.keys(t))r[s]=e[s]===void 0?t[s]:e[s];return Xo(r.lowS,"lowS"),Xo(r.prehash,"prehash"),r.format!==void 0&&Al(r.format),r}var Pl=class extends Error{constructor(t=""){super(t)}},Ur={Err:Pl,_tlv:{encode:(e,t)=>{let{Err:r}=Ur;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");let s=t.length/2,n=Ho(s);if(n.length/2&128)throw new r("tlv.encode: long form length too big");let i=s>127?Ho(n.length/2|128):"";return Ho(e)+i+n+t},decode(e,t){let{Err:r}=Ur,s=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[s++]!==e)throw new r("tlv.decode: wrong tlv");let n=t[s++],i=!!(n&128),o=0;if(!i)o=n;else{let c=n&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");let l=t.subarray(s,s+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let u of l)o=o<<8|u;if(s+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}let a=t.subarray(s,s+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(s+o)}}},_int:{encode(e){let{Err:t}=Ur;if(e<$r)throw new t("integer: negative integers are not allowed");let r=Ho(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=Ur;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return ha(e)}},toSig(e){let{Err:t,_int:r,_tlv:s}=Ur,n=Ze("signature",e),{v:i,l:o}=s.decode(48,n);if(o.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:c}=s.decode(2,i),{v:l,l:u}=s.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(e){let{_tlv:t,_int:r}=Ur,s=t.encode(2,r.encode(e.r)),n=t.encode(2,r.encode(e.s)),i=s+n;return t.encode(48,i)}},$r=BigInt(0),Sn=BigInt(1),yg=BigInt(2),Ko=BigInt(3),wv=BigInt(4);function xn(e,t){let{BYTES:r}=e,s;if(typeof t=="bigint")s=t;else{let n=Ze("private key",t);try{s=e.fromBytes(n)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof t}`)}}if(!e.isValidNot0(s))throw new Error("invalid private key: out of range [1..N-1]");return s}function bv(e,t={}){let r=ov("weierstrass",e,t),{Fp:s,Fn:n}=r,i=r.CURVE,{h:o,n:a}=i;pa(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:c}=t;if(c&&(!s.is0(i.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');let l=bg(s,n);function u(){if(!s.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function h(B,E,_){let{x:v,y:x}=E.toAffine(),A=s.toBytes(v);if(Xo(_,"isCompressed"),_){u();let U=!s.isOdd(x);return ls(wg(U),A)}else return ls(Uint8Array.of(4),A,s.toBytes(x))}function p(B){qs(B,void 0,"Point");let{publicKey:E,publicKeyUncompressed:_}=l,v=B.length,x=B[0],A=B.subarray(1);if(v===E&&(x===2||x===3)){let U=s.fromBytes(A);if(!s.isValid(U))throw new Error("bad point: is not on curve, wrong x");let C=d(U),O;try{O=s.sqrt(C)}catch(K){let se=K instanceof Error?": "+K.message:"";throw new Error("bad point: is not on curve, sqrt error"+se)}u();let z=s.isOdd(O);return(x&1)===1!==z&&(O=s.neg(O)),{x:U,y:O}}else if(v===_&&x===4){let U=s.BYTES,C=s.fromBytes(A.subarray(0,U)),O=s.fromBytes(A.subarray(U,U*2));if(!b(C,O))throw new Error("bad point: is not on curve");return{x:C,y:O}}else throw new Error(`bad point: got length ${v}, expected compressed=${E} or uncompressed=${_}`)}let f=t.toBytes||h,g=t.fromBytes||p;function d(B){let E=s.sqr(B),_=s.mul(E,B);return s.add(s.add(_,s.mul(B,i.a)),i.b)}function b(B,E){let _=s.sqr(E),v=d(B);return s.eql(_,v)}if(!b(i.Gx,i.Gy))throw new Error("bad curve params: generator point");let k=s.mul(s.pow(i.a,Ko),wv),q=s.mul(s.sqr(i.b),BigInt(27));if(s.is0(s.add(k,q)))throw new Error("bad curve params: a or b");function T(B,E,_=!1){if(!s.isValid(E)||_&&s.is0(E))throw new Error(`bad point coordinate ${B}`);return E}function I(B){if(!(B instanceof N))throw new Error("ProjectivePoint expected")}function L(B){if(!c||!c.basises)throw new Error("no endo");return yv(B,c.basises,n.ORDER)}let R=td((B,E)=>{let{X:_,Y:v,Z:x}=B;if(s.eql(x,s.ONE))return{x:_,y:v};let A=B.is0();E==null&&(E=A?s.ONE:s.inv(x));let U=s.mul(_,E),C=s.mul(v,E),O=s.mul(x,E);if(A)return{x:s.ZERO,y:s.ZERO};if(!s.eql(O,s.ONE))throw new Error("invZ was invalid");return{x:U,y:C}}),j=td(B=>{if(B.is0()){if(t.allowInfinityPoint&&!s.is0(B.Y))return;throw new Error("bad point: ZERO")}let{x:E,y:_}=B.toAffine();if(!s.isValid(E)||!s.isValid(_))throw new Error("bad point: x or y not field elements");if(!b(E,_))throw new Error("bad point: equation left != right");if(!B.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function H(B,E,_,v,x){return _=new N(s.mul(_.X,B),_.Y,_.Z),E=Qo(v,E),_=Qo(x,_),E.add(_)}class N{constructor(E,_,v){this.X=T("x",E),this.Y=T("y",_,!0),this.Z=T("z",v),Object.freeze(this)}static CURVE(){return i}static fromAffine(E){let{x:_,y:v}=E||{};if(!E||!s.isValid(_)||!s.isValid(v))throw new Error("invalid affine point");if(E instanceof N)throw new Error("projective point not allowed");return s.is0(_)&&s.is0(v)?N.ZERO:new N(_,v,s.ONE)}static fromBytes(E){let _=N.fromAffine(g(qs(E,void 0,"point")));return _.assertValidity(),_}static fromHex(E){return N.fromBytes(Ze("pointHex",E))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(E=8,_=!0){return V.createCache(this,E),_||this.multiply(Ko),this}assertValidity(){j(this)}hasEvenY(){let{y:E}=this.toAffine();if(!s.isOdd)throw new Error("Field doesn't support isOdd");return!s.isOdd(E)}equals(E){I(E);let{X:_,Y:v,Z:x}=this,{X:A,Y:U,Z:C}=E,O=s.eql(s.mul(_,C),s.mul(A,x)),z=s.eql(s.mul(v,C),s.mul(U,x));return O&&z}negate(){return new N(this.X,s.neg(this.Y),this.Z)}double(){let{a:E,b:_}=i,v=s.mul(_,Ko),{X:x,Y:A,Z:U}=this,C=s.ZERO,O=s.ZERO,z=s.ZERO,K=s.mul(x,x),se=s.mul(A,A),X=s.mul(U,U),Z=s.mul(x,A);return Z=s.add(Z,Z),z=s.mul(x,U),z=s.add(z,z),C=s.mul(E,z),O=s.mul(v,X),O=s.add(C,O),C=s.sub(se,O),O=s.add(se,O),O=s.mul(C,O),C=s.mul(Z,C),z=s.mul(v,z),X=s.mul(E,X),Z=s.sub(K,X),Z=s.mul(E,Z),Z=s.add(Z,z),z=s.add(K,K),K=s.add(z,K),K=s.add(K,X),K=s.mul(K,Z),O=s.add(O,K),X=s.mul(A,U),X=s.add(X,X),K=s.mul(X,Z),C=s.sub(C,K),z=s.mul(X,se),z=s.add(z,z),z=s.add(z,z),new N(C,O,z)}add(E){I(E);let{X:_,Y:v,Z:x}=this,{X:A,Y:U,Z:C}=E,O=s.ZERO,z=s.ZERO,K=s.ZERO,se=i.a,X=s.mul(i.b,Ko),Z=s.mul(_,A),ie=s.mul(v,U),re=s.mul(x,C),ge=s.add(_,v),ne=s.add(A,U);ge=s.mul(ge,ne),ne=s.add(Z,ie),ge=s.sub(ge,ne),ne=s.add(_,x);let me=s.add(A,C);return ne=s.mul(ne,me),me=s.add(Z,re),ne=s.sub(ne,me),me=s.add(v,x),O=s.add(U,C),me=s.mul(me,O),O=s.add(ie,re),me=s.sub(me,O),K=s.mul(se,ne),O=s.mul(X,re),K=s.add(O,K),O=s.sub(ie,K),K=s.add(ie,K),z=s.mul(O,K),ie=s.add(Z,Z),ie=s.add(ie,Z),re=s.mul(se,re),ne=s.mul(X,ne),ie=s.add(ie,re),re=s.sub(Z,re),re=s.mul(se,re),ne=s.add(ne,re),Z=s.mul(ie,ne),z=s.add(z,Z),Z=s.mul(me,ne),O=s.mul(ge,O),O=s.sub(O,Z),Z=s.mul(ge,ie),K=s.mul(me,K),K=s.add(K,Z),new N(O,z,K)}subtract(E){return this.add(E.negate())}is0(){return this.equals(N.ZERO)}multiply(E){let{endo:_}=t;if(!n.isValidNot0(E))throw new Error("invalid scalar: out of range");let v,x,A=U=>V.cached(this,U,C=>il(N,C));if(_){let{k1neg:U,k1:C,k2neg:O,k2:z}=L(E),{p:K,f:se}=A(C),{p:X,f:Z}=A(z);x=se.add(Z),v=H(_.beta,K,X,U,O)}else{let{p:U,f:C}=A(E);v=U,x=C}return il(N,[v,x])[0]}multiplyUnsafe(E){let{endo:_}=t,v=this;if(!n.isValid(E))throw new Error("invalid scalar: out of range");if(E===$r||v.is0())return N.ZERO;if(E===Sn)return v;if(V.hasCache(this))return this.multiply(E);if(_){let{k1neg:x,k1:A,k2neg:U,k2:C}=L(E),{p1:O,p2:z}=nv(N,v,A,C);return H(_.beta,O,z,x,U)}else return V.unsafe(v,E)}multiplyAndAddUnsafe(E,_,v){let x=this.multiplyUnsafe(_).add(E.multiplyUnsafe(v));return x.is0()?void 0:x}toAffine(E){return R(this,E)}isTorsionFree(){let{isTorsionFree:E}=t;return o===Sn?!0:E?E(N,this):V.unsafe(this,a).is0()}clearCofactor(){let{clearCofactor:E}=t;return o===Sn?this:E?E(N,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(E=!0){return Xo(E,"isCompressed"),this.assertValidity(),f(N,this,E)}toHex(E=!0){return En(this.toBytes(E))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(E=!0){return this.toBytes(E)}_setWindowSize(E){this.precompute(E)}static normalizeZ(E){return il(N,E)}static msm(E,_){return iv(N,n,E,_)}static fromPrivateKey(E){return N.BASE.multiply(xn(n,E))}}N.BASE=new N(i.Gx,i.Gy,s.ONE),N.ZERO=new N(s.ZERO,s.ONE,s.ZERO),N.Fp=s,N.Fn=n;let M=n.BITS,V=new _l(N,t.endo?Math.ceil(M/2):M);return N.BASE.precompute(8),N}function wg(e){return Uint8Array.of(e?2:3)}function bg(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function vv(e,t={}){let{Fn:r}=e,s=t.randomBytes||Vs,n=Object.assign(bg(e.Fp,r),{seed:fg(r.ORDER)});function i(p){try{return!!xn(r,p)}catch{return!1}}function o(p,f){let{publicKey:g,publicKeyUncompressed:d}=n;try{let b=p.length;return f===!0&&b!==g||f===!1&&b!==d?!1:!!e.fromBytes(p)}catch{return!1}}function a(p=s(n.seed)){return tv(qs(p,n.seed,"seed"),r.ORDER)}function c(p,f=!0){return e.BASE.multiply(xn(r,p)).toBytes(f)}function l(p){let f=a(p);return{secretKey:f,publicKey:c(f)}}function u(p){if(typeof p=="bigint")return!1;if(p instanceof e)return!0;let{secretKey:f,publicKey:g,publicKeyUncompressed:d}=n;if(r.allowedLengths||f===g)return;let b=Ze("key",p).length;return b===g||b===d}function h(p,f,g=!0){if(u(p)===!0)throw new Error("first arg must be private key");if(u(f)===!1)throw new Error("second arg must be public key");let d=xn(r,p);return e.fromHex(f).multiply(d).toBytes(g)}return Object.freeze({getPublicKey:c,getSharedSecret:h,keygen:l,Point:e,utils:{isValidSecretKey:i,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:i,randomPrivateKey:a,normPrivateKeyToScalar:p=>xn(r,p),precompute(p=8,f=e.BASE){return f.precompute(p,!1)}},lengths:n})}function xv(e,t,r={}){ia(t),pa(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let s=r.randomBytes||Vs,n=r.hmac||((_,...v)=>la(t,_,ls(...v))),{Fp:i,Fn:o}=e,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:u,getSharedSecret:h,utils:p,lengths:f}=vv(e,r),g={prehash:!1,lowS:typeof r.lowS=="boolean"?r.lowS:!1,format:void 0,extraEntropy:!1},d="compact";function b(_){let v=a>>Sn;return _>v}function k(_,v){if(!o.isValidNot0(v))throw new Error(`invalid signature ${_}: out of range 1..Point.Fn.ORDER`);return v}function q(_,v){Al(v);let x=f.signature,A=v==="compact"?x:v==="recovered"?x+1:void 0;return qs(_,A,`${v} signature`)}class T{constructor(v,x,A){this.r=k("r",v),this.s=k("s",x),A!=null&&(this.recovery=A),Object.freeze(this)}static fromBytes(v,x=d){q(v,x);let A;if(x==="der"){let{r:z,s:K}=Ur.toSig(qs(v));return new T(z,K)}x==="recovered"&&(A=v[0],x="compact",v=v.subarray(1));let U=o.BYTES,C=v.subarray(0,U),O=v.subarray(U,U*2);return new T(o.fromBytes(C),o.fromBytes(O),A)}static fromHex(v,x){return this.fromBytes(Wo(v),x)}addRecoveryBit(v){return new T(this.r,this.s,v)}recoverPublicKey(v){let x=i.ORDER,{r:A,s:U,recovery:C}=this;if(C==null||![0,1,2,3].includes(C))throw new Error("recovery id invalid");if(a*yg<x&&C>1)throw new Error("recovery id is ambiguous for h>1 curve");let O=C===2||C===3?A+a:A;if(!i.isValid(O))throw new Error("recovery id 2 or 3 invalid");let z=i.toBytes(O),K=e.fromBytes(ls(wg((C&1)===0),z)),se=o.inv(O),X=L(Ze("msgHash",v)),Z=o.create(-X*se),ie=o.create(U*se),re=e.BASE.multiplyUnsafe(Z).add(K.multiplyUnsafe(ie));if(re.is0())throw new Error("point at infinify");return re.assertValidity(),re}hasHighS(){return b(this.s)}toBytes(v=d){if(Al(v),v==="der")return Wo(Ur.hexFromSig(this));let x=o.toBytes(this.r),A=o.toBytes(this.s);if(v==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return ls(Uint8Array.of(this.recovery),x,A)}return ls(x,A)}toHex(v){return En(this.toBytes(v))}assertValidity(){}static fromCompact(v){return T.fromBytes(Ze("sig",v),"compact")}static fromDER(v){return T.fromBytes(Ze("sig",v),"der")}normalizeS(){return this.hasHighS()?new T(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return En(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return En(this.toBytes("compact"))}}let I=r.bits2int||function(_){if(_.length>8192)throw new Error("input is too large");let v=ha(_),x=_.length*8-c;return x>0?v>>BigInt(x):v},L=r.bits2int_modN||function(_){return o.create(I(_))},R=Ci(c);function j(_){return Il("num < 2^"+c,_,$r,R),o.toBytes(_)}function H(_,v){return qs(_,void 0,"message"),v?qs(t(_),void 0,"prehashed message"):_}function N(_,v,x){if(["recovered","canonical"].some(ie=>ie in x))throw new Error("sign() legacy options not supported");let{lowS:A,prehash:U,extraEntropy:C}=ll(x,g);_=H(_,U);let O=L(_),z=xn(o,v),K=[j(z),j(O)];if(C!=null&&C!==!1){let ie=C===!0?s(f.secretKey):C;K.push(Ze("extraEntropy",ie))}let se=ls(...K),X=O;function Z(ie){let re=I(ie);if(!o.isValidNot0(re))return;let ge=o.inv(re),ne=e.BASE.multiply(re).toAffine(),me=o.create(ne.x);if(me===$r)return;let rt=o.create(ge*o.create(X+me*z));if(rt===$r)return;let ct=(ne.x===me?0:2)|Number(ne.y&Sn),st=rt;return A&&b(rt)&&(st=o.neg(rt),ct^=1),new T(me,st,ct)}return{seed:se,k2sig:Z}}function M(_,v,x={}){_=Ze("message",_);let{seed:A,k2sig:U}=N(_,v,x);return Kb(t.outputLen,o.BYTES,n)(A,U)}function V(_){let v,x=typeof _=="string"||na(_),A=!x&&_!==null&&typeof _=="object"&&typeof _.r=="bigint"&&typeof _.s=="bigint";if(!x&&!A)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(A)v=new T(_.r,_.s);else if(x){try{v=T.fromBytes(Ze("sig",_),"der")}catch(U){if(!(U instanceof Ur.Err))throw U}if(!v)try{v=T.fromBytes(Ze("sig",_),"compact")}catch{return!1}}return v||!1}function B(_,v,x,A={}){let{lowS:U,prehash:C,format:O}=ll(A,g);if(x=Ze("publicKey",x),v=H(Ze("message",v),C),"strict"in A)throw new Error("options.strict was renamed to lowS");let z=O===void 0?V(_):T.fromBytes(Ze("sig",_),O);if(z===!1)return!1;try{let K=e.fromBytes(x);if(U&&z.hasHighS())return!1;let{r:se,s:X}=z,Z=L(v),ie=o.inv(X),re=o.create(Z*ie),ge=o.create(se*ie),ne=e.BASE.multiplyUnsafe(re).add(K.multiplyUnsafe(ge));return ne.is0()?!1:o.create(ne.x)===se}catch{return!1}}function E(_,v,x={}){let{prehash:A}=ll(x,g);return v=H(v,A),T.fromBytes(_,"recovered").recoverPublicKey(v).toBytes()}return Object.freeze({keygen:l,getPublicKey:u,getSharedSecret:h,utils:p,lengths:f,Point:e,sign:M,verify:B,recoverPublicKey:E,Signature:T,hash:t})}function Ev(e){let t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,s=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0,n=ds(t.n,{BITS:e.nBitLength,allowedLengths:s,modFromBytes:e.wrapPrivateKey}),i={Fp:r,Fn:n,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:i}}function Sv(e){let{CURVE:t,curveOpts:r}=Ev(e),s={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:r,hash:e.hash,ecdsaOpts:s}}function Cv(e,t){let r=t.Point;return Object.assign({},t,{ProjectivePoint:r,CURVE:Object.assign({},e,hg(r.Fn.ORDER,r.Fn.BITS))})}function Iv(e){let{CURVE:t,curveOpts:r,hash:s,ecdsaOpts:n}=Sv(e),i=bv(t,r),o=xv(i,s,n);return Cv(e,o)}function Ol(e,t){let r=s=>Iv({...e,hash:s});return{...r(t),create:r}}var vg={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},xg={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Eg={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},_v=ds(vg.p),Tv=ds(xg.p),Av=ds(Eg.p),Pv=Ol({...vg,Fp:_v,lowS:!1},oa);Ol({...xg,Fp:Tv,lowS:!1},H2),Ol({...Eg,Fp:Av,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},z2);var Ov=Pv,Sg="base10",Ye="base16",Xe="base64pad",Mr="base64url",Ii="utf8",Cg=0,ir=1,Tn=2,kv=0,ld=1,di=12,Yl=32;function Ig(){let e=Tl.utils.randomPrivateKey(),t=Tl.getPublicKey(e);return{privateKey:ot(e,Ye),publicKey:ot(t,Ye)}}function fa(){let e=Vs(Yl);return ot(e,Ye)}function _g(e,t){let r=Tl.getSharedSecret(mt(e,Ye),mt(t,Ye)),s=Hb(ua,r,void 0,void 0,Yl);return ot(s,Ye)}function An(e){let t=ua(mt(e,Ye));return ot(t,Ye)}function vt(e){let t=ua(mt(e,Ii));return ot(t,Ye)}function Tg(e){return mt(`${e}`,Sg)}function ps(e){return Number(ot(e,Sg))}function Ag(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Pg(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4;return t+"=".repeat(r)}function Og(e){let t=Tg(typeof e.type<"u"?e.type:Cg);if(ps(t)===ir&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");let r=typeof e.senderPublicKey<"u"?mt(e.senderPublicKey,Ye):void 0,s=typeof e.iv<"u"?mt(e.iv,Ye):Vs(di),n=mt(e.symKey,Ye),i=eg(n,s).encrypt(mt(e.message,Ii)),o=Bg({type:t,sealed:i,iv:s,senderPublicKey:r});return e.encoding===Mr?Ag(o):o}function kg(e){let t=mt(e.symKey,Ye),{sealed:r,iv:s}=Pn({encoded:e.encoded,encoding:e.encoding}),n=eg(t,s).decrypt(r);if(n===null)throw new Error("Failed to decrypt");return ot(n,Ii)}function Ng(e,t){let r=Tg(Tn),s=Vs(di),n=mt(e,Ii),i=Bg({type:r,sealed:n,iv:s});return t===Mr?Ag(i):i}function Rg(e,t){let{sealed:r}=Pn({encoded:e,encoding:t});return ot(r,Ii)}function Bg(e){if(ps(e.type)===Tn)return ot($s([e.type,e.sealed]),Xe);if(ps(e.type)===ir){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ot($s([e.type,e.senderPublicKey,e.iv,e.sealed]),Xe)}return ot($s([e.type,e.iv,e.sealed]),Xe)}function Pn(e){let t=(e.encoding||Xe)===Mr?Pg(e.encoded):e.encoded,r=mt(t,Xe),s=r.slice(kv,ld),n=ld;if(ps(s)===ir){let c=n+Yl,l=c+di,u=r.slice(n,c),h=r.slice(c,l),p=r.slice(l);return{type:s,sealed:p,iv:h,senderPublicKey:u}}if(ps(s)===Tn){let c=r.slice(n),l=Vs(di);return{type:s,sealed:c,iv:l}}let i=n+di,o=r.slice(n,i),a=r.slice(i);return{type:s,sealed:a,iv:o}}function Lg(e,t){let r=Pn({encoded:e,encoding:t?.encoding});return Xl({type:ps(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ot(r.senderPublicKey,Ye):void 0,receiverPublicKey:t?.receiverPublicKey})}function Xl(e){let t=e?.type||Cg;if(t===ir){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function Jl(e){return e.type===ir&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}function Ql(e){return e.type===Tn}function Nv(e){let t=P.from(e.x,"base64"),r=P.from(e.y,"base64");return $s([new Uint8Array([4]),t,r])}function Ug(e,t){let[r,s,n]=e.split("."),i=P.from(Pg(n),"base64");if(i.length!==64)throw new Error("Invalid signature length");let o=i.slice(0,32),a=i.slice(32,64),c=`${r}.${s}`,l=ua(c),u=Nv(t);if(!Ov.verify($s([o,a]),l,u))throw new Error("Invalid signature");return Wn(e).payload}var Rv="irn";function _i(e){return e?.relay||{protocol:Rv}}function Ks(e){let t=op[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var Bv=Object.defineProperty,Lv=Object.defineProperties,Uv=Object.getOwnPropertyDescriptors,ud=Object.getOwnPropertySymbols,$v=Object.prototype.hasOwnProperty,jv=Object.prototype.propertyIsEnumerable,hd=(e,t,r)=>t in e?Bv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ul=(e,t)=>{for(var r in t||(t={}))$v.call(t,r)&&hd(e,r,t[r]);if(ud)for(var r of ud(t))jv.call(t,r)&&hd(e,r,t[r]);return e},Dv=(e,t)=>Lv(e,Uv(t));function qv(e,t="-"){let r={},s="relay"+t;return Object.keys(e).forEach(n=>{if(n.startsWith(s)){let i=n.replace(s,""),o=e[n];r[i]=o}}),r}function eu(e){if(!e.includes("wc:")){let l=Pd(e);l!=null&&l.includes("wc:")&&(e=l)}e=e.includes("wc://")?e.replace("wc://",""):e,e=e.includes("wc:")?e.replace("wc:",""):e;let t=e.indexOf(":"),r=e.indexOf("?")!==-1?e.indexOf("?"):void 0,s=e.substring(0,t),n=e.substring(t+1,r).split("@"),i=typeof r<"u"?e.substring(r):"",o=new URLSearchParams(i),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:s,topic:Fv(n[0]),version:parseInt(n[1],10),symKey:a.symKey,relay:qv(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function Fv(e){return e.startsWith("//")?e.substring(2):e}function Mv(e,t="-"){let r="relay",s={};return Object.keys(e).forEach(n=>{let i=n,o=r+t+i;e[i]&&(s[o]=e[i])}),s}function tu(e){let t=new URLSearchParams,r=ul(ul(Dv(ul({},Mv(e.relay)),{symKey:e.symKey}),e.expiryTimestamp&&{expiryTimestamp:e.expiryTimestamp.toString()}),e.methods&&{methods:e.methods.join(",")});return Object.entries(r).sort(([s],[n])=>s.localeCompare(n)).forEach(([s,n])=>{n!==void 0&&t.append(s,String(n))}),`${e.protocol}:${e.topic}@${e.version}?${t}`}function Ti(e,t,r){return`${e}?wc_ev=${r}&topic=${t}`}var zv=Object.defineProperty,Hv=Object.defineProperties,Vv=Object.getOwnPropertyDescriptors,pd=Object.getOwnPropertySymbols,Kv=Object.prototype.hasOwnProperty,Gv=Object.prototype.propertyIsEnumerable,fd=(e,t,r)=>t in e?zv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Wv=(e,t)=>{for(var r in t||(t={}))Kv.call(t,r)&&fd(e,r,t[r]);if(pd)for(var r of pd(t))Gv.call(t,r)&&fd(e,r,t[r]);return e},Zv=(e,t)=>Hv(e,Vv(t));function On(e){let t=[];return e.forEach(r=>{let[s,n]=r.split(":");t.push(`${s}:${n}`)}),t}function ru(e){let t=[];return Object.values(e).forEach(r=>{t.push(...On(r.accounts))}),[...new Set(t)]}function $g(e){let t=[];return Object.values(e).forEach(r=>{t.push(...r.methods)}),[...new Set(t)]}function jg(e){let t=[];return Object.values(e).forEach(r=>{t.push(...r.events)}),[...new Set(t)]}function Yv(e,t){let r=[];return Object.values(e).forEach(s=>{On(s.accounts).includes(t)&&r.push(...s.methods)}),r}function Xv(e,t){let r=[];return Object.values(e).forEach(s=>{On(s.accounts).includes(t)&&r.push(...s.events)}),r}function Ai(e){return e.includes(":")}function Gs(e){return Ai(e)?e.split(":")[0]:e}function dd(e){var t,r,s;let n={};if(!zt(e))return n;for(let[i,o]of Object.entries(e)){let a=Ai(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=Gs(i);n[u]=Zv(Wv({},n[u]),{chains:Qt(a,(t=n[u])==null?void 0:t.chains),methods:Qt(c,(r=n[u])==null?void 0:r.methods),events:Qt(l,(s=n[u])==null?void 0:s.events)})}return n}function Jv(e){let t={};return e?.forEach(r=>{var s;let[n,i]=r.split(":");t[n]||(t[n]={accounts:[],chains:[],events:[],methods:[]}),t[n].accounts.push(r),(s=t[n].chains)==null||s.push(`${n}:${i}`)}),t}function su(e,t){t=t.map(s=>s.replace("did:pkh:",""));let r=Jv(t);for(let[s,n]of Object.entries(r))n.methods?n.methods=Qt(n.methods,e):n.methods=e,n.events=["chainChanged","accountsChanged"];return r}function Dg(e,t){var r,s,n,i,o,a;let c=dd(e),l=dd(t),u={},h=Object.keys(c).concat(Object.keys(l));for(let p of h)u[p]={chains:Qt((r=c[p])==null?void 0:r.chains,(s=l[p])==null?void 0:s.chains),methods:Qt((n=c[p])==null?void 0:n.methods,(i=l[p])==null?void 0:i.methods),events:Qt((o=c[p])==null?void 0:o.events,(a=l[p])==null?void 0:a.events)};return u}var Qv={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},e3={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function G(e,t){let{message:r,code:s}=e3[e];return{message:t?`${r} ${t}`:r,code:s}}function be(e,t){let{message:r,code:s}=Qv[e];return{message:t?`${r} ${t}`:r,code:s}}function or(e,t){return Array.isArray(e)?typeof t<"u"&&e.length?e.every(t):!0:!1}function zt(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function Ae(e){return typeof e>"u"}function Te(e,t){return t&&Ae(e)?!0:typeof e=="string"&&!!e.trim().length}function nu(e,t){return t&&Ae(e)?!0:typeof e=="number"&&!isNaN(e)}function qg(e,t){let{requiredNamespaces:r}=t,s=Object.keys(e.namespaces),n=Object.keys(r),i=!0;return Ds(n,s)?(s.forEach(o=>{let{accounts:a,methods:c,events:l}=e.namespaces[o],u=On(a),h=r[o];(!Ds(bd(o,h),u)||!Ds(h.methods,c)||!Ds(h.events,l))&&(i=!1)}),i):!1}function ea(e){return Te(e,!1)&&e.includes(":")?e.split(":").length===2:!1}function t3(e){if(Te(e,!1)&&e.includes(":")){let t=e.split(":");if(t.length===3){let r=t[0]+":"+t[1];return!!t[2]&&ea(r)}}return!1}function Fg(e){function t(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(Te(e,!1)){if(t(e))return!0;let r=Pd(e);return t(r)}}catch{}return!1}function Mg(e){var t;return(t=e?.proposer)==null?void 0:t.publicKey}function zg(e){return e?.topic}function Hg(e,t){let r=null;return Te(e?.publicKey,!1)||(r=G("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function gd(e){let t=!0;return or(e)?e.length&&(t=e.every(r=>Te(r,!1))):t=!1,t}function r3(e,t,r){let s=null;return or(t)&&t.length?t.forEach(n=>{s||ea(n)||(s=be("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):ea(e)||(s=be("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function s3(e,t,r){let s=null;return Object.entries(e).forEach(([n,i])=>{if(s)return;let o=r3(n,bd(n,i),`${t} ${r}`);o&&(s=o)}),s}function n3(e,t){let r=null;return or(e)?e.forEach(s=>{r||t3(s)||(r=be("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=be("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function i3(e,t){let r=null;return Object.values(e).forEach(s=>{if(r)return;let n=n3(s?.accounts,`${t} namespace`);n&&(r=n)}),r}function o3(e,t){let r=null;return gd(e?.methods)?gd(e?.events)||(r=be("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=be("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Vg(e,t){let r=null;return Object.values(e).forEach(s=>{if(r)return;let n=o3(s,`${t}, namespace`);n&&(r=n)}),r}function Kg(e,t,r){let s=null;if(e&&zt(e)){let n=Vg(e,t);n&&(s=n);let i=s3(e,t,r);i&&(s=i)}else s=G("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function da(e,t){let r=null;if(e&&zt(e)){let s=Vg(e,t);s&&(r=s);let n=i3(e,t);n&&(r=n)}else r=G("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function iu(e){return Te(e.protocol,!0)}function Gg(e,t){let r=!1;return t&&!e?r=!0:e&&or(e)&&e.length&&e.forEach(s=>{r=iu(s)}),r}function Wg(e){return typeof e=="number"}function Je(e){return typeof e<"u"&&typeof e!==null}function Zg(e){return!(!e||typeof e!="object"||!e.code||!nu(e.code,!1)||!e.message||!Te(e.message,!1))}function Yg(e){return!(Ae(e)||!Te(e.method,!1))}function Xg(e){return!(Ae(e)||Ae(e.result)&&Ae(e.error)||!nu(e.id,!1)||!Te(e.jsonrpc,!1))}function Jg(e){return!(Ae(e)||!Te(e.name,!1))}function ou(e,t){return!(!ea(t)||!ru(e).includes(t))}function Qg(e,t,r){return Te(r,!1)?Yv(e,t).includes(r):!1}function em(e,t,r){return Te(r,!1)?Xv(e,t).includes(r):!1}function au(e,t,r){let s=null,n=a3(e),i=c3(t),o=Object.keys(n),a=Object.keys(i),c=md(Object.keys(e)),l=md(Object.keys(t)),u=c.filter(h=>!l.includes(h));return u.length&&(s=G("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(t).toString()}`)),Ds(o,a)||(s=G("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(t).forEach(h=>{if(!h.includes(":")||s)return;let p=On(t[h].accounts);p.includes(h)||(s=G("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${h}
        Required: ${h}
        Approved: ${p.toString()}`))}),o.forEach(h=>{s||(Ds(n[h].methods,i[h].methods)?Ds(n[h].events,i[h].events)||(s=G("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${h}`)):s=G("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${h}`))}),s}function a3(e){let t={};return Object.keys(e).forEach(r=>{var s;r.includes(":")?t[r]=e[r]:(s=e[r].chains)==null||s.forEach(n=>{t[n]={methods:e[r].methods,events:e[r].events}})}),t}function md(e){return[...new Set(e.map(t=>t.includes(":")?t.split(":")[0]:t))]}function c3(e){let t={};return Object.keys(e).forEach(r=>{r.includes(":")?t[r]=e[r]:On(e[r].accounts)?.forEach(n=>{t[n]={accounts:e[r].accounts.filter(i=>i.includes(`${n}:`)),methods:e[r].methods,events:e[r].events}})}),t}function tm(e,t){return nu(e,!1)&&e<=t.max&&e>=t.min}function cu(){let e=bi();return new Promise(t=>{switch(e){case wt.browser:t(l3());break;case wt.reactNative:t(u3());break;case wt.node:t(h3());break;default:t(!0)}})}function l3(){return Hs()&&navigator?.onLine}async function u3(){return qr()&&typeof globalThis<"u"&&globalThis!=null&&globalThis.NetInfo?(await globalThis?.NetInfo.fetch())?.isConnected:!0}function h3(){return!0}function rm(e){switch(bi()){case wt.browser:p3(e);break;case wt.reactNative:f3(e);break;case wt.node:break}}function p3(e){!qr()&&Hs()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)))}function f3(e){qr()&&typeof globalThis<"u"&&globalThis!=null&&globalThis.NetInfo&&globalThis?.NetInfo.addEventListener(t=>e(t?.isConnected))}function sm(){var e;return Hs()&&(0,tr.getDocument)()?((e=(0,tr.getDocument)())==null?void 0:e.visibilityState)==="visible":!0}var hl={},fs=class{static get(t){return hl[t]}static set(t,r){hl[t]=r}static delete(t){delete hl[t]}};function d3(e){let t=on.decode(e);if(t.length<33)throw new Error("Too short to contain a public key");return t.slice(1,33)}function g3({publicKey:e,signature:t,payload:r}){var s;let n=kl(r.method),i=128|parseInt(((s=r.version)==null?void 0:s.toString())||"4"),o=w3(r.address),a=r.era==="00"?new Uint8Array([0]):kl(r.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");let c=parseInt(r.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${y3(r.tip)}`),h=v3(u),p=new Uint8Array([0,...e,o,...t,...a,...l,...h,...n]),f=b3(p.length+1);return new Uint8Array([...f,i,...p])}function m3(e){let t=kl(e),r=(0,wd.blake2b)(t,void 0,32);return"0x"+P.from(r).toString("hex")}function kl(e){return new Uint8Array(e.replace(/^0x/,"").match(/.{1,2}/g).map(t=>parseInt(t,16)))}function y3(e){return e.startsWith("0x")?e.slice(2):e}function w3(e){let t=on.decode(e)[0];return t===42?0:t===60?2:1}function b3(e){if(e<64)return new Uint8Array([e<<2]);if(e<16384){let t=e<<2|1;return new Uint8Array([t&255,t>>8&255])}else if(e<1<<30){let t=e<<2|2;return new Uint8Array([t&255,t>>8&255,t>>16&255,t>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function v3(e){if(e<BigInt(1)<<BigInt(6))return new Uint8Array([Number(e<<BigInt(2))]);if(e<BigInt(1)<<BigInt(14)){let t=e<<BigInt(2)|BigInt(1);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255))])}else if(e<BigInt(1)<<BigInt(30)){let t=e<<BigInt(2)|BigInt(2);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255)),Number(t>>BigInt(16)&BigInt(255)),Number(t>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function nm(e){let t=Uint8Array.from(P.from(e.signature,"hex")),r=d3(e.transaction.address),s=g3({publicKey:r,signature:t,payload:e.transaction}),n=P.from(s).toString("hex");return m3(n)}function kn({logger:e,name:t}){let r=typeof e=="string"?Uf({opts:{level:e,name:t}}).logger:e;return r.level=typeof e=="string"?e:e.level,r}m();w();y();m();w();y();m();w();y();m();w();y();m();w();y();function Pi(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function ga(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Pi(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}m();w();y();m();w();y();m();w();y();function om(e,t,r,s){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:s}}}var im=om("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),lu=om("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=ga(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),x3={utf8:im,"utf-8":im,hex:an.base16,latin1:lu,ascii:lu,binary:lu,...an},uu=x3;m();w();y();function hu(e,t="utf8"){let r=uu[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}m();w();y();var km=xs(rp(),1),Nm="wc",Rm=2,ya="core",vr=`${Nm}@2:${ya}:`,E3={name:ya,logger:"error"},S3={database:":memory:"},C3="crypto",am="client_ed25519_seed",I3=Y.ONE_DAY,_3="keychain",T3="0.3",A3="messages",P3="0.3",O3=Y.SIX_HOURS,k3="publisher",Vu="irn",N3="error",Bm="wss://relay.walletconnect.org",R3="relayer",Pe={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},B3="_subscription",Ht={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},L3=.1;var gu="2.23.1";var Ee={link_mode:"link_mode",relay:"relay"},ma={inbound:"inbound",outbound:"outbound"},U3="0.3",$3="WALLETCONNECT_CLIENT_ID",cm="WALLETCONNECT_LINK_MODE_APPS",Nt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"};var j3="subscription",D3="0.3",nP=Y.FIVE_SECONDS*1e3,q3="pairing",F3="0.3";var Oi={wc_pairingDelete:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Y.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Y.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:0},res:{ttl:Y.ONE_DAY,prompt:!1,tag:0}}},gs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ar={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},M3="history",z3="0.3",H3="expirer",Rt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},V3="0.3";var K3="verify-api",G3="https://verify.walletconnect.com",Lm="https://verify.walletconnect.org",Bn=Lm,W3=`${Bn}/v3`,Z3=[G3,Lm],Y3="echo",X3="https://echo.walletconnect.com";var cr={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},br={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Kt={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},ms={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},ys={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},Ln={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},J3=.1,Q3="event-client",e4=86400,t4="https://pulse.walletconnect.org/batch";function r4(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var n=0;n<e.length;n++){var i=e.charAt(n),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=n}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var d=0,b=0,k=0,q=g.length;k!==q&&g[k]===0;)k++,d++;for(var T=(q-k)*u+1>>>0,I=new Uint8Array(T);k!==q;){for(var L=g[k],R=0,j=T-1;(L!==0||R<b)&&j!==-1;j--,R++)L+=256*I[j]>>>0,I[j]=L%a>>>0,L=L/a>>>0;if(L!==0)throw new Error("Non-zero carry");b=R,k++}for(var H=T-b;H!==T&&I[H]===0;)H++;for(var N=c.repeat(d);H<T;++H)N+=e.charAt(I[H]);return N}function p(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var d=0;if(g[d]!==" "){for(var b=0,k=0;g[d]===c;)b++,d++;for(var q=(g.length-d)*l+1>>>0,T=new Uint8Array(q);g[d];){var I=r[g.charCodeAt(d)];if(I===255)return;for(var L=0,R=q-1;(I!==0||L<k)&&R!==-1;R--,L++)I+=a*T[R]>>>0,T[R]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");k=L,d++}if(g[d]!==" "){for(var j=q-k;j!==q&&T[j]===0;)j++;for(var H=new Uint8Array(b+(q-j)),N=b;j!==q;)H[N++]=T[j++];return H}}}function f(g){var d=p(g);if(d)return d;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:p,decode:f}}var s4=r4,n4=s4,Um=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},i4=e=>new TextEncoder().encode(e),o4=e=>new TextDecoder().decode(e),mu=class{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},yu=class{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return $m(this,t)}},wu=class{constructor(t){this.decoders=t}or(t){return $m(this,t)}decode(t){let r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},$m=(e,t)=>new wu({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),bu=class{constructor(t,r,s,n){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=n,this.encoder=new mu(t,r,s),this.decoder=new yu(t,r,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},wa=({name:e,prefix:t,encode:r,decode:s})=>new bu(e,t,r,s),Li=({prefix:e,name:t,alphabet:r})=>{let{encode:s,decode:n}=n4(r,t);return wa({prefix:e,name:t,encode:s,decode:i=>Um(n(i))})},a4=(e,t,r,s)=>{let n={};for(let u=0;u<t.length;++u)n[t[u]]=u;let i=e.length;for(;e[i-1]==="=";)--i;let o=new Uint8Array(i*r/8|0),a=0,c=0,l=0;for(let u=0;u<i;++u){let h=n[e[u]];if(h===void 0)throw new SyntaxError(`Non-${s} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},c4=(e,t,r)=>{let s=t[t.length-1]==="=",n=(1<<r)-1,i="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>r;)o-=r,i+=t[n&a>>o];if(o&&(i+=t[n&a<<r-o]),s)for(;i.length*r&7;)i+="=";return i},Fe=({name:e,prefix:t,bitsPerChar:r,alphabet:s})=>wa({prefix:t,name:e,encode(n){return c4(n,s,r)},decode(n){return a4(n,s,r,e)}}),l4=wa({prefix:"\0",name:"identity",encode:e=>o4(e),decode:e=>i4(e)}),u4=Object.freeze({__proto__:null,identity:l4}),h4=Fe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),p4=Object.freeze({__proto__:null,base2:h4}),f4=Fe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),d4=Object.freeze({__proto__:null,base8:f4}),g4=Li({prefix:"9",name:"base10",alphabet:"0123456789"}),m4=Object.freeze({__proto__:null,base10:g4}),y4=Fe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),w4=Fe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),b4=Object.freeze({__proto__:null,base16:y4,base16upper:w4}),v4=Fe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),x4=Fe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),E4=Fe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),S4=Fe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),C4=Fe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),I4=Fe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),_4=Fe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),T4=Fe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),A4=Fe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),P4=Object.freeze({__proto__:null,base32:v4,base32upper:x4,base32pad:E4,base32padupper:S4,base32hex:C4,base32hexupper:I4,base32hexpad:_4,base32hexpadupper:T4,base32z:A4}),O4=Li({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),k4=Li({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),N4=Object.freeze({__proto__:null,base36:O4,base36upper:k4}),R4=Li({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),B4=Li({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),L4=Object.freeze({__proto__:null,base58btc:R4,base58flickr:B4}),U4=Fe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),$4=Fe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),j4=Fe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),D4=Fe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),q4=Object.freeze({__proto__:null,base64:U4,base64pad:$4,base64url:j4,base64urlpad:D4}),jm=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),F4=jm.reduce((e,t,r)=>(e[r]=t,e),[]),M4=jm.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function z4(e){return e.reduce((t,r)=>(t+=F4[r],t),"")}function H4(e){let t=[];for(let r of e){let s=M4[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}var V4=wa({prefix:"\u{1F680}",name:"base256emoji",encode:z4,decode:H4}),K4=Object.freeze({__proto__:null,base256emoji:V4}),G4=Dm,lm=128,W4=127,Z4=~W4,Y4=Math.pow(2,31);function Dm(e,t,r){t=t||[],r=r||0;for(var s=r;e>=Y4;)t[r++]=e&255|lm,e/=128;for(;e&Z4;)t[r++]=e&255|lm,e>>>=7;return t[r]=e|0,Dm.bytes=r-s+1,t}var X4=vu,J4=128,um=127;function vu(e,s){var r=0,s=s||0,n=0,i=s,o,a=e.length;do{if(i>=a)throw vu.bytes=0,new RangeError("Could not decode varint");o=e[i++],r+=n<28?(o&um)<<n:(o&um)*Math.pow(2,n),n+=7}while(o>=J4);return vu.bytes=i-s,r}var Q4=Math.pow(2,7),e6=Math.pow(2,14),t6=Math.pow(2,21),r6=Math.pow(2,28),s6=Math.pow(2,35),n6=Math.pow(2,42),i6=Math.pow(2,49),o6=Math.pow(2,56),a6=Math.pow(2,63),c6=function(e){return e<Q4?1:e<e6?2:e<t6?3:e<r6?4:e<s6?5:e<n6?6:e<i6?7:e<o6?8:e<a6?9:10},l6={encode:G4,decode:X4,encodingLength:c6},qm=l6,hm=(e,t,r=0)=>(qm.encode(e,t,r),t),pm=e=>qm.encodingLength(e),xu=(e,t)=>{let r=t.byteLength,s=pm(e),n=s+pm(r),i=new Uint8Array(n+r);return hm(e,i,0),hm(r,i,s),i.set(t,n),new Eu(e,r,t,i)},Eu=class{constructor(t,r,s,n){this.code=t,this.size=r,this.digest=s,this.bytes=n}},Fm=({name:e,code:t,encode:r})=>new Su(e,t,r),Su=class{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?xu(this.code,r):r.then(s=>xu(this.code,s))}else throw Error("Unknown type, must be binary type")}},Mm=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),u6=Fm({name:"sha2-256",code:18,encode:Mm("SHA-256")}),h6=Fm({name:"sha2-512",code:19,encode:Mm("SHA-512")}),p6=Object.freeze({__proto__:null,sha256:u6,sha512:h6}),zm=0,f6="identity",Hm=Um,d6=e=>xu(zm,Hm(e)),g6={code:zm,name:f6,encode:Hm,digest:d6},m6=Object.freeze({__proto__:null,identity:g6});new TextEncoder,new TextDecoder;var fm={...u4,...p4,...d4,...m4,...b4,...P4,...N4,...L4,...q4,...K4};({...p6,...m6});function Vm(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function y6(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Vm(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Km(e,t,r,s){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:s}}}var dm=Km("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),pu=Km("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=y6(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),w6={utf8:dm,"utf-8":dm,hex:fm.base16,latin1:pu,ascii:pu,binary:pu,...fm};function b6(e,t="utf8"){let r=w6[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Vm(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}var v6=Object.defineProperty,x6=(e,t,r)=>t in e?v6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,wr=(e,t,r)=>x6(e,typeof t!="symbol"?t+"":t,r),Cu=class{constructor(t,r){this.core=t,this.logger=r,wr(this,"keychain",new Map),wr(this,"name",_3),wr(this,"version",T3),wr(this,"initialized",!1),wr(this,"storagePrefix",vr),wr(this,"init",async()=>{if(!this.initialized){let s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}}),wr(this,"has",s=>(this.isInitialized(),this.keychain.has(s))),wr(this,"set",async(s,n)=>{this.isInitialized(),this.keychain.set(s,n),await this.persist()}),wr(this,"get",s=>{this.isInitialized();let n=this.keychain.get(s);if(typeof n>"u"){let{message:i}=G("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(i)}return n}),wr(this,"del",async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()}),this.core=t,this.logger=dt(r,this.name)}get context(){return ft(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,ta(t))}async getKeyChain(){let t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?ra(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}},E6=Object.defineProperty,S6=(e,t,r)=>t in e?E6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,$e=(e,t,r)=>S6(e,typeof t!="symbol"?t+"":t,r),Iu=class{constructor(t,r,s){this.core=t,this.logger=r,$e(this,"name",C3),$e(this,"keychain"),$e(this,"randomSessionIdentifier",fa()),$e(this,"initialized",!1),$e(this,"clientId"),$e(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),$e(this,"hasKeys",n=>(this.isInitialized(),this.keychain.has(n))),$e(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;let n=await this.getClientSeed(),i=Da(n),o=Qh(i.publicKey);return this.clientId=o,o}),$e(this,"generateKeyPair",()=>{this.isInitialized();let n=Ig();return this.setPrivateKey(n.publicKey,n.privateKey)}),$e(this,"signJWT",async n=>{this.isInitialized();let i=await this.getClientSeed(),o=Da(i),a=this.randomSessionIdentifier;return await ep(a,n,I3,o)}),$e(this,"generateSharedKey",(n,i,o)=>{this.isInitialized();let a=this.getPrivateKey(n),c=_g(a,i);return this.setSymKey(c,o)}),$e(this,"setSymKey",async(n,i)=>{this.isInitialized();let o=i||An(n);return await this.keychain.set(o,n),o}),$e(this,"deleteKeyPair",async n=>{this.isInitialized(),await this.keychain.del(n)}),$e(this,"deleteSymKey",async n=>{this.isInitialized(),await this.keychain.del(n)}),$e(this,"encode",async(n,i,o)=>{this.isInitialized();let a=Xl(o),c=Xh(i);if(Ql(a))return Ng(c,o?.encoding);if(Jl(a)){let p=a.senderPublicKey,f=a.receiverPublicKey;n=await this.generateSharedKey(p,f)}let l=this.getSymKey(n),{type:u,senderPublicKey:h}=a;return Og({type:u,symKey:l,message:c,senderPublicKey:h,encoding:o?.encoding})}),$e(this,"decode",async(n,i,o)=>{this.isInitialized();let a=Lg(i,o);if(Ql(a)){let c=Rg(i,o?.encoding);return ja(c)}if(Jl(a)){let c=a.receiverPublicKey,l=a.senderPublicKey;n=await this.generateSharedKey(c,l)}try{let c=this.getSymKey(n),l=kg({symKey:c,encoded:i,encoding:o?.encoding});return ja(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${n}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),$e(this,"getPayloadType",(n,i=Xe)=>{let o=Pn({encoded:n,encoding:i});return ps(o.type)}),$e(this,"getPayloadSenderPublicKey",(n,i=Xe)=>{let o=Pn({encoded:n,encoding:i});return o.senderPublicKey?hu(o.senderPublicKey,Ye):void 0}),this.core=t,this.logger=dt(r,this.name),this.keychain=s||new Cu(this.core,this.logger)}get context(){return ft(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(am)}catch{t=fa(),await this.keychain.set(am,t)}return b6(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){let{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}},C6=Object.defineProperty,I6=Object.defineProperties,_6=Object.getOwnPropertyDescriptors,gm=Object.getOwnPropertySymbols,T6=Object.prototype.hasOwnProperty,A6=Object.prototype.propertyIsEnumerable,_u=(e,t,r)=>t in e?C6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,P6=(e,t)=>{for(var r in t||(t={}))T6.call(t,r)&&_u(e,r,t[r]);if(gm)for(var r of gm(t))A6.call(t,r)&&_u(e,r,t[r]);return e},O6=(e,t)=>I6(e,_6(t)),kt=(e,t,r)=>_u(e,typeof t!="symbol"?t+"":t,r),Tu=class extends ro{constructor(t,r){super(t,r),this.logger=t,this.core=r,kt(this,"messages",new Map),kt(this,"messagesWithoutClientAck",new Map),kt(this,"name",A3),kt(this,"version",P3),kt(this,"initialized",!1),kt(this,"storagePrefix",vr),kt(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s);let n=await this.getRelayerMessagesWithoutClientAck();typeof n<"u"&&(this.messagesWithoutClientAck=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}}),kt(this,"set",async(s,n,i)=>{this.isInitialized();let o=vt(n),a=this.messages.get(s);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=n,this.messages.set(s,a),i===ma.inbound){let c=this.messagesWithoutClientAck.get(s)||{};this.messagesWithoutClientAck.set(s,O6(P6({},c),{[o]:n}))}return await this.persist(),o}),kt(this,"get",s=>{this.isInitialized();let n=this.messages.get(s);return typeof n>"u"&&(n={}),n}),kt(this,"getWithoutAck",s=>{this.isInitialized();let n={};for(let i of s){let o=this.messagesWithoutClientAck.get(i)||{};n[i]=Object.values(o)}return n}),kt(this,"has",(s,n)=>{this.isInitialized();let i=this.get(s),o=vt(n);return typeof i[o]<"u"}),kt(this,"ack",async(s,n)=>{this.isInitialized();let i=this.messagesWithoutClientAck.get(s);if(typeof i>"u")return;let o=vt(n);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(s):this.messagesWithoutClientAck.set(s,i),await this.persist()}),kt(this,"del",async s=>{this.isInitialized(),this.messages.delete(s),this.messagesWithoutClientAck.delete(s),await this.persist()}),this.logger=dt(t,this.name),this.core=r}get context(){return ft(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,ta(t))}async setRelayerMessagesWithoutClientAck(t){await this.core.storage.setItem(this.storageKeyWithoutClientAck,ta(t))}async getRelayerMessages(){let t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?ra(t):void 0}async getRelayerMessagesWithoutClientAck(){let t=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof t<"u"?ra(t):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){let{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}},k6=Object.defineProperty,N6=Object.defineProperties,R6=Object.getOwnPropertyDescriptors,mm=Object.getOwnPropertySymbols,B6=Object.prototype.hasOwnProperty,L6=Object.prototype.propertyIsEnumerable,Au=(e,t,r)=>t in e?k6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Nn=(e,t)=>{for(var r in t||(t={}))B6.call(t,r)&&Au(e,r,t[r]);if(mm)for(var r of mm(t))L6.call(t,r)&&Au(e,r,t[r]);return e},ym=(e,t)=>N6(e,R6(t)),Vt=(e,t,r)=>Au(e,typeof t!="symbol"?t+"":t,r),Pu=class extends so{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,Vt(this,"events",new fr),Vt(this,"name",k3),Vt(this,"queue",new Map),Vt(this,"publishTimeout",(0,Y.toMiliseconds)(Y.ONE_MINUTE)),Vt(this,"initialPublishTimeout",(0,Y.toMiliseconds)(Y.ONE_SECOND*15)),Vt(this,"needsTransportRestart",!1),Vt(this,"publish",async(s,n,i)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:n,opts:i}});let h=i?.ttl||O3,p=i?.prompt||!1,f=i?.tag||0,g=i?.id||_r().toString(),d=Ks(_i().protocol),b={id:g,method:i?.publishMethod||d.publish,params:Nn({topic:s,message:n,ttl:h,prompt:p,tag:f,attestation:i?.attestation},i?.tvf)},k=`Failed to publish payload, please try again. id:${g} tag:${f}`;try{Ae((o=b.params)==null?void 0:o.prompt)&&((a=b.params)==null||delete a.prompt),Ae((c=b.params)==null?void 0:c.tag)&&((l=b.params)==null||delete l.tag);let q=new Promise(async T=>{let I=({id:R})=>{var j;((j=b.id)==null?void 0:j.toString())===R.toString()&&(this.removeRequestFromQueue(R),this.relayer.events.removeListener(Pe.publish,I),T())};this.relayer.events.on(Pe.publish,I);let L=nr(new Promise((R,j)=>{this.rpcPublish(b,i).then(R).catch(H=>{this.logger.warn(H,H?.message),j(H)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${g} tag:${f}`);try{await L,this.events.removeListener(Pe.publish,I)}catch(R){this.queue.set(g,{request:b,opts:i,attempt:1}),this.logger.warn(R,R?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:g,topic:s,message:n,opts:i}}),await nr(q,this.publishTimeout,k)}catch(q){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(q),(u=i?.internal)!=null&&u.throwOnFailedPublish)throw q}finally{this.queue.delete(g)}}),Vt(this,"publishCustom",async s=>{var n,i,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:s});let{payload:l,opts:u={}}=s,{attestation:h,tvf:p,publishMethod:f,prompt:g,tag:d,ttl:b=Y.FIVE_MINUTES}=u,k=u.id||_r().toString(),q=Ks(_i().protocol),T=f||q.publish,I={id:k,method:T,params:Nn(ym(Nn({},l),{ttl:b,prompt:g,tag:d,attestation:h}),p)},L=`Failed to publish custom payload, please try again. id:${k} tag:${d}`;try{Ae((n=I.params)==null?void 0:n.prompt)&&((i=I.params)==null||delete i.prompt),Ae((o=I.params)==null?void 0:o.tag)&&((a=I.params)==null||delete a.tag);let R=new Promise(async j=>{let H=({id:M})=>{var V;((V=I.id)==null?void 0:V.toString())===M.toString()&&(this.removeRequestFromQueue(M),this.relayer.events.removeListener(Pe.publish,H),j())};this.relayer.events.on(Pe.publish,H);let N=nr(new Promise((M,V)=>{this.rpcPublish(I,u).then(M).catch(B=>{this.logger.warn(B,B?.message),V(B)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${T} id:${k} tag:${d}`);try{await N,this.events.removeListener(Pe.publish,H)}catch(M){this.queue.set(k,{request:I,opts:u,attempt:1}),this.logger.warn(M,M?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:k,payload:l,opts:u}}),await nr(R,this.publishTimeout,L)}catch(R){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(R),(c=u?.internal)!=null&&c.throwOnFailedPublish)throw R}finally{this.queue.delete(k)}}),Vt(this,"on",(s,n)=>{this.events.on(s,n)}),Vt(this,"once",(s,n)=>{this.events.once(s,n)}),Vt(this,"off",(s,n)=>{this.events.off(s,n)}),Vt(this,"removeListener",(s,n)=>{this.events.removeListener(s,n)}),this.relayer=t,this.logger=dt(r,this.name),this.registerEventListeners()}get context(){return ft(this.logger)}async rpcPublish(t,r){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:t});let s=await this.relayer.request(t);return this.relayer.events.emit(Pe.publish,Nn(Nn({},t),r)),this.logger.debug("Successfully Published Payload"),s}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async(t,r)=>{var s;let n=t.attempt+1;this.queue.set(r,ym(Nn({},t),{attempt:n})),this.logger.warn({},`Publisher: queue->publishing: ${t.request.id}, tag: ${(s=t.request.params)==null?void 0:s.tag}, attempt: ${n}`),await this.rpcPublish(t.request,t.opts),this.logger.warn({},`Publisher: queue->published: ${t.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(_s.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Pe.connection_stalled);return}this.checkQueue()}),this.relayer.on(Pe.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}},U6=Object.defineProperty,$6=(e,t,r)=>t in e?U6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Rn=(e,t,r)=>$6(e,typeof t!="symbol"?t+"":t,r),Ou=class{constructor(){Rn(this,"map",new Map),Rn(this,"set",(t,r)=>{let s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])}),Rn(this,"get",t=>this.map.get(t)||[]),Rn(this,"exists",(t,r)=>this.get(t).includes(r)),Rn(this,"delete",(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;let s=this.get(t);if(!this.exists(t,r))return;let n=s.filter(i=>i!==r);if(!n.length){this.map.delete(t);return}this.map.set(t,n)}),Rn(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}},j6=Object.defineProperty,D6=Object.defineProperties,q6=Object.getOwnPropertyDescriptors,wm=Object.getOwnPropertySymbols,F6=Object.prototype.hasOwnProperty,M6=Object.prototype.propertyIsEnumerable,ku=(e,t,r)=>t in e?j6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ki=(e,t)=>{for(var r in t||(t={}))F6.call(t,r)&&ku(e,r,t[r]);if(wm)for(var r of wm(t))M6.call(t,r)&&ku(e,r,t[r]);return e},fu=(e,t)=>D6(e,q6(t)),ve=(e,t,r)=>ku(e,typeof t!="symbol"?t+"":t,r),Nu=class extends oo{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,ve(this,"subscriptions",new Map),ve(this,"topicMap",new Ou),ve(this,"events",new fr),ve(this,"name",j3),ve(this,"version",D3),ve(this,"pending",new Map),ve(this,"cached",[]),ve(this,"initialized",!1),ve(this,"storagePrefix",vr),ve(this,"subscribeTimeout",(0,Y.toMiliseconds)(Y.ONE_MINUTE)),ve(this,"initialSubscribeTimeout",(0,Y.toMiliseconds)(Y.ONE_SECOND*15)),ve(this,"clientId"),ve(this,"batchSubscribeTopicsLimit",500),ve(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),ve(this,"subscribe",async(s,n)=>{var i;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:n}});try{let o=_i(n),a={topic:s,relay:o,transportType:n?.transportType};(i=n?.internal)!=null&&i.skipSubscribe||this.pending.set(s,a);let c=await this.rpcSubscribe(s,o,n);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:n}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),ve(this,"unsubscribe",async(s,n)=>{this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(s,n.id,n):await this.unsubscribeByTopic(s,n)}),ve(this,"isSubscribed",s=>new Promise(n=>{n(this.topicMap.topics.includes(s))})),ve(this,"isKnownTopic",s=>new Promise(n=>{n(this.topicMap.topics.includes(s)||this.pending.has(s)||this.cached.some(i=>i.topic===s))})),ve(this,"on",(s,n)=>{this.events.on(s,n)}),ve(this,"once",(s,n)=>{this.events.once(s,n)}),ve(this,"off",(s,n)=>{this.events.off(s,n)}),ve(this,"removeListener",(s,n)=>{this.events.removeListener(s,n)}),ve(this,"start",async()=>{await this.onConnect()}),ve(this,"stop",async()=>{await this.onDisconnect()}),ve(this,"restart",async()=>{await this.restore(),await this.onRestart()}),ve(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;let s=[];this.pending.forEach(n=>{s.push(n)}),await this.batchSubscribe(s)}),ve(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(_s.pulse,async()=>{await this.checkPending()}),this.events.on(Nt.created,async s=>{let n=Nt.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:s}),await this.persist()}),this.events.on(Nt.deleted,async s=>{let n=Nt.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:s}),await this.persist()})}),this.relayer=t,this.logger=dt(r,this.name),this.clientId=""}get context(){return ft(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){let s=this.topicMap.get(t);await Promise.all(s.map(async n=>await this.unsubscribeById(t,n,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{let n=_i(s);await this.restartToComplete({topic:t,id:r,relay:n}),await this.rpcUnsubscribe(t,r,n);let i=be("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(t,r,s){var n,i;let o=await this.getSubscriptionId(t);if((n=s?.internal)!=null&&n.skipSubscribe)return o;(!s||s?.transportType===Ee.relay)&&await this.restartToComplete({topic:t,id:t,relay:r});let a={method:Ks(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});let c=(i=s?.internal)==null?void 0:i.throwOnFailedPublish;try{if(s?.transportType===Ee.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(h=>this.logger.warn(h))},(0,Y.toMiliseconds)(Y.ONE_SECOND)),o;let l=new Promise(async h=>{let p=f=>{f.topic===t&&(this.events.removeListener(Nt.created,p),h(f.id))};this.events.on(Nt.created,p);try{let f=await nr(new Promise((g,d)=>{this.relayer.request(a).catch(b=>{this.logger.warn(b,b?.message),d(b)}).then(g)}),this.initialSubscribeTimeout,`Subscribing to ${t} failed, please try again`);this.events.removeListener(Nt.created,p),h(f)}catch{}}),u=await nr(l,this.subscribeTimeout,`Subscribing to ${t} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${t} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Pe.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(t){if(!t.length)return;let r=t[0].relay,s={method:Ks(r.protocol).batchSubscribe,params:{topics:t.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await nr(new Promise(n=>{this.relayer.request(s).catch(i=>this.logger.warn(i)).then(n)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Pe.connection_stalled)}}async rpcBatchFetchMessages(t){if(!t.length)return;let r=t[0].relay,s={method:Ks(r.protocol).batchFetchMessages,params:{topics:t.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});let n;try{n=await await nr(new Promise((i,o)=>{this.relayer.request(s).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Pe.connection_stalled)}return n}rpcUnsubscribe(t,r,s){let n={method:Ks(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(t,r){this.setSubscription(t,fu(ki({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,ki({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r)}addSubscription(t,r){this.subscriptions.set(t,ki({},r)),this.topicMap.set(r.topic,t),this.events.emit(Nt.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});let r=this.subscriptions.get(t);if(!r){let{message:s}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});let s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(Nt.deleted,fu(ki({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Nt.sync)}async onRestart(){if(this.cached.length){let t=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let s=0;s<r;s++){let n=t.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Nt.resubscribed)}async restore(){try{let t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size&&!t.every(r=>{var s;return r.topic===((s=this.subscriptions.get(r.id))==null?void 0:s.topic)})){let{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){t.length&&(await this.rpcBatchSubscribe(t),this.onBatchSubscribe(await Promise.all(t.map(async r=>fu(ki({},r),{id:await this.getSubscriptionId(r.topic)})))))}async batchFetchMessages(t){if(!t.length)return;this.logger.trace(`Fetching batch messages for ${t.length} subscriptions`);let r=await this.rpcBatchFetchMessages(t);r&&r.messages&&(await Od((0,Y.toMiliseconds)(Y.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(t){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(t),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(t){return vt(t+await this.getClientId())}},z6=Object.defineProperty,bm=Object.getOwnPropertySymbols,H6=Object.prototype.hasOwnProperty,V6=Object.prototype.propertyIsEnumerable,Ru=(e,t,r)=>t in e?z6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,vm=(e,t)=>{for(var r in t||(t={}))H6.call(t,r)&&Ru(e,r,t[r]);if(bm)for(var r of bm(t))V6.call(t,r)&&Ru(e,r,t[r]);return e},he=(e,t,r)=>Ru(e,typeof t!="symbol"?t+"":t,r),Bu=class extends no{constructor(t){var r;super(t),he(this,"protocol","wc"),he(this,"version",2),he(this,"core"),he(this,"logger"),he(this,"events",new fr),he(this,"provider"),he(this,"messages"),he(this,"subscriber"),he(this,"publisher"),he(this,"name",R3),he(this,"transportExplicitlyClosed",!1),he(this,"initialized",!1),he(this,"connectionAttemptInProgress",!1),he(this,"relayUrl"),he(this,"projectId"),he(this,"packageName"),he(this,"bundleId"),he(this,"hasExperiencedNetworkDisruption",!1),he(this,"pingTimeout"),he(this,"heartBeatTimeout",(0,Y.toMiliseconds)(Y.THIRTY_SECONDS+Y.FIVE_SECONDS)),he(this,"reconnectTimeout"),he(this,"connectPromise"),he(this,"reconnectInProgress",!1),he(this,"requestsInFlight",[]),he(this,"connectTimeout",(0,Y.toMiliseconds)(Y.ONE_SECOND*15)),he(this,"request",async s=>{var n,i;this.logger.debug("Publishing Request Payload");let o=s.id||_r().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:s.method,topic:(n=s.params)==null?void 0:n.topic},"relayer.request - publishing...");let a=`${o}:${((i=s.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(a);let c=await this.provider.request(s);return this.requestsInFlight=this.requestsInFlight.filter(l=>l!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),he(this,"resetPingTimeout",()=>{wi()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var s,n,i,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(i=(n=(s=this.provider)==null?void 0:s.connection)==null?void 0:n.socket)==null?void 0:i.terminate)==null||o.call(i)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),he(this,"onPayloadHandler",s=>{this.onProviderPayload(s),this.resetPingTimeout()}),he(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \u{1F6DC}"),this.startPingTimeout(),this.events.emit(Pe.connect)}),he(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \u{1F6D1}"),this.requestsInFlight=[],this.onProviderDisconnect()}),he(this,"onProviderErrorHandler",s=>{this.logger.fatal(`Fatal socket error: ${s.message}`),this.events.emit(Pe.error,s),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),he(this,"registerProviderListeners",()=>{this.provider.on(Ht.payload,this.onPayloadHandler),this.provider.on(Ht.connect,this.onConnectHandler),this.provider.on(Ht.disconnect,this.onDisconnectHandler),this.provider.on(Ht.error,this.onProviderErrorHandler)}),this.core=t.core,this.logger=kn({logger:(r=t.logger)!=null?r:N3,name:this.name}),this.messages=new Tu(this.logger,t.core),this.subscriber=new Nu(this,this.logger),this.publisher=new Pu(this,this.logger),this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||Bm,vd()?this.packageName=Nl():xd()&&(this.bundleId=Nl()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(t=>this.logger.warn(t,t?.message))}get context(){return ft(this.logger)}get connected(){var t,r,s;return((s=(r=(t=this.provider)==null?void 0:t.connection)==null?void 0:r.socket)==null?void 0:s.readyState)===1||!1}get connecting(){var t,r,s;return((s=(r=(t=this.provider)==null?void 0:t.connection)==null?void 0:r.socket)==null?void 0:s.readyState)===0||this.connectPromise!==void 0||!1}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now(),transportType:Ee.relay},ma.outbound)}async publishCustom(t){this.isInitialized(),await this.publisher.publishCustom(t)}async subscribe(t,r){var s,n,i;this.isInitialized(),(!(r!=null&&r.transportType)||r?.transportType==="relay")&&await this.toEstablishConnection();let o=typeof((s=r?.internal)==null?void 0:s.throwOnFailedPublish)>"u"?!0:(n=r?.internal)==null?void 0:n.throwOnFailedPublish,a=((i=this.subscriber.topicMap.get(t))==null?void 0:i[0])||"",c,l=u=>{u.topic===t&&(this.subscriber.off(Nt.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(Nt.created,l)}),new Promise(async(u,h)=>{a=await this.subscriber.subscribe(t,vm({internal:{throwOnFailedPublish:o}},r)).catch(p=>{o&&h(p)})||a,u()})]),a}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await nr(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(t){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,s)=>{await this.connect(t).then(r).catch(s).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(t){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await cu())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(t){if(t?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}let r=t.sort((s,n)=>s.publishedAt-n.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(let s of r)try{await this.onMessageEvent(s)}catch(n){this.logger.warn(n,"Error while processing batch message event: "+n?.message)}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(t,r){let{topic:s}=t;if(!r.sessionExists){let n=Ie(Y.FIVE_MINUTES),i={topic:s,expiry:n,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(s,i)}this.events.emit(Pe.message,t),await this.recordMessageEvent(t,ma.inbound)}async connect(t){await this.confirmOnlineStateOrThrow(),t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(s,n)=>{let i=()=>{n(new Error("Connection interrupted while trying to connect"))};this.provider.once(Ht.disconnect,i),await nr(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{n(o)}).finally(()=>{this.provider.off(Ht.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{let c=()=>{n(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Ht.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Ht.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,s()})}catch(s){await this.subscriber.stop();let n=s;this.logger.warn({},n.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(s=>setTimeout(s,(0,Y.toMiliseconds)(r*1))),r++}}startPingTimeout(){var t,r,s,n,i;if(wi())try{(r=(t=this.provider)==null?void 0:t.connection)!=null&&r.socket&&((i=(n=(s=this.provider)==null?void 0:s.connection)==null?void 0:n.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Xn(new ap(Sd({sdkVersion:gu,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(t,r){let{topic:s,message:n}=t;await this.messages.set(s,n,r)}async shouldIgnoreMessageEvent(t){let{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isKnownTopic(r))return this.logger.warn(`Ignoring message for unknown topic ${r}`),!0;let n=this.messages.has(r,s);return n&&this.logger.warn(`Ignoring duplicate message: ${s}`),n}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Zn(t)){if(!t.method.endsWith(B3))return;let r=t.params,{topic:s,message:n,publishedAt:i,attestation:o}=r.data,a={topic:s,message:n,publishedAt:i,transportType:Ee.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(vm({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(t),await this.onMessageEvent(a)}else Yn(t)&&this.events.emit(Pe.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(await this.recordMessageEvent(t,ma.inbound),this.events.emit(Pe.message,t))}async acknowledgePayload(t){let r=Wr(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Ht.payload,this.onPayloadHandler),this.provider.off(Ht.connect,this.onConnectHandler),this.provider.off(Ht.disconnect,this.onDisconnectHandler),this.provider.off(Ht.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let t=await cu();rm(async r=>{t!==r&&(t=r,r?await this.transportOpen().catch(s=>this.logger.error(s,s?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(_s.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&sm())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(r){this.logger.warn(r,r?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(Pe.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(t=>this.logger.error(t,t?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},(0,Y.toMiliseconds)(L3)))))}isInitialized(){if(!this.initialized){let{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}};function K6(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}function xm(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function Em(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var G6="[object RegExp]",W6="[object String]",Z6="[object Number]",Y6="[object Boolean]",Sm="[object Arguments]",X6="[object Symbol]",J6="[object Date]",Q6="[object Map]",e5="[object Set]",t5="[object Array]",r5="[object Function]",s5="[object ArrayBuffer]",du="[object Object]",n5="[object Error]",i5="[object DataView]",o5="[object Uint8Array]",a5="[object Uint8ClampedArray]",c5="[object Uint16Array]",l5="[object Uint32Array]",u5="[object BigUint64Array]",h5="[object Int8Array]",p5="[object Int16Array]",f5="[object Int32Array]",d5="[object BigInt64Array]",g5="[object Float32Array]",m5="[object Float64Array]";function y5(){}function Cm(e){if(!e||typeof e!="object")return!1;let t=Object.getPrototypeOf(e);return t===null||t===Object.prototype||Object.getPrototypeOf(t)===null?Object.prototype.toString.call(e)==="[object Object]":!1}function w5(e,t,r){return Ri(e,t,void 0,void 0,void 0,void 0,r)}function Ri(e,t,r,s,n,i,o){let a=o(e,t,r,s,n,i);if(a!==void 0)return a;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return e===t;case"number":return e===t||Object.is(e,t);case"function":return e===t;case"object":return Bi(e,t,i,o)}return Bi(e,t,i,o)}function Bi(e,t,r,s){if(Object.is(e,t))return!0;let n=Em(e),i=Em(t);if(n===Sm&&(n=du),i===Sm&&(i=du),n!==i)return!1;switch(n){case W6:return e.toString()===t.toString();case Z6:{let c=e.valueOf(),l=t.valueOf();return K6(c,l)}case Y6:case J6:case X6:return Object.is(e.valueOf(),t.valueOf());case G6:return e.source===t.source&&e.flags===t.flags;case r5:return e===t}r=r??new Map;let o=r.get(e),a=r.get(t);if(o!=null&&a!=null)return o===t;r.set(e,t),r.set(t,e);try{switch(n){case Q6:{if(e.size!==t.size)return!1;for(let[c,l]of e.entries())if(!t.has(c)||!Ri(l,t.get(c),c,e,t,r,s))return!1;return!0}case e5:{if(e.size!==t.size)return!1;let c=Array.from(e.values()),l=Array.from(t.values());for(let u=0;u<c.length;u++){let h=c[u],p=l.findIndex(f=>Ri(h,f,void 0,e,t,r,s));if(p===-1)return!1;l.splice(p,1)}return!0}case t5:case o5:case a5:case c5:case l5:case u5:case h5:case p5:case f5:case d5:case g5:case m5:{if(typeof P<"u"&&P.isBuffer(e)!==P.isBuffer(t)||e.length!==t.length)return!1;for(let c=0;c<e.length;c++)if(!Ri(e[c],t[c],c,e,t,r,s))return!1;return!0}case s5:return e.byteLength!==t.byteLength?!1:Bi(new Uint8Array(e),new Uint8Array(t),r,s);case i5:return e.byteLength!==t.byteLength||e.byteOffset!==t.byteOffset?!1:Bi(new Uint8Array(e),new Uint8Array(t),r,s);case n5:return e.name===t.name&&e.message===t.message;case du:{if(!(Bi(e.constructor,t.constructor,r,s)||Cm(e)&&Cm(t)))return!1;let c=[...Object.keys(e),...xm(e)],l=[...Object.keys(t),...xm(t)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){let h=c[u],p=e[h];if(!Object.hasOwn(t,h))return!1;let f=t[h];if(!Ri(p,f,h,e,t,r,s))return!1}return!0}default:return!1}}finally{r.delete(e),r.delete(t)}}function b5(e,t){return w5(e,t,y5)}var v5=Object.defineProperty,Im=Object.getOwnPropertySymbols,x5=Object.prototype.hasOwnProperty,E5=Object.prototype.propertyIsEnumerable,Lu=(e,t,r)=>t in e?v5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_m=(e,t)=>{for(var r in t||(t={}))x5.call(t,r)&&Lu(e,r,t[r]);if(Im)for(var r of Im(t))E5.call(t,r)&&Lu(e,r,t[r]);return e},xt=(e,t,r)=>Lu(e,typeof t!="symbol"?t+"":t,r),xr=class extends io{constructor(t,r,s,n=vr,i=void 0){super(t,r,s,n),this.core=t,this.logger=r,this.name=s,xt(this,"map",new Map),xt(this,"version",U3),xt(this,"cached",[]),xt(this,"initialized",!1),xt(this,"getKey"),xt(this,"storagePrefix",vr),xt(this,"recentlyDeleted",[]),xt(this,"recentlyDeletedLimit",200),xt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Ae(o)?this.map.set(this.getKey(o),o):Mg(o)?this.map.set(o.id,o):zg(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),xt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),xt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),xt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>b5(a[c],o[c]))):this.values)),xt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});let c=_m(_m({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),xt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=dt(r,this.name),this.storagePrefix=n,this.getKey=i}get context(){return ft(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(t){this.recentlyDeleted.push(t),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){let r=this.map.get(t);if(!r){if(this.recentlyDeleted.includes(t)){let{message:n}=G("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}let{message:s}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{let t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){let{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){let{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}},S5=Object.defineProperty,C5=(e,t,r)=>t in e?S5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ae=(e,t,r)=>C5(e,typeof t!="symbol"?t+"":t,r),Uu=class{constructor(t,r){this.core=t,this.logger=r,ae(this,"name",q3),ae(this,"version",F3),ae(this,"events",new Cs),ae(this,"pairings"),ae(this,"initialized",!1),ae(this,"storagePrefix",vr),ae(this,"ignoredPayloadTypes",[ir]),ae(this,"registeredMethods",[]),ae(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ae(this,"register",({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]}),ae(this,"create",async s=>{this.isInitialized();let n=fa(),i=await this.core.crypto.setSymKey(n),o=Ie(Y.FIVE_MINUTES),a={protocol:Vu},c={topic:i,expiry:o,relay:a,active:!1,methods:s?.methods},l=tu({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:a,expiryTimestamp:o,methods:s?.methods});return this.events.emit(gs.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:s?.transportType,internal:s?.internal}),{topic:i,uri:l}}),ae(this,"pair",async s=>{this.isInitialized();let n=this.core.eventClient.createEvent({properties:{topic:s?.uri,trace:[cr.pairing_started]}});this.isValidPair(s,n);let{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=eu(s.uri);n.props.properties.topic=i,n.addTrace(cr.pairing_uri_validation_success),n.addTrace(cr.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),n.addTrace(cr.existing_pairing),u.active)throw n.setError(br.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);n.addTrace(cr.pairing_not_expired)}let h=c||Ie(Y.FIVE_MINUTES),p={topic:i,relay:a,expiry:h,active:!1,methods:l};this.core.expirer.set(i,h),await this.pairings.set(i,p),n.addTrace(cr.store_new_pairing),s.activatePairing&&await this.activate({topic:i}),this.events.emit(gs.create,p),n.addTrace(cr.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),n.addTrace(cr.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{n.setError(br.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(f){throw n.setError(br.subscribe_pairing_topic_failure),f}return n.addTrace(cr.subscribe_pairing_topic_success),p}),ae(this,"activate",async({topic:s})=>{this.isInitialized();let n=Ie(Y.FIVE_MINUTES);this.core.expirer.set(s,n),await this.pairings.update(s,{active:!0,expiry:n})}),ae(this,"ping",async s=>{this.isInitialized(),await this.isValidPing(s),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:n}=s;if(this.pairings.keys.includes(n)){let i=await this.sendRequest(n,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=Fr();this.events.once(fe("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),ae(this,"updateExpiry",async({topic:s,expiry:n})=>{this.isInitialized(),await this.pairings.update(s,{expiry:n})}),ae(this,"updateMetadata",async({topic:s,metadata:n})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:n})}),ae(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ae(this,"disconnect",async s=>{this.isInitialized(),await this.isValidDisconnect(s);let{topic:n}=s;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",be("USER_DISCONNECTED")),await this.deletePairing(n))}),ae(this,"formatUriFromPairing",s=>{this.isInitialized();let{topic:n,relay:i,expiry:o,methods:a}=s,c=this.core.crypto.keychain.get(n);return tu({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),ae(this,"sendRequest",async(s,n,i)=>{let o=Ct(n,i),a=await this.core.crypto.encode(s,o),c=Oi[n].req;return this.core.history.set(s,o),this.core.relayer.publish(s,a,c),o.id}),ae(this,"sendResult",async(s,n,i)=>{let o=Wr(s,i),a=await this.core.crypto.encode(n,o),c=(await this.core.history.get(n,s)).request.method,l=Oi[c].res;await this.core.relayer.publish(n,a,l),await this.core.history.resolve(o)}),ae(this,"sendError",async(s,n,i)=>{let o=Hi(s,i),a=await this.core.crypto.encode(n,o),c=(await this.core.history.get(n,s)).request.method,l=Oi[c]?Oi[c].res:Oi.unregistered_method.res;await this.core.relayer.publish(n,a,l),await this.core.history.resolve(o)}),ae(this,"deletePairing",async(s,n)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,be("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),n?Promise.resolve():this.core.expirer.del(s)])}),ae(this,"cleanup",async()=>{let s=this.pairings.getAll().filter(n=>Ot(n.expiry));await Promise.all(s.map(n=>this.deletePairing(n.topic)))}),ae(this,"onRelayEventRequest",async s=>{let{topic:n,payload:i}=s;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(n,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(n,i);default:return await this.onUnknownRpcMethodRequest(n,i)}}),ae(this,"onRelayEventResponse",async s=>{let{topic:n,payload:i}=s,o=(await this.core.history.get(n,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(n,i);default:return this.onUnknownRpcMethodResponse(o)}}),ae(this,"onPairingPingRequest",async(s,n)=>{let{id:i}=n;try{this.isValidPing({topic:s}),await this.sendResult(i,s,!0),this.events.emit(gs.ping,{id:i,topic:s})}catch(o){await this.sendError(i,s,o),this.logger.error(o)}}),ae(this,"onPairingPingResponse",(s,n)=>{let{id:i}=n;setTimeout(()=>{Zt(n)?this.events.emit(fe("pairing_ping",i),{}):jt(n)&&this.events.emit(fe("pairing_ping",i),{error:n.error})},500)}),ae(this,"onPairingDeleteRequest",async(s,n)=>{let{id:i}=n;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(gs.delete,{id:i,topic:s})}catch(o){await this.sendError(i,s,o),this.logger.error(o)}}),ae(this,"onUnknownRpcMethodRequest",async(s,n)=>{let{id:i,method:o}=n;try{if(this.registeredMethods.includes(o))return;let a=be("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,s,a),this.logger.error(a)}catch(a){await this.sendError(i,s,a),this.logger.error(a)}}),ae(this,"onUnknownRpcMethodResponse",s=>{this.registeredMethods.includes(s)||this.logger.error(be("WC_METHOD_UNSUPPORTED",s))}),ae(this,"isValidPair",(s,n)=>{var i;if(!Je(s)){let{message:a}=G("MISSING_OR_INVALID",`pair() params: ${s}`);throw n.setError(br.malformed_pairing_uri),new Error(a)}if(!Fg(s.uri)){let{message:a}=G("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw n.setError(br.malformed_pairing_uri),new Error(a)}let o=eu(s?.uri);if(!((i=o?.relay)!=null&&i.protocol)){let{message:a}=G("MISSING_OR_INVALID","pair() uri#relay-protocol");throw n.setError(br.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){let{message:a}=G("MISSING_OR_INVALID","pair() uri#symKey");throw n.setError(br.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&(0,Y.toMiliseconds)(o?.expiryTimestamp)<Date.now()){n.setError(br.pairing_expired);let{message:a}=G("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ae(this,"isValidPing",async s=>{if(!Je(s)){let{message:i}=G("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(i)}let{topic:n}=s;await this.isValidPairingTopic(n)}),ae(this,"isValidDisconnect",async s=>{if(!Je(s)){let{message:i}=G("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(i)}let{topic:n}=s;await this.isValidPairingTopic(n)}),ae(this,"isValidPairingTopic",async s=>{if(!Te(s,!1)){let{message:n}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(n)}if(!this.pairings.keys.includes(s)){let{message:n}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(n)}if(Ot(this.pairings.get(s).expiry)){await this.deletePairing(s);let{message:n}=G("EXPIRED",`pairing topic: ${s}`);throw new Error(n)}}),this.core=t,this.logger=dt(r,this.name),this.pairings=new xr(this.core,this.logger,this.name,this.storagePrefix)}get context(){return ft(this.logger)}isInitialized(){if(!this.initialized){let{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Pe.message,async t=>{let{topic:r,message:s,transportType:n}=t;if(this.pairings.keys.includes(r)&&n!==Ee.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))try{let i=await this.core.crypto.decode(r,s);Zn(i)?(this.core.history.set(r,i),await this.onRelayEventRequest({topic:r,payload:i})):Yn(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:r,payload:i}),this.core.history.delete(r,i.id)),await this.core.relayer.messages.ack(r,s)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(Rt.expired,async t=>{let{topic:r}=sa(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(gs.expire,{topic:r}))})}},I5=Object.defineProperty,_5=(e,t,r)=>t in e?I5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,qe=(e,t,r)=>_5(e,typeof t!="symbol"?t+"":t,r),$u=class extends to{constructor(t,r){super(t,r),this.core=t,this.logger=r,qe(this,"records",new Map),qe(this,"events",new fr),qe(this,"name",M3),qe(this,"version",z3),qe(this,"cached",[]),qe(this,"initialized",!1),qe(this,"storagePrefix",vr),qe(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),qe(this,"set",(s,n,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:n,chainId:i}),this.records.has(n.id))return;let o={id:n.id,topic:s,request:{method:n.method,params:n.params||null},chainId:i,expiry:Ie(Y.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(ar.created,o)}),qe(this,"resolve",async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;let n=await this.getRecord(s.id);typeof n.response>"u"&&(n.response=jt(s)?{error:s.error}:{result:s.result},this.records.set(n.id,n),this.persist(),this.events.emit(ar.updated,n))}),qe(this,"get",async(s,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:n}),await this.getRecord(n))),qe(this,"delete",(s,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(i=>{if(i.topic===s){if(typeof n<"u"&&i.id!==n)return;this.records.delete(i.id),this.events.emit(ar.deleted,i)}}),this.persist()}),qe(this,"exists",async(s,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===s:!1)),qe(this,"on",(s,n)=>{this.events.on(s,n)}),qe(this,"once",(s,n)=>{this.events.once(s,n)}),qe(this,"off",(s,n)=>{this.events.off(s,n)}),qe(this,"removeListener",(s,n)=>{this.events.removeListener(s,n)}),this.logger=dt(r,this.name)}get context(){return ft(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;let s={topic:r.topic,request:Ct(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();let r=this.records.get(t);if(!r){let{message:s}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ar.sync)}async restore(){try{let t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){let{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(ar.created,t=>{let r=ar.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t})}),this.events.on(ar.updated,t=>{let r=ar.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t})}),this.events.on(ar.deleted,t=>{let r=ar.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t})}),this.core.heartbeat.on(_s.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let t=!1;this.records.forEach(r=>{(0,Y.toMiliseconds)(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(ar.deleted,r,!1),t=!0)}),t&&this.persist()}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){let{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}},T5=Object.defineProperty,A5=(e,t,r)=>t in e?T5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Qe=(e,t,r)=>A5(e,typeof t!="symbol"?t+"":t,r),ju=class extends ao{constructor(t,r){super(t,r),this.core=t,this.logger=r,Qe(this,"expirations",new Map),Qe(this,"events",new fr),Qe(this,"name",H3),Qe(this,"version",V3),Qe(this,"cached",[]),Qe(this,"initialized",!1),Qe(this,"storagePrefix",vr),Qe(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Qe(this,"has",s=>{try{let n=this.formatTarget(s);return typeof this.getExpiration(n)<"u"}catch{return!1}}),Qe(this,"set",(s,n)=>{this.isInitialized();let i=this.formatTarget(s),o={target:i,expiry:n};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(Rt.created,{target:i,expiration:o})}),Qe(this,"get",s=>{this.isInitialized();let n=this.formatTarget(s);return this.getExpiration(n)}),Qe(this,"del",s=>{if(this.isInitialized(),this.has(s)){let n=this.formatTarget(s),i=this.getExpiration(n);this.expirations.delete(n),this.events.emit(Rt.deleted,{target:n,expiration:i})}}),Qe(this,"on",(s,n)=>{this.events.on(s,n)}),Qe(this,"once",(s,n)=>{this.events.once(s,n)}),Qe(this,"off",(s,n)=>{this.events.off(s,n)}),Qe(this,"removeListener",(s,n)=>{this.events.removeListener(s,n)}),this.logger=dt(r,this.name)}get context(){return ft(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Id(t);if(typeof t=="number")return _d(t);let{message:r}=G("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Rt.sync)}async restore(){try{let t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){let{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){let r=this.expirations.get(t);if(!r){let{message:s}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.warn(s),new Error(s)}return r}checkExpiry(t,r){let{expiry:s}=r;(0,Y.toMiliseconds)(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Rt.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(_s.pulse,()=>this.checkExpirations()),this.events.on(Rt.created,t=>{let r=Rt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Rt.expired,t=>{let r=Rt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Rt.deleted,t=>{let r=Rt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){let{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}},P5=Object.defineProperty,O5=(e,t,r)=>t in e?P5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ke=(e,t,r)=>O5(e,typeof t!="symbol"?t+"":t,r),Du=class extends co{constructor(t,r,s){super(t,r,s),this.core=t,this.logger=r,this.store=s,ke(this,"name",K3),ke(this,"abortController"),ke(this,"isDevEnv"),ke(this,"verifyUrlV3",W3),ke(this,"storagePrefix",vr),ke(this,"version",Rm),ke(this,"publicKey"),ke(this,"fetchPromise"),ke(this,"init",async()=>{var n;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,Y.toMiliseconds)((n=this.publicKey)==null?void 0:n.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),ke(this,"register",async n=>{if(!Hs()||this.isDevEnv)return;let i=window.location.origin,{id:o,decryptedId:a}=n,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{let l=(0,km.getDocument)(),u=this.startAbortTimer(Y.ONE_SECOND*5),h=await new Promise((p,f)=>{let g=()=>{window.removeEventListener("message",b),l.body.removeChild(d),f("attestation aborted")};this.abortController.signal.addEventListener("abort",g);let d=l.createElement("iframe");d.src=c,d.style.display="none",d.addEventListener("error",g,{signal:this.abortController.signal});let b=k=>{if(k.data&&typeof k.data=="string")try{let q=JSON.parse(k.data);if(q.type==="verify_attestation"){if(Wn(q.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(d),this.abortController.signal.removeEventListener("abort",g),window.removeEventListener("message",b),p(q.attestation===null?"":q.attestation)}}catch(q){this.logger.warn(q)}};l.body.appendChild(d),window.addEventListener("message",b,{signal:this.abortController.signal})});return this.logger.debug(h,"jwt attestation"),h}catch(l){this.logger.warn(l)}return""}),ke(this,"resolve",async n=>{if(this.isDevEnv)return"";let{attestationId:i,hash:o,encryptedId:a}=n;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Wn(i).payload.id!==a)return;let l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;let c=this.getVerifyUrl(n?.verifyUrl);return this.fetchAttestation(o,c)}),ke(this,"fetchAttestation",async(n,i)=>{this.logger.debug(`resolving attestation: ${n} from url: ${i}`);let o=this.startAbortTimer(Y.ONE_SECOND*5),a=await fetch(`${i}/attestation/${n}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),ke(this,"getVerifyUrl",n=>{let i=n||Bn;return Z3.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${Bn}`),i=Bn),i}),ke(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let n=this.startAbortTimer(Y.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(n),await i.json()}catch(n){this.logger.warn(n)}}),ke(this,"persistPublicKey",async n=>{this.logger.debug(n,"persisting public key to local storage"),await this.store.setItem(this.storeKey,n),this.publicKey=n}),ke(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),ke(this,"isValidJwtAttestation",async n=>{let i=await this.getPublicKey();try{if(i)return this.validateAttestation(n,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}let o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(n,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),ke(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),ke(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{let o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});let n=await this.fetchPromise;return this.fetchPromise=void 0,n}),ke(this,"validateAttestation",(n,i)=>{let o=Ug(n,i.publicKey),a={hasExpired:(0,Y.toMiliseconds)(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=dt(r,this.name),this.abortController=new AbortController,this.isDevEnv=vi(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return ft(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,Y.toMiliseconds)(t))}},k5=Object.defineProperty,N5=(e,t,r)=>t in e?k5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Tm=(e,t,r)=>N5(e,typeof t!="symbol"?t+"":t,r),qu=class extends lo{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,Tm(this,"context",Y3),Tm(this,"registerDeviceToken",async s=>{let{clientId:n,token:i,notificationType:o,enableEncrypted:a=!1}=s,c=`${X3}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:n,type:o,token:i,always_raw:a})})}),this.logger=dt(r,this.context)}},R5=Object.defineProperty,Am=Object.getOwnPropertySymbols,B5=Object.prototype.hasOwnProperty,L5=Object.prototype.propertyIsEnumerable,Fu=(e,t,r)=>t in e?R5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ni=(e,t)=>{for(var r in t||(t={}))B5.call(t,r)&&Fu(e,r,t[r]);if(Am)for(var r of Am(t))L5.call(t,r)&&Fu(e,r,t[r]);return e},je=(e,t,r)=>Fu(e,typeof t!="symbol"?t+"":t,r),Mu=class extends uo{constructor(t,r,s=!0){super(t,r,s),this.core=t,this.logger=r,je(this,"context",Q3),je(this,"storagePrefix",vr),je(this,"storageVersion",J3),je(this,"events",new Map),je(this,"shouldPersist",!1),je(this,"init",async()=>{if(!vi())try{let n={eventId:Ul(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:Bl(this.core.relayer.protocol,this.core.relayer.version,gu)}}};await this.sendEvent([n])}catch(n){this.logger.warn(n)}}),je(this,"createEvent",n=>{let{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=n,l=Ul(),u=this.core.projectId||"",h=Date.now(),p=Ni({eventId:l,timestamp:h,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,p),this.shouldPersist=!0),p}),je(this,"getEvent",n=>{let{eventId:i,topic:o}=n;if(i)return this.events.get(i);let a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Ni(Ni({},a),this.setMethods(a.eventId))}),je(this,"deleteEvent",n=>{let{eventId:i}=n;this.events.delete(i),this.shouldPersist=!0}),je(this,"setEventListeners",()=>{this.core.heartbeat.on(_s.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(n=>{(0,Y.fromMiliseconds)(Date.now())-(0,Y.fromMiliseconds)(n.timestamp)>e4&&(this.events.delete(n.eventId),this.shouldPersist=!0)})})}),je(this,"setMethods",n=>({addTrace:i=>this.addTrace(n,i),setError:i=>this.setError(n,i)})),je(this,"addTrace",(n,i)=>{let o=this.events.get(n);o&&(o.props.properties.trace.push(i),this.events.set(n,o),this.shouldPersist=!0)}),je(this,"setError",(n,i)=>{let o=this.events.get(n);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(n,o),this.shouldPersist=!0)}),je(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),je(this,"restore",async()=>{try{let n=await this.core.storage.getItem(this.storageKey)||[];if(!n.length)return;n.forEach(i=>{this.events.set(i.eventId,Ni(Ni({},i),this.setMethods(i.eventId)))})}catch(n){this.logger.warn(n)}}),je(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;let n=[];for(let[i,o]of this.events)o.props.type&&n.push(o);if(n.length!==0)try{if((await this.sendEvent(n)).ok)for(let i of n)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),je(this,"sendEvent",async n=>{let i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${t4}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${gu}${i}`,{method:"POST",body:JSON.stringify(n)})}),je(this,"getAppDomain",()=>Rl().url),this.logger=dt(r,this.context),this.telemetryEnabled=s,s?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}},U5=Object.defineProperty,Pm=Object.getOwnPropertySymbols,$5=Object.prototype.hasOwnProperty,j5=Object.prototype.propertyIsEnumerable,zu=(e,t,r)=>t in e?U5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Om=(e,t)=>{for(var r in t||(t={}))$5.call(t,r)&&zu(e,r,t[r]);if(Pm)for(var r of Pm(t))j5.call(t,r)&&zu(e,r,t[r]);return e},xe=(e,t,r)=>zu(e,typeof t!="symbol"?t+"":t,r),Hu=class e extends eo{constructor(t){var r;super(t),xe(this,"protocol",Nm),xe(this,"version",Rm),xe(this,"name",ya),xe(this,"relayUrl"),xe(this,"projectId"),xe(this,"customStoragePrefix"),xe(this,"events",new fr),xe(this,"logger"),xe(this,"heartbeat"),xe(this,"relayer"),xe(this,"crypto"),xe(this,"storage"),xe(this,"history"),xe(this,"expirer"),xe(this,"pairing"),xe(this,"verify"),xe(this,"echoClient"),xe(this,"linkModeSupportedApps"),xe(this,"eventClient"),xe(this,"initialized",!1),xe(this,"logChunkController"),xe(this,"on",(a,c)=>this.events.on(a,c)),xe(this,"once",(a,c)=>this.events.once(a,c)),xe(this,"off",(a,c)=>this.events.off(a,c)),xe(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),xe(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;let u={topic:a,message:c,publishedAt:Date.now(),transportType:Ee.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});let s=this.getGlobalCore(t?.customStoragePrefix);if(s)try{return this.customStoragePrefix=s.customStoragePrefix,this.logger=s.logger,this.heartbeat=s.heartbeat,this.crypto=s.crypto,this.history=s.history,this.expirer=s.expirer,this.storage=s.storage,this.relayer=s.relayer,this.pairing=s.pairing,this.verify=s.verify,this.echoClient=s.echoClient,this.linkModeSupportedApps=s.linkModeSupportedApps,this.eventClient=s.eventClient,this.initialized=s.initialized,this.logChunkController=s.logChunkController,s}catch(a){console.warn("Failed to copy global core",a)}this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||Bm,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";let n=bp({level:typeof t?.logger=="string"&&t.logger?t.logger:E3.logger,name:ya}),{logger:i,chunkLoggerController:o}=vp({opts:n,maxSizeInBytes:t?.maxLogBlobSizeInBytes,loggerOverride:t?.logger});this.logChunkController=o,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=dt(i,this.name),this.heartbeat=new Yh,this.crypto=new Iu(this,this.logger,t?.keychain),this.history=new $u(this,this.logger),this.expirer=new ju(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Jh(Om(Om({},S3),t?.storageOptions)),this.relayer=new Bu({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Uu(this,this.logger),this.verify=new Du(this,this.logger,this.storage),this.echoClient=new qu(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new Mu(this,this.logger,t?.telemetryEnabled),this.setGlobalCore(this)}static async init(t){let r=new e(t);await r.initialize();let s=await r.crypto.getClientId();return await r.storage.setItem($3,s),r}get context(){return ft(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var t;return(t=this.logChunkController)==null?void 0:t.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(t){this.linkModeSupportedApps.includes(t)||(this.linkModeSupportedApps.push(t),await this.storage.setItem(cm,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(cm)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(t,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(t.message),t}}getGlobalCore(t=""){try{if(this.isGlobalCoreDisabled())return;let r=`_walletConnectCore_${t}`,s=`${r}_count`;return globalThis[s]=(globalThis[s]||0)+1,globalThis[s]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[s]} times.`),globalThis[r]}catch(r){console.warn("Failed to get global WalletConnect core",r);return}}setGlobalCore(t){var r;try{if(this.isGlobalCoreDisabled())return;let s=`_walletConnectCore_${((r=t.opts)==null?void 0:r.customStoragePrefix)||""}`;globalThis[s]=t}catch(s){console.warn("Failed to set global WalletConnect core",s)}}isGlobalCoreDisabled(){try{return typeof $<"u"&&$.env.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}},Gm=Hu;m();w();y();var Zu={exports:{}};function D5(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}var q5=F5;function F5(e,t,r){var s=r&&r.stringify||D5,n=1;if(typeof e=="object"&&e!==null){var i=t.length+n;if(i===1)return e;var o=new Array(i);o[0]=s(e);for(var a=1;a<i;a++)o[a]=s(t[a]);return o.join(" ")}if(typeof e!="string")return e;var c=t.length;if(c===0)return e;for(var l="",u=1-n,h=-1,p=e&&e.length||0,f=0;f<p;){if(e.charCodeAt(f)===37&&f+1<p){switch(h=h>-1?h:0,e.charCodeAt(f+1)){case 100:case 102:if(u>=c||t[u]==null)break;h<f&&(l+=e.slice(h,f)),l+=Number(t[u]),h=f+2,f++;break;case 105:if(u>=c||t[u]==null)break;h<f&&(l+=e.slice(h,f)),l+=Math.floor(Number(t[u])),h=f+2,f++;break;case 79:case 111:case 106:if(u>=c||t[u]===void 0)break;h<f&&(l+=e.slice(h,f));var g=typeof t[u];if(g==="string"){l+="'"+t[u]+"'",h=f+2,f++;break}if(g==="function"){l+=t[u].name||"<anonymous>",h=f+2,f++;break}l+=s(t[u]),h=f+2,f++;break;case 115:if(u>=c)break;h<f&&(l+=e.slice(h,f)),l+=String(t[u]),h=f+2,f++;break;case 37:h<f&&(l+=e.slice(h,f)),l+="%",h=f+2,f++,u--;break}++u}++f}return h===-1?e:(h<p&&(l+=e.slice(h)),l)}var Wm=q5;Zu.exports=zr;var Ui=rx().console||{},M5={mapHttpRequest:ba,mapHttpResponse:ba,wrapRequestSerializer:Ku,wrapResponseSerializer:Ku,wrapErrorSerializer:Ku,req:ba,res:ba,err:Ym,errWithCause:Ym};function ws(e,t){return e==="silent"?1/0:t.levels.values[e]}var Yu=Symbol("pino.logFuncs"),Gu=Symbol("pino.hierarchy"),z5={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function Zm(e,t){let r={logger:t,parent:e[Gu]};t[Gu]=r}function H5(e,t,r){let s={};t.forEach(n=>{s[n]=r[n]?r[n]:Ui[n]||Ui[z5[n]||"log"]||Un}),e[Yu]=s}function V5(e,t){return Array.isArray(e)?e.filter(function(r){return r!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function zr(e){e=e||{},e.browser=e.browser||{};let t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");let r=e.browser.write||Ui;e.browser.write&&(e.browser.asObject=!0);let s=e.serializers||{},n=V5(e.browser.serialize,s),i=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);let o=Object.keys(e.customLevels||{}),a=["error","fatal","warn","info","debug","trace"].concat(o);typeof r=="function"&&a.forEach(function(d){r[d]=r}),(e.enabled===!1||e.browser.disabled)&&(e.level="silent");let c=e.level||"info",l=Object.create(r);l.log||(l.log=Un),H5(l,a,r),Zm({},l),Object.defineProperty(l,"levelVal",{get:h}),Object.defineProperty(l,"level",{get:p,set:f});let u={transmit:t,serialize:n,asObject:e.browser.asObject,asObjectBindingsOnly:e.browser.asObjectBindingsOnly,formatters:e.browser.formatters,levels:a,timestamp:Q5(e),messageKey:e.messageKey||"msg",onChild:e.onChild||Un};l.levels=K5(e),l.level=c,l.isLevelEnabled=function(d){return this.levels.values[d]?this.levels.values[d]>=this.levels.values[this.level]:!1},l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=Un,l.serializers=s,l._serialize=n,l._stdErrSerialize=i,l.child=function(...d){return g.call(this,u,...d)},t&&(l._logEvent=Wu());function h(){return ws(this.level,this)}function p(){return this._level}function f(d){if(d!=="silent"&&!this.levels.values[d])throw Error("unknown level "+d);this._level=d,Ws(this,u,l,"error"),Ws(this,u,l,"fatal"),Ws(this,u,l,"warn"),Ws(this,u,l,"info"),Ws(this,u,l,"debug"),Ws(this,u,l,"trace"),o.forEach(b=>{Ws(this,u,l,b)})}function g(d,b,k){if(!b)throw new Error("missing bindings for child Pino");k=k||{},n&&b.serializers&&(k.serializers=b.serializers);let q=k.serializers;if(n&&q){var T=Object.assign({},s,q),I=e.browser.serialize===!0?Object.keys(T):n;delete b.serializers,Xu([b],I,T,this._stdErrSerialize)}function L(j){this._childLevel=(j._childLevel|0)+1,this.bindings=b,T&&(this.serializers=T,this._serialize=I),t&&(this._logEvent=Wu([].concat(j._logEvent.bindings,b)))}L.prototype=this;let R=new L(this);return Zm(this,R),R.child=function(...j){return g.call(this,d,...j)},R.level=k.level||this.level,d.onChild(R),R}return l}function K5(e){let t=e.customLevels||{},r=Object.assign({},zr.levels.values,t),s=Object.assign({},zr.levels.labels,G5(t));return{values:r,labels:s}}function G5(e){let t={};return Object.keys(e).forEach(function(r){t[e[r]]=r}),t}zr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},zr.stdSerializers=M5,zr.stdTimeFunctions=Object.assign({},{nullTime:Xm,epochTime:Jm,unixTime:ex,isoTime:tx});function W5(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[Gu];for(;r.parent;)r=r.parent,r.logger.bindings&&t.push(r.logger.bindings);return t.reverse()}function Ws(e,t,r,s){if(Object.defineProperty(e,s,{value:ws(e.level,r)>ws(s,r)?Un:r[Yu][s],writable:!0,enumerable:!0,configurable:!0}),e[s]===Un){if(!t.transmit)return;let i=t.transmit.level||e.level,o=ws(i,r);if(ws(s,r)<o)return}e[s]=Y5(e,t,r,s);let n=W5(e);n.length!==0&&(e[s]=Z5(n,e[s]))}function Z5(e,t){return function(){return t.apply(this,[...e,...arguments])}}function Y5(e,t,r,s){return function(n){return function(){let i=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Ui?Ui:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];var l=!1;if(t.serialize&&(Xu(o,this._serialize,this.serializers,this._stdErrSerialize),l=!0),t.asObject||t.formatters?n.call(a,...X5(this,s,o,i,t)):n.apply(a,o),t.transmit){let u=t.transmit.level||e._level,h=ws(u,r),p=ws(s,r);if(p<h)return;J5(this,{ts:i,methodLevel:s,methodValue:p,transmitLevel:u,transmitValue:r.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:ws(e._level,r)},o,l)}}}(e[Yu][s])}function X5(e,t,r,s,n){let{level:i,log:o=h=>h}=n.formatters||{},a=r.slice(),c=a[0],l={},u=(e._childLevel|0)+1;if(u<1&&(u=1),s&&(l.time=s),i){let h=i(t,e.levels.values[t]);Object.assign(l,h)}else l.level=e.levels.values[t];if(n.asObjectBindingsOnly){if(c!==null&&typeof c=="object")for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());return[o(l),...a]}else{if(c!==null&&typeof c=="object"){for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());c=a.length?Wm(a.shift(),a):void 0}else typeof c=="string"&&(c=Wm(a.shift(),a));return c!==void 0&&(l[n.messageKey]=c),[o(l)]}}function Xu(e,t,r,s){for(let n in e)if(s&&e[n]instanceof Error)e[n]=zr.stdSerializers.err(e[n]);else if(typeof e[n]=="object"&&!Array.isArray(e[n])&&t)for(let i in e[n])t.indexOf(i)>-1&&i in r&&(e[n][i]=r[i](e[n][i]))}function J5(e,t,r,s=!1){let n=t.send,i=t.ts,o=t.methodLevel,a=t.methodValue,c=t.val,l=e._logEvent.bindings;s||Xu(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter(function(u){return l.indexOf(u)===-1}),e._logEvent.level.label=o,e._logEvent.level.value=a,n(o,e._logEvent,c),e._logEvent=Wu(l)}function Wu(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function Ym(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)t[r]===void 0&&(t[r]=e[r]);return t}function Q5(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?Xm:Jm}function ba(){return{}}function Ku(e){return e}function Un(){}function Xm(){return!1}function Jm(){return Date.now()}function ex(){return Math.round(Date.now()/1e3)}function tx(){return new Date(Date.now()).toISOString()}function rx(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}Zu.exports.default=zr;var lP=Zu.exports.pino=zr;var sx="custom_context",uP=1e3*1024;function Qm(e,t=sx){return e[t]||""}var oe=xs($a(),1);var s0="wc",n0=2,i0="client",hh=`${s0}@${n0}:${i0}:`,Ju={name:i0,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"};var e0="WALLETCONNECT_DEEPLINK_CHOICE";var nx="proposal";var t0="Proposal expired",ix="session",$n=oe.SEVEN_DAYS,ox="engine",Me={wc_sessionPropose:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1104},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1106},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1112},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1114},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:oe.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:oe.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1119}}},Qu={min:oe.FIVE_MINUTES,max:oe.SEVEN_DAYS},Er={idle:"IDLE",active:"ACTIVE"},ax={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},cx="request",lx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],ux="wc";var hx="auth",px="authKeys",fx="pairingTopics",dx="requests",xa=`${ux}@${1.5}:${hx}:`,va=`${xa}:PUB_KEY`,gx=Object.defineProperty,mx=Object.defineProperties,yx=Object.getOwnPropertyDescriptors,r0=Object.getOwnPropertySymbols,wx=Object.prototype.hasOwnProperty,bx=Object.prototype.propertyIsEnumerable,th=(e,t,r)=>t in e?gx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,de=(e,t)=>{for(var r in t||(t={}))wx.call(t,r)&&th(e,r,t[r]);if(r0)for(var r of r0(t))bx.call(t,r)&&th(e,r,t[r]);return e},ze=(e,t)=>mx(e,yx(t)),F=(e,t,r)=>th(e,typeof t!="symbol"?t+"":t,r),rh=class extends po{constructor(t){super(t),F(this,"name",ox),F(this,"events",new Cs),F(this,"initialized",!1),F(this,"requestQueue",{state:Er.idle,queue:[]}),F(this,"sessionRequestQueue",{state:Er.idle,queue:[]}),F(this,"emittedSessionRequests",new Go({limit:500})),F(this,"requestQueueDelay",oe.ONE_SECOND),F(this,"expectedPairingMethodMap",new Map),F(this,"recentlyDeletedMap",new Map),F(this,"recentlyDeletedLimit",200),F(this,"relayMessageCache",[]),F(this,"pendingSessions",new Map),F(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Me)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,oe.toMiliseconds)(this.requestQueueDelay)))}),F(this,"connect",async r=>{var s;this.isInitialized(),await this.confirmOnlineStateOrThrow();let n=ze(de({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n),n.optionalNamespaces=Dg(n.requiredNamespaces,n.optionalNamespaces),n.requiredNamespaces={};let{pairingTopic:i,requiredNamespaces:o,optionalNamespaces:a,sessionProperties:c,scopedProperties:l,relays:u,authentication:h,walletPay:p}=n,f=((s=h?.[0])==null?void 0:s.ttl)||Me.wc_sessionPropose.req.ttl||oe.FIVE_MINUTES;this.validateRequestExpiry(f);let g=i,d,b=!1;try{if(g){let N=this.client.core.pairing.pairings.get(g);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),b=N.active}}catch(N){throw this.client.logger.error(`connect() -> pairing.get(${g}) failed`),N}if(!g||!b){let{topic:N,uri:M}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});g=N,d=M}if(!g){let{message:N}=G("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(N)}let k=await this.client.core.crypto.generateKeyPair(),q=Ie(f),T=de(ze(de(de({requiredNamespaces:o,optionalNamespaces:a,relays:u??[{protocol:Vu}],proposer:{publicKey:k,metadata:this.client.metadata},expiryTimestamp:q,pairingTopic:g},c&&{sessionProperties:c}),l&&{scopedProperties:l}),{id:Ir()}),(h||p)&&{requests:{authentication:h?.map(N=>{let{domain:M,chains:V,nonce:B,uri:E,exp:_,nbf:v,type:x,statement:A,requestId:U,resources:C,signatureTypes:O}=N;return{domain:M,chains:V,nonce:B,type:x??"caip122",aud:E,version:"1",iat:new Date().toISOString(),exp:_,nbf:v,statement:A,requestId:U,resources:C,signatureTypes:O}}),walletPay:p}}),I=fe("session_connect",T.id),{reject:L,resolve:R,done:j}=Fr(f,t0),H=({id:N})=>{N===T.id&&(this.client.events.off("proposal_expire",H),this.pendingSessions.delete(T.id),this.events.emit(I,{error:{message:t0,code:0}}))};return this.client.events.on("proposal_expire",H),this.events.once(I,({error:N,session:M})=>{this.client.events.off("proposal_expire",H),N?L(N):M&&R(M)}),await this.setProposal(T.id,T),await this.sendProposeSession({proposal:T,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:T.id}}}).catch(N=>{throw this.deleteProposal(T.id),N}),{uri:d,approval:j}}),F(this,"pair",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(r)}catch(s){throw this.client.logger.error("pair() failed"),s}}),F(this,"approve",async r=>{var s,n,i;let o=this.client.core.eventClient.createEvent({properties:{topic:(s=r?.id)==null?void 0:s.toString(),trace:[Kt.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(M){throw o.setError(ms.no_internet_connection),M}try{await this.isValidProposalId(r?.id)}catch(M){throw this.client.logger.error(`approve() -> proposal.get(${r?.id}) failed`),o.setError(ms.proposal_not_found),M}try{await this.isValidApprove(r)}catch(M){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(ms.session_approve_namespace_validation_failure),M}let{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:p,proposalRequestsResponses:f}=r,g=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});let{pairingTopic:d,proposer:b,requiredNamespaces:k,optionalNamespaces:q}=g,T=(n=this.client.core.eventClient)==null?void 0:n.getEvent({topic:d});T||(T=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:Kt.session_approve_started,properties:{topic:d,trace:[Kt.session_approve_started,Kt.session_namespaces_validation_success]}}));let I=await this.client.core.crypto.generateKeyPair(),L=b.publicKey,R=await this.client.core.crypto.generateSharedKey(I,L),j=ze(de(de(de({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:I,metadata:this.client.metadata},expiry:Ie($n)},u&&{sessionProperties:u}),h&&{scopedProperties:h}),p&&{sessionConfig:p}),{proposalRequestsResponses:f}),H=Ee.relay;T.addTrace(Kt.subscribing_session_topic);try{await this.client.core.relayer.subscribe(R,{transportType:H,internal:{skipSubscribe:!0}})}catch(M){throw T.setError(ms.subscribe_session_topic_failure),M}T.addTrace(Kt.subscribe_session_topic_success);let N=ze(de({},j),{topic:R,requiredNamespaces:k,optionalNamespaces:q,pairingTopic:d,acknowledged:!1,self:j.controller,peer:{publicKey:b.publicKey,metadata:b.metadata},controller:I,transportType:Ee.relay,authentication:f?.authentication,walletPayResult:f?.walletPay});await this.client.session.set(R,N),T.addTrace(Kt.store_session);try{await this.sendApproveSession({sessionTopic:R,proposal:g,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:I},sessionSettleRequest:j,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:de({correlationId:a},this.getTVFApproveParams(N))}}),T.addTrace(Kt.session_approve_publish_success)}catch(M){throw this.client.logger.error(M),this.client.session.delete(R,be("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(R),M}return this.client.core.eventClient.deleteEvent({eventId:T.eventId}),await this.client.core.pairing.updateMetadata({topic:d,metadata:b.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:d}),await this.setExpiry(R,Ie($n)),{topic:R,acknowledged:()=>Promise.resolve(this.client.session.get(R))}}),F(this,"reject",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(r)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}let{id:s,reason:n}=r,i;try{i=this.client.proposal.get(s).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${s}) failed`),o}i&&await this.sendError({id:s,topic:i,error:n,rpcOpts:Me.wc_sessionPropose.reject}),await this.deleteProposal(s)}),F(this,"update",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(r)}catch(h){throw this.client.logger.error("update() -> isValidUpdate() failed"),h}let{topic:s,namespaces:n}=r,{done:i,resolve:o,reject:a}=Fr(oe.FIVE_MINUTES,"Session update request expired without receiving any acknowledgement"),c=Ir(),l=_r().toString(),u=this.client.session.get(s).namespaces;return this.events.once(fe("session_update",c),({error:h})=>{h?a(h):o()}),await this.client.session.update(s,{namespaces:n}),await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:n},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(h=>{this.client.logger.error(h),this.client.session.update(s,{namespaces:u}),a(h)}),{acknowledged:i}}),F(this,"extend",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(r)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}let{topic:s}=r,n=Ir(),{done:i,resolve:o,reject:a}=Fr(oe.FIVE_MINUTES,"Session extend request expired without receiving any acknowledgement");return this.events.once(fe("session_extend",n),({error:c})=>{c?a(c):o()}),await this.setExpiry(s,Ie($n)),this.sendRequest({topic:s,method:"wc_sessionExtend",params:{},clientRpcId:n,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),F(this,"request",async r=>{this.isInitialized();try{await this.isValidRequest(r)}catch(b){throw this.client.logger.error("request() -> isValidRequest() failed"),b}let{chainId:s,request:n,topic:i,expiry:o=Me.wc_sessionRequest.req.ttl}=r,a=this.client.session.get(i);a?.transportType===Ee.relay&&await this.confirmOnlineStateOrThrow();let c=Ir(),l=_r().toString(),{done:u,resolve:h,reject:p}=Fr(o,"Request expired. Please try again.");this.events.once(fe("session_request",c),({error:b,result:k})=>{b?p(b):h(k)});let f="wc_sessionRequest",g=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(g)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:{request:ze(de({},n),{expiryTimestamp:Ie(o)}),chainId:s},expiry:o,throwOnFailedPublish:!0,appLink:g}).catch(b=>p(b)),this.client.events.emit("session_request_sent",{topic:i,request:n,chainId:s,id:c}),await u();let d={request:ze(de({},n),{expiryTimestamp:Ie(o)}),chainId:s};return await Promise.all([new Promise(async b=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:d,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,d)}).catch(k=>p(k)),this.client.events.emit("session_request_sent",{topic:i,request:n,chainId:s,id:c}),b()}),new Promise(async b=>{var k;if(!((k=a.sessionConfig)!=null&&k.disableDeepLink)){let q=await Ad(this.client.core.storage,e0);await Td({id:c,topic:i,wcDeepLink:q})}b()}),u()]).then(b=>b[2])}),F(this,"respond",async r=>{var s,n;this.isInitialized();let i=this.client.core.eventClient.createEvent({properties:{topic:r?.topic||((n=(s=r?.response)==null?void 0:s.id)==null?void 0:n.toString()),trace:[Kt.session_request_response_started]}});try{await this.isValidRespond(r)}catch(h){throw i.addTrace(h?.message),i.setError(ms.session_request_response_validation_failure),h}i.addTrace(Kt.session_request_response_validation_success);let{topic:o,response:a}=r,{id:c}=a,l=this.client.session.get(o);l.transportType===Ee.relay&&await this.confirmOnlineStateOrThrow();let u=this.getAppLinkIfEnabled(l.peer.metadata,l.transportType);try{i.addTrace(Kt.session_request_response_publish_started),Zt(a)?await this.sendResult({id:c,topic:o,result:a.result,throwOnFailedPublish:!0,appLink:u}):jt(a)&&await this.sendError({id:c,topic:o,error:a.error,appLink:u}),this.cleanupAfterResponse(r)}catch(h){throw i.addTrace(h?.message),i.setError(ms.session_request_response_publish_failure),h}}),F(this,"ping",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(r)}catch(n){throw this.client.logger.error("ping() -> isValidPing() failed"),n}let{topic:s}=r;if(this.client.session.keys.includes(s)){let n=Ir(),i=_r().toString(),{done:o,resolve:a,reject:c}=Fr(oe.FIVE_MINUTES,"Ping request expired without receiving any acknowledgement");this.events.once(fe("session_ping",n),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:s,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:n,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(s)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:s}))}),F(this,"emit",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(r);let{topic:s,event:n,chainId:i}=r,o=_r().toString(),a=Ir();await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:n,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),F(this,"disconnect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(r);let{topic:s}=r;if(this.client.session.keys.includes(s))await this.sendRequest({topic:s,method:"wc_sessionDelete",params:be("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:s,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(s))await this.client.core.pairing.disconnect({topic:s});else{let{message:n}=G("MISMATCHED_TOPIC",`Session or pairing topic not found: ${s}`);throw new Error(n)}}),F(this,"find",r=>(this.isInitialized(),this.client.session.getAll().filter(s=>qg(s,r)))),F(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),F(this,"authenticate",async(r,s)=>{var n;this.isInitialized(),this.isValidAuthenticate(r);let i=s&&this.client.core.linkModeSupportedApps.includes(s)&&((n=this.client.metadata.redirect)==null?void 0:n.linkMode),o=i?Ee.link_mode:Ee.relay;o===Ee.relay&&await this.confirmOnlineStateOrThrow();let{chains:a,statement:c="",uri:l,domain:u,nonce:h,type:p,exp:f,nbf:g,methods:d=[],expiry:b}=r,k=[...r.resources||[]],{topic:q,uri:T}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:q,uri:T}});let I=await this.client.core.crypto.generateKeyPair(),L=An(I);if(await Promise.all([this.client.auth.authKeys.set(va,{responseTopic:L,publicKey:I}),this.client.auth.pairingTopics.set(L,{topic:L,pairingTopic:q})]),await this.client.core.relayer.subscribe(L,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${q}`),d.length>0){let{namespace:C}=sr(a[0]),O=Zd(C,"request",d);Si(k)&&(O=Yd(O,k.pop())),k.push(O)}let R=b&&b>Me.wc_sessionAuthenticate.req.ttl?b:Me.wc_sessionAuthenticate.req.ttl,j={authPayload:{type:p??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:h,iat:new Date().toISOString(),exp:f,nbf:g,resources:k},requester:{publicKey:I,metadata:this.client.metadata},expiryTimestamp:Ie(R)},H={eip155:{chains:a,methods:[...new Set(["personal_sign",...d])],events:["chainChanged","accountsChanged"]}},N={requiredNamespaces:{},optionalNamespaces:H,relays:[{protocol:"irn"}],pairingTopic:q,proposer:{publicKey:I,metadata:this.client.metadata},expiryTimestamp:Ie(Me.wc_sessionPropose.req.ttl),id:Ir()},{done:M,resolve:V,reject:B}=Fr(R,"Request expired"),E=Ir(),_=fe("session_connect",N.id),v=fe("session_request",E),x=async({error:C,session:O})=>{this.events.off(v,A),C?B(C):O&&V({session:O})},A=async C=>{var O,z,K;if(await this.deletePendingAuthRequest(E,{message:"fulfilled",code:0}),C.error){let ne=be("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return C.error.code===ne.code?void 0:(this.events.off(_,x),B(C.error.message))}await this.deleteProposal(N.id),this.events.off(_,x);let{cacaos:se,responder:X}=C.result,Z=[],ie=[];for(let ne of se){await Ml({cacao:ne,projectId:this.client.core.projectId})||(this.client.logger.error(ne,"Signature verification failed"),B(be("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:me}=ne,rt=Si(me.resources),ct=[ca(me.iss)],st=Ei(me.iss);if(rt){let Ut=Hl(rt),Kr=Vl(rt);Z.push(...Ut),ct.push(...Kr)}for(let Ut of ct)ie.push(`${Ut}:${st}`)}let re=await this.client.core.crypto.generateSharedKey(I,X.publicKey),ge;Z.length>0&&(ge={topic:re,acknowledged:!0,self:{publicKey:I,metadata:this.client.metadata},peer:X,controller:X.publicKey,expiry:Ie($n),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:q,namespaces:su([...new Set(Z)],[...new Set(ie)]),transportType:o},await this.client.core.relayer.subscribe(re,{transportType:o}),await this.client.session.set(re,ge),q&&await this.client.core.pairing.updateMetadata({topic:q,metadata:X.metadata}),ge=this.client.session.get(re)),(O=this.client.metadata.redirect)!=null&&O.linkMode&&(z=X.metadata.redirect)!=null&&z.linkMode&&(K=X.metadata.redirect)!=null&&K.universal&&s&&(this.client.core.addLinkModeSupportedApp(X.metadata.redirect.universal),this.client.session.update(re,{transportType:Ee.link_mode})),V({auths:se,session:ge})};this.events.once(_,x),this.events.once(v,A);let U;try{if(i){let C=Ct("wc_sessionAuthenticate",j,E);this.client.core.history.set(q,C);let O=await this.client.core.crypto.encode("",C,{type:Tn,encoding:Mr});U=Ti(s,q,O)}else await Promise.all([this.sendRequest({topic:q,method:"wc_sessionAuthenticate",params:j,expiry:r.expiry,throwOnFailedPublish:!0,clientRpcId:E}),this.sendRequest({topic:q,method:"wc_sessionPropose",params:N,expiry:Me.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:N.id})])}catch(C){throw this.events.off(_,x),this.events.off(v,A),C}return await this.setProposal(N.id,N),await this.setAuthRequest(E,{request:ze(de({},j),{verifyContext:{}}),pairingTopic:q,transportType:o}),{uri:U??T,response:M}}),F(this,"approveSessionAuthenticate",async r=>{let{id:s,auths:n}=r,i=this.client.core.eventClient.createEvent({properties:{topic:s.toString(),trace:[ys.authenticated_session_approve_started]}});try{this.isInitialized()}catch(b){throw i.setError(Ln.no_internet_connection),b}let o=this.getPendingAuthRequest(s);if(!o)throw i.setError(Ln.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${s}`);let a=o.transportType||Ee.relay;a===Ee.relay&&await this.confirmOnlineStateOrThrow();let c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=An(c),h={type:ir,receiverPublicKey:c,senderPublicKey:l},p=[],f=[];for(let b of n){if(!await Ml({cacao:b,projectId:this.client.core.projectId})){i.setError(Ln.invalid_cacao);let L=be("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:s,topic:u,error:L,encodeOpts:h}),new Error(L.message)}i.addTrace(ys.cacaos_verified);let{p:k}=b,q=Si(k.resources),T=[ca(k.iss)],I=Ei(k.iss);if(q){let L=Hl(q),R=Vl(q);p.push(...L),T.push(...R)}for(let L of T)f.push(`${L}:${I}`)}let g=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(ys.create_authenticated_session_topic);let d;if(p?.length>0){d={topic:g,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:Ie($n),authentication:n,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:su([...new Set(p)],[...new Set(f)]),transportType:a},i.addTrace(ys.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(g,{transportType:a})}catch(b){throw i.setError(Ln.subscribe_authenticated_session_topic_failure),b}i.addTrace(ys.subscribe_authenticated_session_topic_success),await this.client.session.set(g,d),i.addTrace(ys.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(ys.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:s,result:{cacaos:n,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(b){throw i.setError(Ln.authenticated_session_approve_publish_failure),b}return await this.client.auth.requests.delete(s,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:d}}),F(this,"rejectSessionAuthenticate",async r=>{this.isInitialized();let{id:s,reason:n}=r,i=this.getPendingAuthRequest(s);if(!i)throw new Error(`Could not find pending auth request with id ${s}`);i.transportType===Ee.relay&&await this.confirmOnlineStateOrThrow();let o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=An(o),l={type:ir,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:s,topic:c,error:n,encodeOpts:l,rpcOpts:Me.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(s,{message:"rejected",code:0}),await this.deleteProposal(s)}),F(this,"formatAuthMessage",r=>{this.isInitialized();let{request:s,iss:n}=r;return zl(s,n)}),F(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{let r=this.relayMessageCache.shift();r&&await this.onRelayMessage(r)}catch(r){this.client.logger.error(r)}},50)}),F(this,"cleanupDuplicatePairings",async r=>{if(r.pairingTopic)try{let s=this.client.core.pairing.pairings.get(r.pairingTopic),n=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===r.peer.metadata.url&&i.topic&&i.topic!==s.topic});if(n.length===0)return;this.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),await Promise.all(n.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}}),F(this,"deleteSession",async r=>{var s;let{topic:n,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=r,{self:c}=this.client.session.get(n);await this.client.core.relayer.unsubscribe(n),await this.client.session.delete(n,be("USER_DISCONNECTED")),this.addToRecentlyDeleted(n,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(n)&&await this.client.core.crypto.deleteSymKey(n),i||this.client.core.expirer.del(n),this.client.core.storage.removeItem(e0).catch(l=>this.client.logger.warn(l)),n===((s=this.sessionRequestQueue.queue[0])==null?void 0:s.topic)&&(this.sessionRequestQueue.state=Er.idle),await Promise.all(this.getPendingSessionRequests().filter(l=>l.topic===n).map(l=>this.deletePendingSessionRequest(l.id,be("USER_DISCONNECTED")))),o&&this.client.events.emit("session_delete",{id:a,topic:n})}),F(this,"deleteProposal",async(r,s)=>{if(s)try{let n=this.client.proposal.get(r);this.client.core.eventClient.getEvent({topic:n.pairingTopic})?.setError(ms.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(r,be("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"proposal")}),F(this,"deletePendingSessionRequest",async(r,s,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),n?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==r),n&&(this.sessionRequestQueue.state=Er.idle,this.client.events.emit("session_request_expire",{id:r}))}),F(this,"deletePendingAuthRequest",async(r,s,n=!1)=>{await Promise.all([this.client.auth.requests.delete(r,s),n?Promise.resolve():this.client.core.expirer.del(r)])}),F(this,"setExpiry",async(r,s)=>{this.client.session.keys.includes(r)&&(this.client.core.expirer.set(r,s),await this.client.session.update(r,{expiry:s}))}),F(this,"setProposal",async(r,s)=>{this.client.core.expirer.set(r,Ie(Me.wc_sessionPropose.req.ttl)),await this.client.proposal.set(r,s)}),F(this,"setAuthRequest",async(r,s)=>{let{request:n,pairingTopic:i,transportType:o=Ee.relay}=s;this.client.core.expirer.set(r,n.expiryTimestamp),await this.client.auth.requests.set(r,{authPayload:n.authPayload,requester:n.requester,expiryTimestamp:n.expiryTimestamp,id:r,pairingTopic:i,verifyContext:n.verifyContext,transportType:o})}),F(this,"setPendingSessionRequest",async r=>{let{id:s,topic:n,params:i,verifyContext:o}=r,a=i.request.expiryTimestamp||Ie(Me.wc_sessionRequest.req.ttl);this.client.core.expirer.set(s,a),await this.client.pendingRequest.set(s,{id:s,topic:n,params:i,verifyContext:o})}),F(this,"sendRequest",async r=>{let{topic:s,method:n,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:h,publishOpts:p={}}=r,f=Ct(n,i,c),g,d=!!u;try{let q=d?Mr:Xe;g=await this.client.core.crypto.encode(s,f,{encoding:q})}catch(q){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${s} failed`),q}let b;if(lx.includes(n)){let q=vt(JSON.stringify(f)),T=vt(g);b=await this.client.core.verify.register({id:T,decryptedId:q})}let k=de(de({},Me[n].req),p);if(k.attestation=b,o&&(k.ttl=o),a&&(k.id=a),this.client.core.history.set(s,f),d){let q=Ti(u,s,g);await globalThis.Linking.openURL(q,this.client.name)}else k.tvf=ze(de({},h),{correlationId:f.id}),l?(k.internal=ze(de({},k.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,g,k)):this.client.core.relayer.publish(s,g,k).catch(q=>this.client.logger.error(q));return f.id}),F(this,"sendProposeSession",async r=>{let{proposal:s,publishOpts:n}=r,i=Ct("wc_sessionPropose",s,s.id);this.client.core.history.set(s.pairingTopic,i);let o=await this.client.core.crypto.encode(s.pairingTopic,i,{encoding:Xe}),a=vt(JSON.stringify(i)),c=vt(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:s.pairingTopic,sessionProposal:o},opts:ze(de({},n),{publishMethod:"wc_proposeSession",attestation:l})})}),F(this,"sendApproveSession",async r=>{let{sessionTopic:s,pairingProposalResponse:n,proposal:i,sessionSettleRequest:o,publishOpts:a}=r,c=Wr(i.id,n),l=await this.client.core.crypto.encode(i.pairingTopic,c,{encoding:Xe}),u=Ct("wc_sessionSettle",o,a?.id),h=await this.client.core.crypto.encode(s,u,{encoding:Xe});this.client.core.history.set(s,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:s,pairingTopic:i.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:h},opts:ze(de({},a),{publishMethod:"wc_approveSession"})})}),F(this,"sendResult",async r=>{let{id:s,topic:n,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=r,l=Wr(s,i),u,h=c&&typeof globalThis?.Linking<"u";try{let g=h?Mr:Xe;u=await this.client.core.crypto.encode(n,l,ze(de({},a||{}),{encoding:g}))}catch(g){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${n} failed`),g}let p,f;try{p=await this.client.core.history.get(n,s);let g=p.request;try{f=this.getTVFParams(s,g.params,i)}catch(d){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${d?.message}`)}}catch(g){throw this.client.logger.error(`sendResult() -> history.get(${n}, ${s}) failed`),g}if(h){let g=Ti(c,n,u);await globalThis.Linking.openURL(g,this.client.name)}else{let g=p.request.method,d=Me[g].res;d.tvf=ze(de({},f),{correlationId:s}),o?(d.internal=ze(de({},d.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,u,d)):this.client.core.relayer.publish(n,u,d).catch(b=>this.client.logger.error(b))}await this.client.core.history.resolve(l)}),F(this,"sendError",async r=>{let{id:s,topic:n,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=r,l=Hi(s,i),u,h=c&&typeof globalThis?.Linking<"u";try{let f=h?Mr:Xe;u=await this.client.core.crypto.encode(n,l,ze(de({},o||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),f}let p;try{p=await this.client.core.history.get(n,s)}catch(f){throw this.client.logger.error(`sendError() -> history.get(${n}, ${s}) failed`),f}if(h){let f=Ti(c,n,u);await globalThis.Linking.openURL(f,this.client.name)}else{let f=p.request.method,g=a||Me[f].res;this.client.core.relayer.publish(n,u,g)}await this.client.core.history.resolve(l)}),F(this,"cleanup",async()=>{let r=[],s=[];this.client.session.getAll().forEach(n=>{let i=!1;Ot(n.expiry)&&(i=!0),this.client.core.crypto.keychain.has(n.topic)||(i=!0),i&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{Ot(n.expiryTimestamp)&&s.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession({topic:n})),...s.map(n=>this.deleteProposal(n))])}),F(this,"onProviderMessageEvent",async r=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(r):await this.onRelayMessage(r)}),F(this,"onRelayEventRequest",async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()}),F(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Er.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Er.active;let r=this.requestQueue.queue.shift();if(r)try{await this.processRequest(r)}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=Er.idle}),F(this,"processRequest",async r=>{let{topic:s,payload:n,attestation:i,transportType:o,encryptedId:a}=r,c=n.method;if(!this.shouldIgnorePairingRequest({topic:s,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:s,payload:n,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(s,n);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(s,n);case"wc_sessionExtend":return await this.onSessionExtendRequest(s,n);case"wc_sessionPing":return await this.onSessionPingRequest(s,n);case"wc_sessionDelete":return await this.onSessionDeleteRequest(s,n);case"wc_sessionRequest":return await this.onSessionRequest({topic:s,payload:n,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(s,n);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:s,payload:n,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),F(this,"onRelayEventResponse",async r=>{let{topic:s,payload:n,transportType:i}=r,o=(await this.client.core.history.get(s,n.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(s,n,i);case"wc_sessionSettle":return this.onSessionSettleResponse(s,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,n);case"wc_sessionExtend":return this.onSessionExtendResponse(s,n);case"wc_sessionPing":return this.onSessionPingResponse(s,n);case"wc_sessionRequest":return this.onSessionRequestResponse(s,n);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(s,n);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),F(this,"onRelayEventUnknownPayload",r=>{let{topic:s}=r,{message:n}=G("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(n)}),F(this,"shouldIgnorePairingRequest",r=>{let{topic:s,requestMethod:n}=r,i=this.expectedPairingMethodMap.get(s);return!i||i.includes(n)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),F(this,"onSessionProposeRequest",async r=>{let{topic:s,payload:n,attestation:i,encryptedId:o}=r,{params:a,id:c}=n;try{let l=this.client.core.eventClient.getEvent({topic:s});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l?.setError(br.proposal_listener_not_found)),this.isValidConnect(de({},n.params));let u=a.expiryTimestamp||Ie(Me.wc_sessionPropose.req.ttl),h=de({id:c,pairingTopic:s,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,h);let p=await this.getVerifyContext({attestationId:i,hash:vt(JSON.stringify(n)),encryptedId:o,metadata:h.proposer.metadata});l?.addTrace(cr.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:h,verifyContext:p})}catch(l){await this.sendError({id:c,topic:s,error:l,rpcOpts:Me.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),F(this,"onSessionProposeResponse",async(r,s,n)=>{let{id:i}=s;if(Zt(s)){let{result:o}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});let a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});let c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});let l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});let u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:r,proposalId:i,publicKey:c});let h=await this.client.core.relayer.subscribe(u,{transportType:n});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:h}),await this.client.core.pairing.activate({topic:r})}else if(jt(s)){await this.deleteProposal(i);let o=fe("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:s.error})}}),F(this,"onSessionSettleRequest",async(r,s)=>{let{id:n,params:i}=s;try{this.isValidSessionSettleRequest(i);let{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:p,proposalRequestsResponses:f}=s.params,g=[...this.pendingSessions.values()].find(k=>k.sessionTopic===r);if(!g)return this.client.logger.error(`Pending session not found for topic ${r}`);let d=this.client.proposal.get(g.proposalId),b=ze(de(de(de({topic:r,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:g.pairingTopic,requiredNamespaces:d.requiredNamespaces,optionalNamespaces:d.optionalNamespaces,controller:a.publicKey,self:{publicKey:g.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),h&&{scopedProperties:h}),p&&{sessionConfig:p}),{transportType:Ee.relay,authentication:f?.authentication,walletPayResult:f?.walletPay});await this.client.session.set(b.topic,b),await this.setExpiry(b.topic,b.expiry),await this.client.core.pairing.updateMetadata({topic:g.pairingTopic,metadata:b.peer.metadata}),this.pendingSessions.delete(g.proposalId),this.deleteProposal(g.proposalId,!1),this.cleanupDuplicatePairings(b),await this.sendResult({id:s.id,topic:r,throwOnFailedPublish:!0,result:!0}),this.client.events.emit("session_connect",{session:b}),this.events.emit(fe("session_connect",g.proposalId),{session:b})}catch(o){await this.sendError({id:n,topic:r,error:o}),this.client.logger.error(o)}}),F(this,"onSessionSettleResponse",async(r,s)=>{let{id:n}=s;Zt(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(fe("session_approve",n),{})):jt(s)&&(await this.client.session.delete(r,be("USER_DISCONNECTED")),this.events.emit(fe("session_approve",n),{error:s.error}))}),F(this,"onSessionUpdateRequest",async(r,s)=>{let{params:n,id:i}=s;try{let o=`${r}_session_update`,a=fs.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:r,error:be("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(de({topic:r},n));try{fs.set(o,i),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult({id:i,topic:r,result:!0})}catch(c){throw fs.delete(o),c}this.client.events.emit("session_update",{id:i,topic:r,params:n})}catch(o){await this.sendError({id:i,topic:r,error:o}),this.client.logger.error(o)}}),F(this,"isRequestOutOfSync",(r,s)=>s.toString().slice(0,-3)<r.toString().slice(0,-3)),F(this,"onSessionUpdateResponse",(r,s)=>{let{id:n}=s,i=fe("session_update",n);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Zt(s)?this.events.emit(fe("session_update",n),{}):jt(s)&&this.events.emit(fe("session_update",n),{error:s.error})}),F(this,"onSessionExtendRequest",async(r,s)=>{let{id:n}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Ie($n)),await this.sendResult({id:n,topic:r,result:!0}),this.client.events.emit("session_extend",{id:n,topic:r})}catch(i){await this.sendError({id:n,topic:r,error:i}),this.client.logger.error(i)}}),F(this,"onSessionExtendResponse",(r,s)=>{let{id:n}=s,i=fe("session_extend",n);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Zt(s)?this.events.emit(fe("session_extend",n),{}):jt(s)&&this.events.emit(fe("session_extend",n),{error:s.error})}),F(this,"onSessionPingRequest",async(r,s)=>{let{id:n}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:n,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:n,topic:r})}catch(i){await this.sendError({id:n,topic:r,error:i}),this.client.logger.error(i)}}),F(this,"onSessionPingResponse",(r,s)=>{let{id:n}=s,i=fe("session_ping",n);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Zt(s)?this.events.emit(fe("session_ping",n),{}):jt(s)&&this.events.emit(fe("session_ping",n),{error:s.error})},500)}),F(this,"onSessionDeleteRequest",async(r,s)=>{let{id:n}=s;try{await this.isValidDisconnect({topic:r,reason:s.params}),this.cleanupPendingSentRequestsForTopic({topic:r,error:be("USER_DISCONNECTED")}),await this.deleteSession({topic:r,id:n})}catch(i){this.client.logger.error(i)}}),F(this,"onSessionRequest",async r=>{var s,n,i;let{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=r,{id:h,params:p}=a;try{await this.isValidRequest(de({topic:o},p));let f=this.client.session.get(o),g=await this.getVerifyContext({attestationId:c,hash:vt(JSON.stringify(Ct("wc_sessionRequest",p,h))),encryptedId:l,metadata:f.peer.metadata,transportType:u}),d={id:h,topic:o,params:p,verifyContext:g};await this.setPendingSessionRequest(d),u===Ee.link_mode&&(s=f.peer.metadata.redirect)!=null&&s.universal&&this.client.core.addLinkModeSupportedApp((n=f.peer.metadata.redirect)==null?void 0:n.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(d):(this.addSessionRequestToSessionRequestQueue(d),this.processSessionRequestQueue())}catch(f){await this.sendError({id:h,topic:o,error:f}),this.client.logger.error(f)}}),F(this,"onSessionRequestResponse",(r,s)=>{let{id:n}=s,i=fe("session_request",n);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Zt(s)?this.events.emit(fe("session_request",n),{result:s.result}):jt(s)&&this.events.emit(fe("session_request",n),{error:s.error})}),F(this,"onSessionEventRequest",async(r,s)=>{let{id:n,params:i}=s;try{let o=`${r}_session_event_${i.event.name}`,a=fs.get(o);if(a&&this.isRequestOutOfSync(a,n)){this.client.logger.info(`Discarding out of sync request - ${n}`);return}this.isValidEmit(de({topic:r},i)),this.client.events.emit("session_event",{id:n,topic:r,params:i}),fs.set(o,n)}catch(o){await this.sendError({id:n,topic:r,error:o}),this.client.logger.error(o)}}),F(this,"onSessionAuthenticateResponse",(r,s)=>{let{id:n}=s;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:r,payload:s}),Zt(s)?this.events.emit(fe("session_request",n),{result:s.result}):jt(s)&&this.events.emit(fe("session_request",n),{error:s.error})}),F(this,"onSessionAuthenticateRequest",async r=>{var s;let{topic:n,payload:i,attestation:o,encryptedId:a,transportType:c}=r;try{let{requester:l,authPayload:u,expiryTimestamp:h}=i.params,p=await this.getVerifyContext({attestationId:o,hash:vt(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),f={requester:l,pairingTopic:n,id:i.id,authPayload:u,verifyContext:p,expiryTimestamp:h};await this.setAuthRequest(i.id,{request:f,pairingTopic:n,transportType:c}),c===Ee.link_mode&&(s=l.metadata.redirect)!=null&&s.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:n,params:i.params,id:i.id,verifyContext:p})}catch(l){this.client.logger.error(l);let u=i.params.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),p=this.getAppLinkIfEnabled(i.params.requester.metadata,c),f={type:ir,receiverPublicKey:u,senderPublicKey:h};await this.sendError({id:i.id,topic:n,error:l,encodeOpts:f,rpcOpts:Me.wc_sessionAuthenticate.autoReject,appLink:p})}}),F(this,"addSessionRequestToSessionRequestQueue",r=>{this.sessionRequestQueue.queue.push(r)}),F(this,"cleanupAfterResponse",r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Er.idle,this.processSessionRequestQueue()},(0,oe.toMiliseconds)(this.requestQueueDelay))}),F(this,"cleanupPendingSentRequestsForTopic",({topic:r,error:s})=>{let n=this.client.core.history.pending;n.length>0&&n.filter(i=>i.topic===r&&i.request.method==="wc_sessionRequest").forEach(i=>{this.events.emit(fe("session_request",i.request.id),{error:s})})}),F(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Er.active){this.client.logger.info("session request queue is already active.");return}let r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(r)}catch(s){this.client.logger.error(s)}}),F(this,"emitSessionRequest",r=>{if(this.emittedSessionRequests.has(r.id)){this.client.logger.warn({id:r.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${r.id}`);return}this.sessionRequestQueue.state=Er.active,this.emittedSessionRequests.add(r.id),this.client.events.emit("session_request",r)}),F(this,"onPairingCreated",r=>{if(r.methods&&this.expectedPairingMethodMap.set(r.topic,r.methods),r.active)return;let s=this.client.proposal.getAll().find(n=>n.pairingTopic===r.topic);s&&this.onSessionProposeRequest({topic:r.topic,payload:Ct("wc_sessionPropose",ze(de({},s),{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties,scopedProperties:s.scopedProperties}),s.id),attestation:s.attestation,encryptedId:s.encryptedId})}),F(this,"isValidConnect",async r=>{if(!Je(r)){let{message:l}=G("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(l)}let{pairingTopic:s,requiredNamespaces:n,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=r;if(Ae(s)||await this.isValidPairingTopic(s),!Gg(c,!0)){let{message:l}=G("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(n&&!Ae(n)&&zt(n)!==0){let l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(n,"requiredNamespaces")}if(i&&!Ae(i)&&zt(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),o&&!Ae(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!Ae(a)){this.validateSessionProps(a,"scopedProperties");let l=Object.keys(n||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),F(this,"validateNamespaces",(r,s)=>{let n=Kg(r,"connect()",s);if(n)throw new Error(n.message)}),F(this,"isValidApprove",async r=>{if(!Je(r))throw new Error(G("MISSING_OR_INVALID",`approve() params: ${r}`).message);let{id:s,namespaces:n,relayProtocol:i,sessionProperties:o,scopedProperties:a}=r;this.checkRecentlyDeleted(s),await this.isValidProposalId(s);let c=this.client.proposal.get(s),l=da(n,"approve()");if(l)throw new Error(l.message);let u=au(c.requiredNamespaces,n,"approve()");if(u)throw new Error(u.message);if(!Te(i,!0)){let{message:h}=G("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(h)}if(o&&!Ae(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!Ae(a)){this.validateSessionProps(a,"scopedProperties");let h=new Set(Object.keys(n));if(!Object.keys(a).every(p=>h.has(p.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(h).join(", ")}`)}}),F(this,"isValidReject",async r=>{if(!Je(r)){let{message:i}=G("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(i)}let{id:s,reason:n}=r;if(this.checkRecentlyDeleted(s),await this.isValidProposalId(s),!Zg(n)){let{message:i}=G("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(i)}}),F(this,"isValidSessionSettleRequest",r=>{if(!Je(r)){let{message:l}=G("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(l)}let{relay:s,controller:n,namespaces:i,expiry:o}=r;if(!iu(s)){let{message:l}=G("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}let a=Hg(n,"onSessionSettleRequest()");if(a)throw new Error(a.message);let c=da(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Ot(o)){let{message:l}=G("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),F(this,"isValidUpdate",async r=>{if(!Je(r)){let{message:c}=G("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(c)}let{topic:s,namespaces:n}=r;this.checkRecentlyDeleted(s),await this.isValidSessionTopic(s);let i=this.client.session.get(s),o=da(n,"update()");if(o)throw new Error(o.message);let a=au(i.requiredNamespaces,n,"update()");if(a)throw new Error(a.message)}),F(this,"isValidExtend",async r=>{if(!Je(r)){let{message:n}=G("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}let{topic:s}=r;this.checkRecentlyDeleted(s),await this.isValidSessionTopic(s)}),F(this,"isValidRequest",async r=>{if(!Je(r)){let{message:c}=G("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(c)}let{topic:s,request:n,chainId:i,expiry:o}=r;this.checkRecentlyDeleted(s),await this.isValidSessionTopic(s);let{namespaces:a}=this.client.session.get(s);if(!ou(a,i)){let{message:c}=G("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!Yg(n)){let{message:c}=G("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(c)}if(!Qg(a,i,n.method)){let{message:c}=G("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(c)}this.validateRequestExpiry(o)}),F(this,"isValidRespond",async r=>{var s;if(!Je(r)){let{message:a}=G("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(a)}let{topic:n,response:i}=r;try{await this.isValidSessionTopic(n)}catch(a){throw(s=r?.response)!=null&&s.id&&this.cleanupAfterResponse(r),a}if(!Xg(i)){let{message:a}=G("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(a)}let o=this.client.pendingRequest.get(i.id);if(o.topic!==n){let{message:a}=G("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${i.id}, expected topic: ${o.topic}, received topic: ${n}`);throw new Error(a)}}),F(this,"isValidPing",async r=>{if(!Je(r)){let{message:n}=G("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}let{topic:s}=r;await this.isValidSessionOrPairingTopic(s)}),F(this,"isValidEmit",async r=>{if(!Je(r)){let{message:a}=G("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}let{topic:s,event:n,chainId:i}=r;await this.isValidSessionTopic(s);let{namespaces:o}=this.client.session.get(s);if(!ou(o,i)){let{message:a}=G("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!Jg(n)){let{message:a}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(a)}if(!em(o,i,n.name)){let{message:a}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(a)}}),F(this,"isValidDisconnect",async r=>{if(!Je(r)){let{message:n}=G("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}let{topic:s}=r;await this.isValidSessionOrPairingTopic(s)}),F(this,"isValidAuthenticate",r=>{let{chains:s,uri:n,domain:i,nonce:o}=r;if(!Array.isArray(s)||s.length===0)throw new Error("chains is required and must be a non-empty array");if(!Te(n,!1))throw new Error("uri is required parameter");if(!Te(i,!1))throw new Error("domain is required parameter");if(!Te(o,!1))throw new Error("nonce is required parameter");if([...new Set(s.map(c=>sr(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:a}=sr(s[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),F(this,"getVerifyContext",async r=>{let{attestationId:s,hash:n,encryptedId:i,metadata:o,transportType:a}=r,c={verified:{verifyUrl:o.verifyUrl||Bn,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Ee.link_mode){let u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}let l=await this.client.core.verify.resolve({attestationId:s,hash:n,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),F(this,"validateSessionProps",(r,s)=>{Object.values(r).forEach((n,i)=>{if(n==null){let{message:o}=G("MISSING_OR_INVALID",`${s} must contain an existing value for each key. Received: ${n} for key ${Object.keys(r)[i]}`);throw new Error(o)}})}),F(this,"getPendingAuthRequest",r=>{let s=this.client.auth.requests.get(r);return typeof s=="object"?s:void 0}),F(this,"addToRecentlyDeleted",(r,s)=>{if(this.recentlyDeletedMap.set(r,s),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let n=0,i=this.recentlyDeletedLimit/2;for(let o of this.recentlyDeletedMap.keys()){if(n++>=i)break;this.recentlyDeletedMap.delete(o)}}}),F(this,"checkRecentlyDeleted",r=>{let s=this.recentlyDeletedMap.get(r);if(s){let{message:n}=G("MISSING_OR_INVALID",`Record was recently deleted - ${s}: ${r}`);throw new Error(n)}}),F(this,"isLinkModeEnabled",(r,s)=>{var n,i,o,a,c,l,u,h,p;return!r||s!==Ee.link_mode?!1:((i=(n=this.client.metadata)==null?void 0:n.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=r?.redirect)==null?void 0:u.universal)!==void 0&&((h=r?.redirect)==null?void 0:h.universal)!==""&&((p=r?.redirect)==null?void 0:p.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(r.redirect.universal)&&typeof globalThis?.Linking<"u"}),F(this,"getAppLinkIfEnabled",(r,s)=>{var n;return this.isLinkModeEnabled(r,s)?(n=r?.redirect)==null?void 0:n.universal:void 0}),F(this,"handleLinkModeMessage",({url:r})=>{if(!r||!r.includes("wc_ev")||!r.includes("topic"))return;let s=Ll(r,"topic")||"",n=decodeURIComponent(Ll(r,"wc_ev")||""),i=this.client.session.keys.includes(s);i&&this.client.session.update(s,{transportType:Ee.link_mode}),this.client.core.dispatchEnvelope({topic:s,message:n,sessionExists:i})}),F(this,"registerLinkModeListeners",async()=>{var r;if(vi()||qr()&&(r=this.client.metadata.redirect)!=null&&r.linkMode){let s=globalThis?.Linking;if(typeof s<"u"){s.addEventListener("url",this.handleLinkModeMessage,this.client.name);let n=await s.getInitialURL();n&&setTimeout(()=>{this.handleLinkModeMessage({url:n})},50)}}}),F(this,"getTVFApproveParams",r=>{try{let s=ru(r.namespaces),n=$g(r.namespaces),i=jg(r.namespaces),o=r.sessionProperties,a=r.scopedProperties;return{approvedChains:s,approvedMethods:n,approvedEvents:i,sessionProperties:o,scopedProperties:a}}catch(s){return this.client.logger.warn(s,"Error getting TVF approve params"),{}}}),F(this,"getTVFParams",(r,s,n)=>{var i,o,a;if(!((i=s.request)!=null&&i.method))return{};let c={correlationId:r,rpcMethods:[s.request.method],chainId:s.chainId};try{let l=this.extractTxHashesFromResult(s.request,n);c.txHashes=l,c.contractAddresses=this.isValidContractData(s.request.params)?[(a=(o=s.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn(l,"Error getting TVF params")}return c}),F(this,"isValidContractData",r=>{var s;if(!r)return!1;try{let n=r?.data||((s=r?.[0])==null?void 0:s.data);if(!n.startsWith("0x"))return!1;let i=n.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),F(this,"extractTxHashesFromResult",(r,s)=>{var n;try{if(!s)return[];let i=r.method,o=ax[i];if(i==="sui_signTransaction")return[Hd(s.transactionBytes)];if(i==="near_signTransaction")return[ql(s)];if(i==="near_signTransactions")return s.map(c=>ql(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(n=s.tx_json)==null?void 0:n.hash];if(i==="polkadot_signTransaction")return[nm({transaction:r.params.transactionPayload,signature:s.signature})];if(i==="algo_signTxn")return or(s)?s.map(c=>Fl(c)):[Fl(s)];if(i==="cosmos_signDirect")return[Vd(s)];if(i==="wallet_sendCalls")return Kd(s);if(typeof s=="string")return[s];let a=s[o.key];if(or(a))return i==="solana_signAllTransactions"?a.map(c=>zd(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn(i,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{let t=this.client.session.keys,r=this.client.core.relayer.messages.getWithoutAck(t);for(let[s,n]of Object.entries(r))for(let i of n)try{await this.onProviderMessageEvent({topic:s,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${s}, message: ${i}`)}}catch(t){this.client.logger.warn(t,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){let{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Pe.message,t=>{this.onProviderMessageEvent(t)})}async onRelayMessage(t){let{topic:r,message:s,attestation:n,transportType:i}=t,{publicKey:o}=this.client.auth.authKeys.keys.includes(va)?this.client.auth.authKeys.get(va):{responseTopic:void 0,publicKey:void 0};try{let a=await this.client.core.crypto.decode(r,s,{receiverPublicKey:o,encoding:i===Ee.link_mode?Mr:Xe});Zn(a)?(this.client.core.history.set(r,a),await this.onRelayEventRequest({topic:r,payload:a,attestation:n,transportType:i,encryptedId:vt(s)})):Yn(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a,transportType:i}),this.client.core.history.delete(r,a.id)):(this.client.logger.error(`onRelayMessage() -> unknown payload: ${JSON.stringify(a)}`),await this.onRelayEventUnknownPayload({topic:r,payload:a,transportType:i})),await this.client.core.relayer.messages.ack(r,s)}catch(a){this.client.logger.error(`onRelayMessage() -> failed to process an inbound message: ${s}`),this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Rt.expired,async t=>{let{topic:r,id:s}=sa(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,G("EXPIRED"),!0);if(s&&this.client.auth.requests.keys.includes(s))return await this.deletePendingAuthRequest(s,G("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(gs.create,t=>this.onPairingCreated(t)),this.client.core.pairing.events.on(gs.delete,t=>{this.addToRecentlyDeleted(t.topic,"pairing")})}isValidPairingTopic(t){if(!Te(t,!1)){let{message:r}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){let{message:r}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ot(this.client.core.pairing.pairings.get(t).expiry)){let{message:r}=G("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Te(t,!1)){let{message:r}=G("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(this.checkRecentlyDeleted(t),!this.client.session.keys.includes(t)){let{message:r}=G("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ot(this.client.session.get(t).expiry)){await this.deleteSession({topic:t});let{message:r}=G("EXPIRED",`session topic: ${t}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(t)){let{message:r}=G("MISSING_OR_INVALID",`session topic does not exist in keychain: ${t}`);throw await this.deleteSession({topic:t}),new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.checkRecentlyDeleted(t),this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Te(t,!1)){let{message:r}=G("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{let{message:r}=G("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!Wg(t)){let{message:r}=G("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){let{message:r}=G("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ot(this.client.proposal.get(t).expiryTimestamp)){await this.deleteProposal(t);let{message:r}=G("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}validateRequestExpiry(t){if(t&&!tm(t,Qu)){let{message:r}=G("MISSING_OR_INVALID",`request() expiry: ${t}. Expiry must be a number (in seconds) between ${Qu.min} and ${Qu.max}`);throw new Error(r)}}},sh=class extends xr{constructor(t,r){super(t,r,nx,hh),this.core=t,this.logger=r}},nh=class extends xr{constructor(t,r){super(t,r,ix,hh),this.core=t,this.logger=r}},ih=class extends xr{constructor(t,r){super(t,r,cx,hh,s=>s.id),this.core=t,this.logger=r}},oh=class extends xr{constructor(t,r){super(t,r,px,xa,()=>va),this.core=t,this.logger=r}},ah=class extends xr{constructor(t,r){super(t,r,fx,xa),this.core=t,this.logger=r}},ch=class extends xr{constructor(t,r){super(t,r,dx,xa,s=>s.id),this.core=t,this.logger=r}},vx=Object.defineProperty,xx=(e,t,r)=>t in e?vx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,eh=(e,t,r)=>xx(e,typeof t!="symbol"?t+"":t,r),lh=class{constructor(t,r){this.core=t,this.logger=r,eh(this,"authKeys"),eh(this,"pairingTopics"),eh(this,"requests"),this.authKeys=new oh(this.core,this.logger),this.pairingTopics=new ah(this.core,this.logger),this.requests=new ch(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}},Ex=Object.defineProperty,Sx=(e,t,r)=>t in e?Ex(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ce=(e,t,r)=>Sx(e,typeof t!="symbol"?t+"":t,r),uh=class e extends ho{constructor(t){super(t),ce(this,"protocol",s0),ce(this,"version",n0),ce(this,"name",Ju.name),ce(this,"metadata"),ce(this,"core"),ce(this,"logger"),ce(this,"events",new fr),ce(this,"engine"),ce(this,"session"),ce(this,"proposal"),ce(this,"pendingRequest"),ce(this,"auth"),ce(this,"signConfig"),ce(this,"on",(s,n)=>this.events.on(s,n)),ce(this,"once",(s,n)=>this.events.once(s,n)),ce(this,"off",(s,n)=>this.events.off(s,n)),ce(this,"removeListener",(s,n)=>this.events.removeListener(s,n)),ce(this,"removeAllListeners",s=>this.events.removeAllListeners(s)),ce(this,"connect",async s=>{try{return await this.engine.connect(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"pair",async s=>{try{return await this.engine.pair(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"approve",async s=>{try{return await this.engine.approve(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"reject",async s=>{try{return await this.engine.reject(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"update",async s=>{try{return await this.engine.update(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"extend",async s=>{try{return await this.engine.extend(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"request",async s=>{try{return await this.engine.request(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"respond",async s=>{try{return await this.engine.respond(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"ping",async s=>{try{return await this.engine.ping(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"emit",async s=>{try{return await this.engine.emit(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"disconnect",async s=>{try{return await this.engine.disconnect(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"find",s=>{try{return this.engine.find(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}}),ce(this,"authenticate",async(s,n)=>{try{return await this.engine.authenticate(s,n)}catch(i){throw this.logger.error(i.message),i}}),ce(this,"formatAuthMessage",s=>{try{return this.engine.formatAuthMessage(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"approveSessionAuthenticate",async s=>{try{return await this.engine.approveSessionAuthenticate(s)}catch(n){throw this.logger.error(n.message),n}}),ce(this,"rejectSessionAuthenticate",async s=>{try{return await this.engine.rejectSessionAuthenticate(s)}catch(n){throw this.logger.error(n.message),n}}),this.name=t?.name||Ju.name,this.metadata=Ed(t?.metadata),this.signConfig=t?.signConfig;let r=kn({logger:t?.logger||Ju.logger,name:this.name});this.logger=r,this.core=t?.core||new Gm(t),this.session=new nh(this.core,this.logger),this.proposal=new sh(this.core,this.logger),this.pendingRequest=new ih(this.core,this.logger),this.engine=new rh(this),this.auth=new lh(this.core,this.logger)}static async init(t){let r=new e(t);return await r.initialize(),r}get context(){return Qm(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var o0=uh;zi();function Ch(e){return e==null||typeof e!="object"&&typeof e!="function"}function T0(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function A0(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var Cx="[object RegExp]",P0="[object String]",O0="[object Number]",k0="[object Boolean]",N0="[object Arguments]",Ix="[object Symbol]",_x="[object Date]",Tx="[object Map]",Ax="[object Set]",Px="[object Array]",Ox="[object ArrayBuffer]",kx="[object Object]",Nx="[object DataView]",Rx="[object Uint8Array]",Bx="[object Uint8ClampedArray]",Lx="[object Uint16Array]",Ux="[object Uint32Array]",$x="[object Int8Array]",jx="[object Int16Array]",Dx="[object Int32Array]",qx="[object Float32Array]",Fx="[object Float64Array]";function Ih(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Mx(e,t){return Dn(e,void 0,e,new Map,t)}function Dn(e,t,r,s=new Map,n=void 0){let i=n?.(e,t,r,s);if(i!=null)return i;if(Ch(e))return e;if(s.has(e))return s.get(e);if(Array.isArray(e)){let o=new Array(e.length);s.set(e,o);for(let a=0;a<e.length;a++)o[a]=Dn(e[a],a,r,s,n);return Object.hasOwn(e,"index")&&(o.index=e.index),Object.hasOwn(e,"input")&&(o.input=e.input),o}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let o=new RegExp(e.source,e.flags);return o.lastIndex=e.lastIndex,o}if(e instanceof Map){let o=new Map;s.set(e,o);for(let[a,c]of e)o.set(a,Dn(c,a,r,s,n));return o}if(e instanceof Set){let o=new Set;s.set(e,o);for(let a of e)o.add(Dn(a,void 0,r,s,n));return o}if(typeof P<"u"&&P.isBuffer(e))return e.subarray();if(Ih(e)){let o=new(Object.getPrototypeOf(e)).constructor(e.length);s.set(e,o);for(let a=0;a<e.length;a++)o[a]=Dn(e[a],a,r,s,n);return o}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let o=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return s.set(e,o),Ys(o,e,r,s,n),o}if(typeof File<"u"&&e instanceof File){let o=new File([e],e.name,{type:e.type});return s.set(e,o),Ys(o,e,r,s,n),o}if(e instanceof Blob){let o=new Blob([e],{type:e.type});return s.set(e,o),Ys(o,e,r,s,n),o}if(e instanceof Error){let o=new e.constructor;return s.set(e,o),o.message=e.message,o.name=e.name,o.stack=e.stack,o.cause=e.cause,Ys(o,e,r,s,n),o}if(typeof e=="object"&&zx(e)){let o=Object.create(Object.getPrototypeOf(e));return s.set(e,o),Ys(o,e,r,s,n),o}return e}function Ys(e,t,r=e,s,n){let i=[...Object.keys(t),...T0(t)];for(let o=0;o<i.length;o++){let a=i[o],c=Object.getOwnPropertyDescriptor(e,a);(c==null||c.writable)&&(e[a]=Dn(t[a],a,r,s,n))}}function zx(e){switch(A0(e)){case N0:case Px:case Ox:case Nx:case k0:case _x:case qx:case Fx:case $x:case jx:case Dx:case Tx:case O0:case kx:case Cx:case Ax:case P0:case Ix:case Rx:case Bx:case Lx:case Ux:return!0;default:return!1}}function Hx(e,t){return Mx(e,(r,s,n,i)=>{let o=t?.(r,s,n,i);if(o!=null)return o;if(typeof e=="object")switch(Object.prototype.toString.call(e)){case O0:case P0:case k0:{let a=new e.constructor(e?.valueOf());return Ys(a,e),a}case N0:{let a={};return Ys(a,e),a.length=e.length,a[Symbol.iterator]=e[Symbol.iterator],a}default:return}})}function a0(e){return Hx(e)}function c0(e){return e!==null&&typeof e=="object"&&A0(e)==="[object Arguments]"}function l0(e){return typeof e=="object"&&e!==null}function Vx(){}function Kx(e){return Ih(e)}function Gx(e){if(typeof e!="object"||e==null)return!1;if(Object.getPrototypeOf(e)===null)return!0;if(Object.prototype.toString.call(e)!=="[object Object]"){let r=e[Symbol.toStringTag];return r==null||!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable?!1:e.toString()===`[object ${r}]`}let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Wx(e){if(Ch(e))return e;if(Array.isArray(e)||Ih(e)||e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);let t=Object.getPrototypeOf(e),r=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new r(e);if(e instanceof RegExp){let s=new r(e);return s.lastIndex=e.lastIndex,s}if(e instanceof DataView)return new r(e.buffer.slice(0));if(e instanceof Error){let s=new r(e.message);return s.stack=e.stack,s.name=e.name,s.cause=e.cause,s}if(typeof File<"u"&&e instanceof File)return new r([e],e.name,{type:e.type,lastModified:e.lastModified});if(typeof e=="object"){let s=Object.create(t);return Object.assign(s,e)}return e}function Zx(e,...t){let r=t.slice(0,-1),s=t[t.length-1],n=e;for(let i=0;i<r.length;i++){let o=r[i];n=wh(n,o,s,new Map)}return n}function wh(e,t,r,s){if(Ch(e)&&(e=Object(e)),t==null||typeof t!="object")return e;if(s.has(t))return Wx(s.get(t));if(s.set(t,e),Array.isArray(t)){t=t.slice();for(let i=0;i<t.length;i++)t[i]=t[i]??void 0}let n=[...Object.keys(t),...T0(t)];for(let i=0;i<n.length;i++){let o=n[i],a=t[o],c=e[o];if(c0(a)&&(a={...a}),c0(c)&&(c={...c}),typeof P<"u"&&P.isBuffer(a)&&(a=a0(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){let u=[],h=Reflect.ownKeys(c);for(let p=0;p<h.length;p++){let f=h[p];u[f]=c[f]}c=u}else c=[];let l=r(c,a,o,e,t,s);l!=null?e[o]=l:Array.isArray(a)||l0(c)&&l0(a)?e[o]=wh(c,a,r,s):c==null&&Gx(a)?e[o]=wh({},a,r,s):c==null&&Kx(a)?e[o]=a0(a):(c===void 0||a!==void 0)&&(e[o]=a)}return e}function Yx(e,...t){return Zx(e,...t,Vx)}var u0="error",Xx="wss://relay.walletconnect.org",Jx="wc",R0="universal_provider",Ea=`${Jx}@2:${R0}:`,B0="https://rpc.walletconnect.org/v1/",L0="generic",Qx=`${B0}bundler`,qn="call_status",eE=86400,_h={DEFAULT_CHAIN_CHANGED:"default_chain_changed"},tE=Object.defineProperty,rE=Object.defineProperties,sE=Object.getOwnPropertyDescriptors,h0=Object.getOwnPropertySymbols,nE=Object.prototype.hasOwnProperty,iE=Object.prototype.propertyIsEnumerable,p0=(e,t,r)=>t in e?tE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Sa=(e,t)=>{for(var r in t||(t={}))nE.call(t,r)&&p0(e,r,t[r]);if(h0)for(var r of h0(t))iE.call(t,r)&&p0(e,r,t[r]);return e},oE=(e,t)=>rE(e,sE(t));function U0(e,t,r){var s;let n=sr(e);return((s=t.rpcMap)==null?void 0:s[n.reference])||`${B0}?chainId=${n.namespace}:${n.reference}&projectId=${r}`}function aE(e){return e.includes(":")?e.split(":")[1]:e}function $0(e){return e.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function cE(e,t){let r=Object.keys(t.namespaces).filter(n=>n.includes(e));if(!r.length)return[];let s=[];return r.forEach(n=>{let i=t.namespaces[n].accounts;s.push(...i)}),s}function f0(e){return Object.fromEntries(Object.entries(e).filter(([t,r])=>{var s,n;return((s=r?.chains)==null?void 0:s.length)&&((n=r?.chains)==null?void 0:n.length)>0}))}function Ca(e={},t={}){let r=f0(d0(e)),s=f0(d0(t));return Yx(r,s)}function d0(e){var t,r,s,n,i;let o={};if(!zt(e))return o;for(let[a,c]of Object.entries(e)){let l=Ai(a)?[a]:c.chains,u=c.methods||[],h=c.events||[],p=c.rpcMap||{},f=Gs(a);o[f]=oE(Sa(Sa({},o[f]),c),{chains:Qt(l,(t=o[f])==null?void 0:t.chains),methods:Qt(u,(r=o[f])==null?void 0:r.methods),events:Qt(h,(s=o[f])==null?void 0:s.events)}),(zt(p)||zt(((n=o[f])==null?void 0:n.rpcMap)||{}))&&(o[f].rpcMap=Sa(Sa({},p),(i=o[f])==null?void 0:i.rpcMap))}return o}function g0(e){return e.includes(":")?e.split(":")[2]:e}function m0(e){let t={};for(let[r,s]of Object.entries(e)){let n=s.methods||[],i=s.events||[],o=s.accounts||[],a=Ai(r)?[r]:s.chains?s.chains:$0(s.accounts);t[r]={chains:a,methods:n,events:i,accounts:o}}return t}function ph(e){return typeof e=="number"?e:e.includes("0x")?parseInt(e,16):(e=e.includes(":")?e.split(":")[1]:e,isNaN(Number(e))?e:Number(e))}function lE(e){try{let t=JSON.parse(e);return typeof t=="object"&&t!==null&&!Array.isArray(t)}catch{return!1}}var j0={},Fn=e=>j0[e],fh=(e,t)=>{j0[e]=t},uE=Object.defineProperty,y0=Object.getOwnPropertySymbols,hE=Object.prototype.hasOwnProperty,pE=Object.prototype.propertyIsEnumerable,w0=(e,t,r)=>t in e?uE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,b0=(e,t)=>{for(var r in t||(t={}))hE.call(t,r)&&w0(e,r,t[r]);if(y0)for(var r of y0(t))pE.call(t,r)&&w0(e,r,t[r]);return e},v0="eip155",fE=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],dE=e=>e&&e.startsWith("0x")?BigInt(e).toString(10):e,dh=e=>e&&e.startsWith("0x")?e:`0x${BigInt(e).toString(16)}`,x0=e=>Object.keys(e).filter(t=>fE.includes(t)).reduce((t,r)=>(t[r]=gE(e[r]),t),{}),gE=e=>typeof e=="string"&&lE(e)?JSON.parse(e):e,mE=(e,t,r)=>{let{sessionProperties:s={},scopedProperties:n={}}=e,i={};if(!zt(n)&&!zt(s))return;let o=x0(s);for(let a of r){let c=dE(a);if(!c)continue;i[dh(c)]=o;let l=n?.[`${v0}:${c}`];if(l){let u=l?.[`${v0}:${c}:${t}`];i[dh(c)]=b0(b0({},i[dh(c)]),x0(u||l))}}for(let[a,c]of Object.entries(i))Object.keys(c).length===0&&delete i[a];return Object.keys(i).length>0?i:void 0},yE=Object.defineProperty,wE=(e,t,r)=>t in e?yE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,bE=(e,t,r)=>wE(e,typeof t!="symbol"?t+"":t,r),gh,bh=class e{constructor(t){bE(this,"storage"),this.storage=t}async getItem(t){return await this.storage.getItem(t)}async setItem(t,r){return await this.storage.setItem(t,r)}async removeItem(t){return await this.storage.removeItem(t)}static getStorage(t){return gh||(gh=new e(t)),gh}},vE=Object.defineProperty,xE=Object.defineProperties,EE=Object.getOwnPropertyDescriptors,E0=Object.getOwnPropertySymbols,SE=Object.prototype.hasOwnProperty,CE=Object.prototype.propertyIsEnumerable,S0=(e,t,r)=>t in e?vE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,IE=(e,t)=>{for(var r in t||(t={}))SE.call(t,r)&&S0(e,r,t[r]);if(E0)for(var r of E0(t))CE.call(t,r)&&S0(e,r,t[r]);return e},_E=(e,t)=>xE(e,EE(t));async function TE(e,t){let r=sr(e.result.capabilities.caip345.caip2),s=e.result.capabilities.caip345.transactionHashes,n=await Promise.allSettled(s.map(h=>AE(r.reference,h,t))),i=n.filter(h=>h.status==="fulfilled").map(h=>h.value).filter(h=>h);n.filter(h=>h.status==="rejected").forEach(h=>console.warn("Failed to fetch transaction receipt:",h.reason));let o=!i.length||i.some(h=>!h),a=i.every(h=>h?.status==="0x1"),c=i.every(h=>h?.status==="0x0"),l=i.some(h=>h?.status==="0x0"),u;return o?u=100:a?u=200:c?u=500:l&&(u=600),{id:e.result.id,version:e.request.version,atomic:e.request.atomicRequired,chainId:e.request.chainId,capabilities:e.result.capabilities,receipts:i,status:u}}async function AE(e,t,r){return await r(parseInt(e)).request(Ct("eth_getTransactionReceipt",[t]))}async function PE({sendCalls:e,storage:t}){let r=await t.getItem(qn);await t.setItem(qn,_E(IE({},r),{[e.result.id]:{request:e.request,result:e.result,expiry:Ie(eE)}}))}async function OE({resultId:e,storage:t}){let r=await t.getItem(qn);if(r){delete r[e],await t.setItem(qn,r);for(let s in r)Ot(r[s].expiry)&&delete r[s];await t.setItem(qn,r)}}async function kE({resultId:e,storage:t}){let r=await t.getItem(qn),s=r?.[e];if(s&&!Ot(s.expiry))return s;await OE({resultId:e,storage:t})}var NE=Object.defineProperty,RE=Object.defineProperties,BE=Object.getOwnPropertyDescriptors,C0=Object.getOwnPropertySymbols,LE=Object.prototype.hasOwnProperty,UE=Object.prototype.propertyIsEnumerable,vh=(e,t,r)=>t in e?NE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,mh=(e,t)=>{for(var r in t||(t={}))LE.call(t,r)&&vh(e,r,t[r]);if(C0)for(var r of C0(t))UE.call(t,r)&&vh(e,r,t[r]);return e},yh=(e,t)=>RE(e,BE(t)),Zs=(e,t,r)=>vh(e,typeof t!="symbol"?t+"":t,r),xh=class{constructor(t){Zs(this,"name","eip155"),Zs(this,"client"),Zs(this,"chainId"),Zs(this,"namespace"),Zs(this,"httpProviders"),Zs(this,"events"),Zs(this,"storage"),this.namespace=t.namespace,this.events=Fn("events"),this.client=Fn("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=bh.getStorage(this.client.core.storage)}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(t);case"wallet_getCallsStatus":return await this.getCallStatus(t);case"wallet_sendCalls":return await this.sendCalls(t)}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r);let s=this.chainId;this.chainId=parseInt(t),this.events.emit(_h.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${t}`,previousCaipChainId:`${this.name}:${s}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){let s=r||U0(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Xn(new Vi(s,Fn("disableProviderPing")))}setHttpProvider(t,r){let s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){let t={};return this.namespace.chains.forEach(r=>{var s;let n=parseInt(aE(r));t[n]=this.createHttpProvider(n,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(t){let r=t||this.chainId;return this.httpProviders[r]||(this.httpProviders=yh(mh({},this.httpProviders),{[r]:this.createHttpProvider(r)}),this.httpProviders[r])}async handleSwitchChain(t){var r,s;let n=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";n=n.startsWith("0x")?n:`0x${n}`;let i=parseInt(n,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:n}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}async getCapabilities(t){var r,s,n,i,o;let a=(s=(r=t.request)==null?void 0:r.params)==null?void 0:s[0],c=((i=(n=t.request)==null?void 0:n.params)==null?void 0:i[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");let l=this.client.session.get(t.topic),u=((o=l?.sessionProperties)==null?void 0:o.capabilities)||{},h=`${a}${c.join(",")}`,p=u?.[h];if(p)return p;let f;try{f=mE(l,a,c)}catch(d){console.warn("Failed to extract capabilities from session",d)}if(f)return f;let g=await this.client.request(t);try{await this.client.session.update(t.topic,{sessionProperties:yh(mh({},l.sessionProperties||{}),{capabilities:yh(mh({},u||{}),{[h]:g})})})}catch(d){console.warn("Failed to update session with capabilities",d)}return g}async getCallStatus(t){var r,s,n;let i=this.client.session.get(t.topic),o=(r=i.sessionProperties)==null?void 0:r.bundler_name;if(o){let l=this.getBundlerUrl(t.chainId,o);try{return await this.getUserOperationReceipt(l,t)}catch(u){console.warn("Failed to fetch call status from bundler",u,l)}}let a=(s=i.sessionProperties)==null?void 0:s.bundler_url;if(a)try{return await this.getUserOperationReceipt(a,t)}catch(l){console.warn("Failed to fetch call status from custom bundler",l,a)}let c=await kE({resultId:(n=t.request.params)==null?void 0:n[0],storage:this.storage});if(c)try{return await TE(c,this.getHttpProvider.bind(this))}catch(l){console.warn("Failed to fetch call status from stored send calls",l,c)}if(this.namespace.methods.includes(t.request.method))return await this.client.request(t);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(t,r){var s;let n=new URL(t),i=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ct("eth_getUserOperationReceipt",[(s=r.request.params)==null?void 0:s[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(t,r){return`${Qx}?projectId=${this.client.core.projectId}&chainId=${t}&bundler=${r}`}async sendCalls(t){var r,s,n;let i=await this.client.request(t),o=(r=t.request.params)==null?void 0:r[0],a=i?.id,c=i?.capabilities||{},l=(s=c?.caip345)==null?void 0:s.caip2,u=(n=c?.caip345)==null?void 0:n.transactionHashes;return!a||!l||!(u!=null&&u.length)||await PE({sendCalls:{request:o,result:i},storage:this.storage}),i}},$E=Object.defineProperty,jE=(e,t,r)=>t in e?$E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,jn=(e,t,r)=>jE(e,typeof t!="symbol"?t+"":t,r),Eh=class{constructor(t){jn(this,"name",L0),jn(this,"client"),jn(this,"httpProviders"),jn(this,"events"),jn(this,"namespace"),jn(this,"chainId"),this.namespace=t.namespace,this.events=Fn("events"),this.client=Fn("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(t.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(t.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(t.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(t.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider(t.chainId).request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r);let s=this.chainId;this.chainId=t,this.events.emit(_h.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${t}`,previousCaipChainId:`${this.name}:${s}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getNamespaceName(){let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return sr(t).namespace}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){var t,r;let s={};return(r=(t=this.namespace)==null?void 0:t.accounts)==null||r.forEach(n=>{var i,o;let a=sr(n),c=(o=(i=this.namespace)==null?void 0:i.rpcMap)==null?void 0:o[`${a.namespace}:${a.reference}`];s[a.reference]=this.createHttpProvider(n,c)}),s}getHttpProvider(t){let r=sr(t).reference,s=this.httpProviders[r];if(typeof s>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return s}setHttpProvider(t,r){let s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){let s=r||U0(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Xn(new Vi(s,Fn("disableProviderPing")))}},DE=Object.defineProperty,qE=Object.defineProperties,FE=Object.getOwnPropertyDescriptors,I0=Object.getOwnPropertySymbols,ME=Object.prototype.hasOwnProperty,zE=Object.prototype.propertyIsEnumerable,Sh=(e,t,r)=>t in e?DE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,$i=(e,t)=>{for(var r in t||(t={}))ME.call(t,r)&&Sh(e,r,t[r]);if(I0)for(var r of I0(t))zE.call(t,r)&&Sh(e,r,t[r]);return e},Ia=(e,t)=>qE(e,FE(t)),Bt=(e,t,r)=>Sh(e,typeof t!="symbol"?t+"":t,r),_0=class e{constructor(t){Bt(this,"client"),Bt(this,"namespaces"),Bt(this,"optionalNamespaces"),Bt(this,"sessionProperties"),Bt(this,"scopedProperties"),Bt(this,"events",new Cs),Bt(this,"rpcProviders",{}),Bt(this,"session"),Bt(this,"providerOpts"),Bt(this,"logger"),Bt(this,"uri"),Bt(this,"disableProviderPing",!1),Bt(this,"connectParams");var r,s;this.providerOpts=t,this.logger=kn({logger:(r=t.logger)!=null?r:u0,name:(s=this.providerOpts.name)!=null?s:R0}),this.disableProviderPing=t?.disableProviderPing||!1}static async init(t){let r=new e(t);return await r.initialize(),r}async request(t,r,s){let[n,i]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:$i({},t),chainId:`${n}:${i}`,topic:this.session.topic,expiry:s})}sendAsync(t,r,s,n){let i=new Date().getTime();this.request(t,s,n).then(o=>r(null,Wr(i,o))).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:be("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.connectParams=t,this.setNamespaces(t),this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}async authenticate(t,r){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(t),await this.cleanupPendingPairings();let{uri:s,response:n}=await this.client.authenticate(t,r);s&&(this.uri=s,this.events.emit("display_uri",s));let i=await n();if(this.session=i.session,this.session){let o=m0(this.session.namespaces);this.namespaces=Ca(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){var r,s;let{uri:n,approval:i}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties,authentication:(r=this.connectParams)==null?void 0:r.authentication,walletPay:(s=this.connectParams)==null?void 0:s.walletPay});n&&(this.uri=n,this.events.emit("display_uri",n));let o=await i();this.session=o;let a=m0(o.namespaces);return this.namespaces=Ca(this.namespaces,a),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;let[s,n]=this.validateChain(t);this.getProvider(s).setDefaultChain(n,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){try{this.logger.info("Cleaning up inactive pairings...");let r=this.client.pairing.getAll();if(!or(r))return;for(let s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}catch(r){this.logger.warn(r,"Failed to cleanup pending pairings")}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var t,r;if(this.client=this.providerOpts.client||await o0.init({core:this.providerOpts.core,logger:this.providerOpts.logger||u0,relayUrl:this.providerOpts.relayUrl||Xx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(s){throw this.logger.error(s,"Failed to get session"),new Error(`The provided session: ${(r=(t=this.providerOpts)==null?void 0:t.session)==null?void 0:r.topic} doesn't exist in the Sign client`)}else{let s=this.client.session.getAll();this.session=s[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");let t=[...new Set(Object.keys(this.session.namespaces).map(r=>Gs(r)))];fh("client",this.client),fh("events",this.events),fh("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;let s=cE(r,this.session);if(s?.length===0)return;let n=$0(s),i=Ca(this.namespaces,this.optionalNamespaces),o=Ia($i({},i[r]),{accounts:s,chains:n});switch(r){case"eip155":this.rpcProviders[r]=new xh({namespace:o});break;default:this.rpcProviders[r]=new Eh({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{var r;let{topic:s}=t;s===((r=this.session)==null?void 0:r.topic)&&this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{var r;let{params:s,topic:n}=t;if(n!==((r=this.session)==null?void 0:r.topic))return;let{event:i}=s;if(i.name==="accountsChanged"){let o=i.data;o&&or(o)&&this.events.emit("accountsChanged",o.map(g0))}else if(i.name==="chainChanged"){let o=s.chainId,a=s.event.data,c=Gs(o),l=ph(o)!==ph(a)?`${c}:${ph(a)}`:o;this.onChainChanged({currentCaipChainId:l})}else this.events.emit(i.name,i.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s,n;if(t!==((s=this.session)==null?void 0:s.topic))return;let{namespaces:i}=r,o=(n=this.client)==null?void 0:n.session.get(t);this.session=Ia($i({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{var r;t.topic===((r=this.session)==null?void 0:r.topic)&&(await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Ia($i({},be("USER_DISCONNECTED")),{data:t.topic})))}),this.on(_h.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(Ia($i({},t),{internal:!0}))})}getProvider(t){return this.rpcProviders[t]||this.rpcProviders[L0]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){let{namespaces:r={},optionalNamespaces:s={},sessionProperties:n,scopedProperties:i}=t;this.optionalNamespaces=Ca(r,s),this.sessionProperties=n,this.scopedProperties=i}validateChain(t){let[r,s]=t?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(o=>Gs(o)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];let n=Gs(Object.keys(this.namespaces)[0]),i=this.rpcProviders[n].getDefaultChain();return[n,i]}async requestAccounts(){let[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}async onChainChanged({currentCaipChainId:t,previousCaipChainId:r,internal:s=!1}){if(!this.namespaces)return;let[n,i]=this.validateChain(t);i&&(this.updateNamespaceChain(n,i),s?(this.events.emit("chainChanged",i),this.emitAccountsChangedOnChainChange({namespace:n,currentCaipChainId:t,previousCaipChainId:r})):this.getProvider(n).setDefaultChain(i),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange({namespace:t,currentCaipChainId:r,previousCaipChainId:s}){var n,i;try{if(s===r)return;let o=(i=(n=this.session)==null?void 0:n.namespaces[t])==null?void 0:i.accounts;if(!o)return;let a=o.filter(c=>c.includes(`${r}:`)).map(g0);if(!or(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn(o,"Failed to emit accountsChanged on chain change")}}updateNamespaceChain(t,r){if(!this.namespaces)return;let s=this.namespaces[t]?t:`${t}:${r}`,n={chains:[],methods:[],events:[],defaultChain:r};this.namespaces[s]?this.namespaces[s]&&(this.namespaces[s].defaultChain=r):this.namespaces[s]=n}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.connectParams=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(t,r){var s;let n=((s=this.session)==null?void 0:s.topic)||"";await this.client.core.storage.setItem(`${Ea}/${t}${n}`,r)}async getFromStore(t){var r;let s=((r=this.session)==null?void 0:r.topic)||"";return await this.client.core.storage.getItem(`${Ea}/${t}${s}`)}async deleteFromStore(t){var r;let s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.removeItem(`${Ea}/${t}${s}`)}async cleanupStorage(){var t;try{if(((t=this.client)==null?void 0:t.session.length)>0)return;let r=await this.client.core.storage.getKeys();for(let s of r)s.startsWith(Ea)&&await this.client.core.storage.removeItem(s)}catch(r){this.logger.warn(r,"Failed to cleanup storage")}}};m();w();y();m();w();y();function _a(e){try{return new URL(e)}catch{return null}}function HE(e){let t=e.split("/"),r=t.length>0&&t[0]!==void 0?t[0]:"",s=r.lastIndexOf(":");return s===-1?{host:r}:{host:r.slice(0,s),port:r.slice(s+1)}}function VE(e){let t=e.indexOf("://");if(t===-1)return null;let r=e.slice(0,t),s=t+3,n=e.indexOf("/",s);n===-1&&(n=e.length);let i=e.slice(s,n),o=i.lastIndexOf(":");return o===-1?{scheme:r,host:i}:{scheme:r,host:i.slice(0,o),port:i.slice(o+1)}}function D0(e,t){if(t.includes("://")){let o=_a(t);return o?o.origin===e:!1}let{host:r,port:s}=HE(t),n=e.indexOf("://");if(n!==-1){let o=n+3,a=e.indexOf("/",o);a===-1&&(a=e.length);let c=e.slice(o,a);if(s!==void 0)return`${r}:${s}`===c;let l=c.split(":")[0];return r===l}let i=_a(e);return i?s!==void 0?r===i.hostname&&s===(i.port||void 0):r===i.hostname:!1}function q0(e,t,r){let s=r,n,i=s.indexOf("://");i!==-1&&(n=s.slice(0,i),s=s.slice(i+3));let o=s.indexOf("/");o!==-1&&(s=s.slice(0,o));let a=s,c,l=a.lastIndexOf(":");l!==-1&&(c=a.slice(l+1),a=a.slice(0,l));let u=a.split(".");for(let d of u)if(d.includes("*")&&d!=="*")return!1;let h=e.protocol.replace(/:$/u,"");if(n&&n!==h||c!==void 0&&c!=="*"&&c!==e.port)return!1;let p=VE(t),g=(p?p.host:e.hostname).split(".");if(u.length!==g.length)return!1;for(let d=u.length-1;d>=0;d-=1){let b=u[d],k=g[d];if(b!=="*"&&b!==k)return!1}return!0}var KE={ton:["ton_sendMessage","ton_signData"],solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},Xs={RPC_ERROR_CODE:{USER_REJECTED:5e3,USER_REJECTED_METHODS:5002},getMethodsByChainNamespace(e){return KE[e]||[]},createDefaultNamespace(e){return{methods:this.getMethodsByChainNamespace(e),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(e,t){if(!t)return{...e};let r={...e},s=new Set;if(t.methods&&Object.keys(t.methods).forEach(n=>s.add(n)),t.chains&&Object.keys(t.chains).forEach(n=>s.add(n)),t.events&&Object.keys(t.events).forEach(n=>s.add(n)),t.rpcMap&&Object.keys(t.rpcMap).forEach(n=>{let[i]=n.split(":");i&&s.add(i)}),s.forEach(n=>{r[n]||(r[n]=this.createDefaultNamespace(n))}),t.methods&&Object.entries(t.methods).forEach(([n,i])=>{r[n]&&(r[n].methods=i)}),t.chains&&Object.entries(t.chains).forEach(([n,i])=>{r[n]&&(r[n].chains=i)}),t.events&&Object.entries(t.events).forEach(([n,i])=>{r[n]&&(r[n].events=i)}),t.rpcMap){let n=new Set;Object.entries(t.rpcMap).forEach(([i,o])=>{let[a,c]=i.split(":");!a||!c||!r[a]||(r[a].rpcMap||(r[a].rpcMap={}),n.has(a)||(r[a].rpcMap={},n.add(a)),r[a].rpcMap[c]=o)})}return r},createNamespaces(e,t){let r=e.reduce((s,n)=>{let{id:i,chainNamespace:o,rpcUrls:a}=n,c=a.default.http[0];s[o]||(s[o]=this.createDefaultNamespace(o));let l=`${o}:${i}`,u=s[o];switch(u.chains.push(l),l){case"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":u.chains.push("solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ");break;case"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1":u.chains.push("solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K");break;default:}return u?.rpcMap&&c&&(u.rpcMap[i]=c),s},{});return this.applyNamespaceOverrides(r,t)},resolveReownName:async e=>{let t=await ln.resolveName(e);return(t?.addresses?Object.values(t.addresses):[])[0]?.address||!1},getChainsFromNamespaces(e={}){return Object.values(e).flatMap(t=>{let r=t.chains||[],s=t.accounts.map(n=>{let[i,o]=n.split(":");return`${i}:${o}`});return Array.from(new Set([...r,...s]))})},isSessionEventData(e){return typeof e=="object"&&e!==null&&"id"in e&&"topic"in e&&"params"in e&&typeof e.params=="object"&&e.params!==null&&"chainId"in e.params&&"event"in e.params&&typeof e.params.event=="object"&&e.params.event!==null},isUserRejectedRequestError(e){try{if(typeof e=="object"&&e!==null){let t=e,r=typeof t.code=="number",s=r&&t.code===Xs.RPC_ERROR_CODE.USER_REJECTED_METHODS,n=r&&t.code===Xs.RPC_ERROR_CODE.USER_REJECTED;return s||n}return!1}catch{return!1}},isOriginAllowed(e,t,r){let s=[...t,...r];if(t.length===0)return!0;let n=_a(e);if(!n)return s.some(i=>!i.includes("*")&&i===e);if(n.hostname==="localhost"||n.hostname==="127.0.0.1")return!0;for(let i of s)if(i.includes("*")){if(q0(n,e,i))return!0}else if(D0(e,i))return!0;return!1},listenWcProvider({universalProvider:e,namespace:t,onConnect:r,onDisconnect:s,onAccountsChanged:n,onChainChanged:i,onDisplayUri:o}){r&&e.on("connect",()=>{let a=Xs.getWalletConnectAccounts(e,t);r(a)}),s&&e.on("disconnect",()=>{s()}),n&&e.on("accountsChanged",a=>{try{let c=e.session?.namespaces?.[t]?.accounts||[],l=e.rpcProviders?.[t]?.getDefaultChain(),u=a.map(h=>{let p=c.find(d=>d.includes(`${t}:${l}:${h}`));if(!p)return;let{chainId:f,chainNamespace:g}=Es.parseCaipAddress(p);return{address:h,chainId:f,chainNamespace:g}}).filter(h=>h!==void 0);u.length>0&&n(u)}catch(c){console.warn("Failed to parse accounts for namespace on accountsChanged event",t,a,c)}}),i&&e.on("chainChanged",a=>{i(a)}),o&&e.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(e,t){let r=new Set,s=e?.session?.namespaces?.[t]?.accounts?.map(n=>Es.parseCaipAddress(n)).filter(({address:n})=>r.has(n.toLowerCase())?!1:(r.add(n.toLowerCase()),!0));return s&&s.length>0?s:[]}};var GE=[we.CONNECTOR_ID.AUTH,we.CONNECTOR_ID.WALLET_CONNECT],Th=class{constructor(t){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=r=>J.getCaipNetworks(r),this.getConnectorId=r=>pr.getConnectorId(r),t&&this.construct(t)}construct(t){this.projectId=t.projectId,this.namespace=t.namespace,this.adapterType=t.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:t,chainId:r}){let s=this.getCaipNetworks().filter(n=>n.chainNamespace===this.namespace).find(n=>n.id.toString()===r?.toString());t&&s&&this.addConnection({connectorId:we.CONNECTOR_ID.AUTH,accounts:t,caipNetwork:s})}setAuthProvider(t){t.onConnect(this.onAuthConnected.bind(this)),t.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:we.CONNECTOR_ID.AUTH,type:"AUTH",name:we.CONNECTOR_NAMES.AUTH,provider:t,imageId:void 0,chain:this.namespace,chains:[]})}addConnector(...t){let r=new Set;this.availableConnectors=[...t,...this.availableConnectors].filter(s=>r.has(s.id)?!1:(r.add(s.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...t){let r=new Set;this.availableConnections=[...t,...this.availableConnections].filter(s=>r.has(s.connectorId.toLowerCase())?!1:(r.add(s.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(t){this.availableConnections=this.availableConnections.filter(r=>r.connectorId.toLowerCase()!==t.toLowerCase()),this.emit("connections",this.availableConnections)}clearConnections(t=!1){this.availableConnections=[],t&&this.emit("connections",this.availableConnections)}setStatus(t,r){J.setAccountProp("status",t,r)}on(t,r){this.eventListeners.has(t)||this.eventListeners.set(t,new Set),this.eventListeners.get(t)?.add(r)}off(t,r){let s=this.eventListeners.get(t);s&&s.delete(r)}removeAllEventListeners(){this.eventListeners.forEach(t=>{t.clear()})}emit(t,r){let s=this.eventListeners.get(t);s&&s.forEach(n=>n(r))}async connectWalletConnect(t){try{return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}catch(r){throw Xs.isUserRejectedRequestError(r)?new Fh(r):r}}async switchNetwork(t){let{caipNetwork:r}=t,s=Mi.getProviderId(r.chainNamespace),n=Mi.getProvider(r.chainNamespace);if(!n)throw new Error("Provider not found");if(s==="WALLET_CONNECT"){n.setDefaultChain(r.caipNetworkId);return}if(s==="AUTH"){let i=pr.getAuthConnector()?.provider;if(!i)throw new Error("Auth provider not found");let o=Gr(r.chainNamespace);await i.switchNetwork({chainId:r.caipNetworkId});let a=await i.getUser({chainId:r.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){let t=this.connectors.find(r=>r.id==="walletConnect");if(!t)throw new Error("WalletConnectConnector not found");return t}onConnect(t,r){if(t.length>0){let{address:s,chainId:n}=Re.getAccount(t[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===n?.toString()),o=this.connectors.find(a=>a.id===r);s&&(this.emit("accountChanged",{address:s,chainId:n,connector:o}),this.addConnection({connectorId:r,accounts:t.map(a=>{let{address:c}=Re.getAccount(a);return{address:c}}),caipNetwork:i}))}}onAccountsChanged(t,r,s=!0){if(t.length>0){let{address:n}=Re.getAccount(t[0]),i=this.getConnection({connectorId:r,connections:this.connections,connectors:this.connectors});n&&this.getConnectorId(we.CHAIN.EVM)?.toLowerCase()===r.toLowerCase()&&this.emit("accountChanged",{address:n,chainId:i?.caipNetwork?.id,connector:i?.connector}),this.addConnection({connectorId:r,accounts:t.map(o=>{let{address:a}=Re.getAccount(o);return{address:a}}),caipNetwork:i?.caipNetwork})}else s&&this.onDisconnect(r)}onDisconnect(t){this.removeProviderListeners(t),this.deleteConnection(t),this.getConnectorId(we.CHAIN.EVM)?.toLowerCase()===t.toLowerCase()&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(t,r){let s=typeof t=="string"&&t.startsWith("0x")?parseInt(t,16).toString():t.toString(),n=this.getConnection({connectorId:r,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(o=>o.chainNamespace===this.namespace).find(o=>o.id.toString()===s);n&&this.addConnection({connectorId:r,accounts:n.accounts,caipNetwork:i}),this.getConnectorId(we.CHAIN.EVM)?.toLowerCase()===r.toLowerCase()&&this.emit("switchNetwork",{chainId:s})}listenProviderEvents(t,r){if(GE.includes(t))return;let s=o=>this.onAccountsChanged(o,t),n=o=>this.onChainChanged(o,t),i=()=>this.onDisconnect(t);this.providerHandlers[t]||(r.on("disconnect",i),r.on("accountsChanged",s),r.on("chainChanged",n),this.providerHandlers[t]={provider:r,disconnect:i,accountsChanged:s,chainChanged:n})}removeProviderListeners(t){if(this.providerHandlers[t]){let{provider:r,disconnect:s,accountsChanged:n,chainChanged:i}=this.providerHandlers[t];r.removeListener("disconnect",s),r.removeListener("accountsChanged",n),r.removeListener("chainChanged",i),this.providerHandlers[t]=null}}emitFirstAvailableConnection(){let t=this.getConnection({connections:this.connections,connectors:this.connectors});if(t){let[r]=t.accounts;this.emit("accountChanged",{address:r?.address,chainId:t.caipNetwork?.id,connector:t.connector})}}getConnection({address:t,connectorId:r,connections:s,connectors:n}){if(r){let o=s.find(l=>l.connectorId.toLowerCase()===r.toLowerCase());if(!o)return null;let a=n.find(l=>l.id.toLowerCase()===o.connectorId.toLowerCase()),c=t?o.accounts.find(l=>l.address.toLowerCase()===t.toLowerCase()):o.accounts[0];return{...o,account:c,connector:a}}let i=s.find(o=>o.accounts.length>0&&n.some(a=>a.id.toLowerCase()===o.connectorId.toLowerCase()));if(i){let[o]=i.accounts,a=n.find(c=>c.id.toLowerCase()===i.connectorId.toLowerCase());return{...i,account:o,connector:a}}return null}};m();w();y();var Js=null,Gt={getSIWX(){return Oe.state.siwx},async initializeIfEnabled(e=J.getActiveCaipAddress()){let t=Oe.state.siwx;if(!(t&&e))return;let[r,s,n]=e.split(":");if(J.checkIfSupportedNetwork(r,`${r}:${s}`))try{if(Oe.state.remoteFeatures?.emailCapture){let o=J.getAccountData(r)?.user;await St.open({view:"DataCapture",data:{email:o?.email??void 0}});return}if(Js&&await Js,(await t.getSessions(`${r}:${s}`,n)).length)return;await St.open({view:"SIWXSignMessage"})}catch(i){console.error("SIWXUtil:initializeIfEnabled",i),nt.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(i)}),await ht._getClient()?.disconnect().catch(console.error),ye.reset("Connect"),_e.showError("A problem occurred while trying initialize authentication")}},async isAuthenticated(e=J.getActiveCaipAddress()){if(!Oe.state.siwx||!e)return!0;let{chainNamespace:r,chainId:s,address:n}=Es.parseCaipAddress(e),i=`${r}:${s}`;return(await Gt.getSessions({address:n,caipNetworkId:i})).length>0},async requestSignMessage(){let e=Oe.state.siwx,t=Re.getPlainAddress(J.getActiveCaipAddress()),r=Gn();if(!e)throw new Error("SIWX is not enabled");if(!t)throw new Error("No ActiveCaipAddress found");if(!r)throw new Error("No ActiveCaipNetwork or client found");try{let s=await e.createMessage({chainId:r.caipNetworkId,accountAddress:t}),n=s.toString(),i="";e.signMessage?i=await e.signMessage({message:n,chainId:r.caipNetworkId,accountAddress:t}):(pr.getConnectorId(r.chainNamespace)===we.CONNECTOR_ID.AUTH&&ye.pushTransactionStack({}),i=await ht.signMessage(n)||""),await e.addSession({data:s,message:n,signature:i}),J.setLastConnectedSIWECaipNetwork(r),St.close(),nt.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){(!St.state.open||ye.state.view==="ApproveTransaction")&&await St.open({view:"SIWXSignMessage"}),_e.showError("Error signing message"),nt.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(s)}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){try{let e=this.getSIWX();if(e?.getRequired?.()){let r=J.getLastConnectedSIWECaipNetwork();if(r){let s=await e?.getSessions(r?.caipNetworkId,Re.getPlainAddress(J.getActiveCaipAddress())||"");s&&s.length>0?await J.switchActiveNetwork(r):await ht.disconnect()}else await ht.disconnect()}else St.close();St.close(),nt.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getAllSessions(){let e=this.getSIWX(),t=J.getAllRequestedCaipNetworks(),r=[];return await Promise.all(t.map(async s=>{let n=await e?.getSessions(s.caipNetworkId,Re.getPlainAddress(J.getActiveCaipAddress())||"");n&&r.push(...n)})),r},async getSessions(e){let t=Oe.state.siwx,r=e?.address;if(!r){let n=J.getActiveCaipAddress();r=Re.getPlainAddress(n)}let s=e?.caipNetworkId;return s||(s=J.getActiveCaipNetwork()?.caipNetworkId),t&&r&&s?t.getSessions(s,r):[]},async isSIWXCloseDisabled(){let e=this.getSIWX();if(e){let t=ye.state.view==="ApproveTransaction",r=ye.state.view==="SIWXSignMessage";if(t||r)return e.getRequired?.()&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:e,chainId:t,socialUri:r,preferredAccountType:s,chainNamespace:n}){let i=Gt.getSIWX(),o=Gn();if(!i||!n.includes(we.CHAIN.EVM)||Oe.state.remoteFeatures?.emailCapture){let h=await e.connect({chainId:t,socialUri:r,preferredAccountType:s});return{address:h.address,chainId:h.chainId,accounts:h.accounts}}let a=`${n}:${t}`,c=await i.createMessage({chainId:a,accountAddress:"<<AccountAddress>>"}),l={accountAddress:c.accountAddress,chainId:c.chainId,domain:c.domain,uri:c.uri,version:c.version,nonce:c.nonce,notBefore:c.notBefore,statement:c.statement,resources:c.resources,requestId:c.requestId,issuedAt:c.issuedAt,expirationTime:c.expirationTime,serializedMessage:c.toString()},u=await e.connect({chainId:t,socialUri:r,siwxMessage:l,preferredAccountType:s});return l.accountAddress=u.address,l.serializedMessage=u.message||"",u.signature&&u.message&&await Gt.addEmbeddedWalletSession(l,u.message,u.signature),J.setLastConnectedSIWECaipNetwork(o),{address:u.address,chainId:u.chainId,accounts:u.accounts}},async addEmbeddedWalletSession(e,t,r){if(Js)return Js;let s=Gt.getSIWX();return s?(Js=s.addSession({data:e,message:t,signature:r}).finally(()=>{Js=null}),Js):Promise.resolve()},async universalProviderAuthenticate({universalProvider:e,chains:t,methods:r}){let s=Gt.getSIWX(),n=Gn(),i=new Set(t.map(l=>l.split(":")[0]));if(!s||i.size!==1||!i.has("eip155"))return!1;let o=await s.createMessage({chainId:Gn()?.caipNetworkId||"",accountAddress:""}),a=await e.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:r,chains:[o.chainId,...t.filter(l=>l!==o.chainId)]});_e.showLoading("Authenticating...",{autoClose:!1});let c={...a.session.peer.metadata,name:a.session.peer.metadata.name,icon:a.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"};if(J.setAccountProp("connectedWalletInfo",c,Array.from(i)[0]),a?.auths?.length){let l=a.auths.map(u=>{let h=e.client.formatAuthMessage({request:u.p,iss:u.p.iss});return{data:{...u.p,accountAddress:u.p.iss.split(":").slice(-1).join(""),chainId:u.p.iss.split(":").slice(2,4).join(":"),uri:u.p.aud??"",version:u.p.version||o.version,expirationTime:u.p.exp,issuedAt:u.p.iat,notBefore:u.p.nbf},message:h,signature:u.s.s,cacao:u}});try{await s.setSessions(l),n&&J.setLastConnectedSIWECaipNetwork(n),nt.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:Gt.getSIWXEventProperties()})}catch(u){throw console.error("SIWX:universalProviderAuth - failed to set sessions",u),nt.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:Gt.getSIWXEventProperties(u)}),await e.disconnect().catch(console.error),u}finally{_e.hide()}}return!0},getSIWXEventProperties(e){let t=J.state.activeChain;if(!t)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:J.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:Gr(t)===sn.ACCOUNT_TYPES.SMART_ACCOUNT,message:e?Re.parseError(e):void 0}},async clearSessions(){let e=this.getSIWX();e&&await e.setSessions([])}};m();w();y();var Ah=class{constructor({provider:t,namespace:r}){this.id=we.CONNECTOR_ID.WALLET_CONNECT,this.name="WalletConnect",this.type="WALLET_CONNECT",this.imageId="ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",this.getCaipNetworks=J.getCaipNetworks.bind(J),this.caipNetworks=this.getCaipNetworks(),this.provider=t,this.chain=r}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){let r=this.getCaipNetworks(),s=Oe.state.universalProviderConfigOverride,n=Xs.createNamespaces(r,s);await this.provider.connect({optionalNamespaces:n})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){let t=this.chains.map(r=>r.caipNetworkId);return Gt.universalProviderAuthenticate({universalProvider:this.provider,chains:t,methods:WE})}},WE=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];m();w();y();var lr=lt({message:"",variant:"info",open:!1}),ZE={state:lr,subscribeKey(e,t){return ut(lr,e,t)},open(e,t){let{debug:r}=Oe.state,{code:s,displayMessage:n,debugMessage:i}=e;if(n&&r&&(lr.message=n,lr.variant=t,lr.open=!0),i){if(!we.IS_DEVELOPMENT)return;let o=typeof i=="function"?i():i,a=s?{code:s}:void 0;t==="error"?console.error(o,a):t==="warning"?console.warn(o,a):console.info(o,a)}},warn(e,t,r){lr.open=!0,lr.message=e,lr.variant="warning",t&&console.warn(t,r)},close(){lr.open=!1,lr.message="",lr.variant="info"}},Ph=Wt(ZE);m();w();y();m();w();y();var Hr={getGasPriceInEther(e,t){let r=t*e;return Number(r)/1e18},getGasPriceInUSD(e,t,r){let s=Hr.getGasPriceInEther(t,r);return Ce.bigNumber(e).times(s).toNumber()},getPriceImpact({sourceTokenAmount:e,sourceTokenPriceInUSD:t,toTokenPriceInUSD:r,toTokenAmount:s}){let n=Ce.bigNumber(e).times(t),i=Ce.bigNumber(s).times(r);return n.minus(i).div(n).times(100).toNumber()},getMaxSlippage(e,t){let r=Ce.bigNumber(e).div(100);return Ce.multiply(t,r).toNumber()},getProviderFee(e,t=.0085){return Ce.bigNumber(e).times(t).toString()},isInsufficientNetworkTokenForGas(e,t){let r=t||"0";return Ce.bigNumber(e).eq(0)?!0:Ce.bigNumber(Ce.bigNumber(r)).gt(e)},isInsufficientSourceTokenForSwap(e,t,r){let s=r?.find(i=>i.address===t)?.quantity?.numeric;return Ce.bigNumber(s||"0").lt(e)}};var F0=15e4,YE=6;var et={initializing:!1,initialized:!1,loadingPrices:!1,loadingQuote:!1,loadingApprovalTransaction:!1,loadingBuildTransaction:!1,loadingTransaction:!1,switchingTokens:!1,fetchError:!1,approvalTransaction:void 0,swapTransaction:void 0,transactionError:void 0,sourceToken:void 0,sourceTokenAmount:"",sourceTokenPriceInUSD:0,toToken:void 0,toTokenAmount:"",toTokenPriceInUSD:0,networkPrice:"0",networkBalanceInUSD:"0",networkTokenSymbol:"",inputError:void 0,slippage:Ss.CONVERT_SLIPPAGE_TOLERANCE,tokens:void 0,popularTokens:void 0,suggestedTokens:void 0,foundTokens:void 0,myTokensWithBalance:void 0,tokensPriceMap:{},gasFee:"0",gasPriceInUSD:0,priceImpact:void 0,maxSlippage:void 0,providerFee:void 0},S=lt({...et}),Ta={state:S,subscribe(e){return $t(S,()=>e(S))},subscribeKey(e,t){return ut(S,e,t)},getParams(){let e=J.state.activeChain,t=J.getAccountData(e)?.caipAddress??J.state.activeCaipAddress,r=Re.getPlainAddress(t),s=Kn(),n=pr.getConnectorId(J.state.activeChain);if(!r)throw new Error("No address found to swap the tokens from.");let i=!S.toToken?.address||!S.toToken?.decimals,o=!S.sourceToken?.address||!S.sourceToken?.decimals||!Ce.bigNumber(S.sourceTokenAmount).gt(0),a=!S.sourceTokenAmount;return{networkAddress:s,fromAddress:r,fromCaipAddress:t,sourceTokenAddress:S.sourceToken?.address,toTokenAddress:S.toToken?.address,toTokenAmount:S.toTokenAmount,toTokenDecimals:S.toToken?.decimals,sourceTokenAmount:S.sourceTokenAmount,sourceTokenDecimals:S.sourceToken?.decimals,invalidToToken:i,invalidSourceToken:o,invalidSourceTokenAmount:a,availableToSwap:t&&!i&&!o&&!a,isAuthConnector:n===we.CONNECTOR_ID.AUTH}},async setSourceToken(e){if(!e){S.sourceToken=e,S.sourceTokenAmount="",S.sourceTokenPriceInUSD=0;return}S.sourceToken=e,await te.setTokenPrice(e.address,"sourceToken")},setSourceTokenAmount(e){S.sourceTokenAmount=e},async setToToken(e){if(!e){S.toToken=e,S.toTokenAmount="",S.toTokenPriceInUSD=0;return}S.toToken=e,await te.setTokenPrice(e.address,"toToken")},setToTokenAmount(e){S.toTokenAmount=e?Ce.toFixed(e,YE):""},async setTokenPrice(e,t){let r=S.tokensPriceMap[e]||0;r||(S.loadingPrices=!0,r=await te.getAddressPrice(e)),t==="sourceToken"?S.sourceTokenPriceInUSD=r:t==="toToken"&&(S.toTokenPriceInUSD=r),S.loadingPrices&&(S.loadingPrices=!1),te.getParams().availableToSwap&&!S.switchingTokens&&te.swapTokens()},async switchTokens(){if(!(S.initializing||!S.initialized||S.switchingTokens)){S.switchingTokens=!0;try{let e=S.toToken?{...S.toToken}:void 0,t=S.sourceToken?{...S.sourceToken}:void 0,r=e&&S.toTokenAmount===""?"1":S.toTokenAmount;te.setSourceTokenAmount(r),te.setToTokenAmount(""),await te.setSourceToken(e),await te.setToToken(t),S.switchingTokens=!1,te.swapTokens()}catch(e){throw S.switchingTokens=!1,e}}},resetState(){S.myTokensWithBalance=et.myTokensWithBalance,S.tokensPriceMap=et.tokensPriceMap,S.initialized=et.initialized,S.initializing=et.initializing,S.switchingTokens=et.switchingTokens,S.sourceToken=et.sourceToken,S.sourceTokenAmount=et.sourceTokenAmount,S.sourceTokenPriceInUSD=et.sourceTokenPriceInUSD,S.toToken=et.toToken,S.toTokenAmount=et.toTokenAmount,S.toTokenPriceInUSD=et.toTokenPriceInUSD,S.networkPrice=et.networkPrice,S.networkTokenSymbol=et.networkTokenSymbol,S.networkBalanceInUSD=et.networkBalanceInUSD,S.inputError=et.inputError},resetValues(){let{networkAddress:e}=te.getParams(),t=S.tokens?.find(r=>r.address===e);te.setSourceToken(t),te.setToToken(void 0)},getApprovalLoadingState(){return S.loadingApprovalTransaction},clearError(){S.transactionError=void 0},async initializeState(){if(!S.initializing){if(S.initializing=!0,!S.initialized)try{await te.fetchTokens(),S.initialized=!0}catch{S.initialized=!1,_e.showError("Failed to initialize swap"),ye.goBack()}S.initializing=!1}},async fetchTokens(){let{networkAddress:e}=te.getParams();await te.getNetworkTokenPrice(),await te.getMyTokensWithBalance();let t=S.myTokensWithBalance?.find(r=>r.address===e);t&&(S.networkTokenSymbol=t.symbol,te.setSourceToken(t),te.setSourceTokenAmount("0"))},async getTokenList(){let e=J.state.activeCaipNetwork?.caipNetworkId;if(!(S.caipNetworkId===e&&S.tokens))try{S.tokensLoading=!0;let t=await nn.getTokenList(e);S.tokens=t,S.caipNetworkId=e,S.popularTokens=t.sort((o,a)=>o.symbol<a.symbol?-1:o.symbol>a.symbol?1:0);let s=(e&&Ss.SUGGESTED_TOKENS_BY_CHAIN?.[e]||[]).map(o=>t.find(a=>a.symbol===o)).filter(o=>!!o),i=(Ss.SWAP_SUGGESTED_TOKENS||[]).map(o=>t.find(a=>a.symbol===o)).filter(o=>!!o).filter(o=>!s.some(a=>a.address===o.address));S.suggestedTokens=[...s,...i]}catch{S.tokens=[],S.popularTokens=[],S.suggestedTokens=[]}finally{S.tokensLoading=!1}},async getAddressPrice(e){let t=S.tokensPriceMap[e];if(t)return t;let s=(await Le.fetchTokenPrice({addresses:[e]}))?.fungibles||[],i=[...S.tokens||[],...S.myTokensWithBalance||[]]?.find(c=>c.address===e)?.symbol,o=s.find(c=>c.symbol.toLowerCase()===i?.toLowerCase())?.price||0,a=parseFloat(o.toString());return S.tokensPriceMap[e]=a,a},async getNetworkTokenPrice(){let{networkAddress:e}=te.getParams(),r=(await Le.fetchTokenPrice({addresses:[e]}).catch(()=>(_e.showError("Failed to fetch network token price"),{fungibles:[]}))).fungibles?.[0],s=r?.price.toString()||"0";S.tokensPriceMap[e]=parseFloat(s),S.networkTokenSymbol=r?.symbol||"",S.networkPrice=s},async getMyTokensWithBalance(e){let t=await Zh.getMyTokensWithBalance({forceUpdate:e,caipNetwork:J.state.activeCaipNetwork,address:J.getAccountData()?.address}),r=nn.mapBalancesToSwapTokens(t);r&&(await te.getInitialGasPrice(),te.setBalances(r))},setBalances(e){let{networkAddress:t}=te.getParams(),r=J.state.activeCaipNetwork;if(!r)return;let s=e.find(n=>n.address===t);e.forEach(n=>{S.tokensPriceMap[n.address]=n.price||0}),S.myTokensWithBalance=e.filter(n=>n.address.startsWith(r.caipNetworkId)),S.networkBalanceInUSD=s?Ce.multiply(s.quantity.numeric,s.price).toString():"0"},async getInitialGasPrice(){let e=await nn.fetchGasPrice();if(!e)return{gasPrice:null,gasPriceInUSD:null};switch(J.state?.activeCaipNetwork?.chainNamespace){case we.CHAIN.SOLANA:return S.gasFee=e.standard??"0",S.gasPriceInUSD=Ce.multiply(e.standard,S.networkPrice).div(1e9).toNumber(),{gasPrice:BigInt(S.gasFee),gasPriceInUSD:Number(S.gasPriceInUSD)};case we.CHAIN.EVM:default:let t=e.standard??"0",r=BigInt(t),s=BigInt(F0),n=Hr.getGasPriceInUSD(S.networkPrice,s,r);return S.gasFee=t,S.gasPriceInUSD=n,{gasPrice:r,gasPriceInUSD:n}}},async swapTokens(){let e=J.getAccountData()?.address,t=S.sourceToken,r=S.toToken,s=Ce.bigNumber(S.sourceTokenAmount).gt(0);if(s||te.setToTokenAmount(""),!r||!t||S.loadingPrices||!s||!e)return;S.loadingQuote=!0;let n=Ce.bigNumber(S.sourceTokenAmount).times(10**t.decimals).round(0);try{let i=await Le.fetchSwapQuote({userAddress:e,from:t.address,to:r.address,gasPrice:S.gasFee,amount:n.toString()});S.loadingQuote=!1;let o=i?.quotes?.[0]?.toAmount;if(!o){Ph.open({displayMessage:"Incorrect amount",debugMessage:"Please enter a valid amount"},"error");return}let a=Ce.bigNumber(o).div(10**r.decimals).toString();te.setToTokenAmount(a),te.hasInsufficientToken(S.sourceTokenAmount,t.address)?S.inputError="Insufficient balance":(S.inputError=void 0,te.setTransactionDetails())}catch(i){let o=await nn.handleSwapError(i);S.loadingQuote=!1,S.inputError=o||"Insufficient balance"}},async getTransaction(){let{fromCaipAddress:e,availableToSwap:t}=te.getParams(),r=S.sourceToken,s=S.toToken;if(!(!e||!t||!r||!s||S.loadingQuote))try{S.loadingBuildTransaction=!0;let n=await nn.fetchSwapAllowance({userAddress:e,tokenAddress:r.address,sourceTokenAmount:S.sourceTokenAmount,sourceTokenDecimals:r.decimals}),i;return n?i=await te.createSwapTransaction():i=await te.createAllowanceTransaction(),S.loadingBuildTransaction=!1,S.fetchError=!1,i}catch{ye.goBack(),_e.showError("Failed to check allowance"),S.loadingBuildTransaction=!1,S.approvalTransaction=void 0,S.swapTransaction=void 0,S.fetchError=!0;return}},async createAllowanceTransaction(){let{fromCaipAddress:e,sourceTokenAddress:t,toTokenAddress:r}=te.getParams();if(!(!e||!r)){if(!t)throw new Error("createAllowanceTransaction - No source token address found.");try{let s=await Le.generateApproveCalldata({from:t,to:r,userAddress:e}),n=Re.getPlainAddress(s.tx.from);if(!n)throw new Error("SwapController:createAllowanceTransaction - address is required");let i={data:s.tx.data,to:n,gasPrice:BigInt(s.tx.eip155.gasPrice),value:BigInt(s.tx.value),toAmount:S.toTokenAmount};return S.swapTransaction=void 0,S.approvalTransaction={data:i.data,to:i.to,gasPrice:i.gasPrice,value:i.value,toAmount:i.toAmount},{data:i.data,to:i.to,gasPrice:i.gasPrice,value:i.value,toAmount:i.toAmount}}catch{ye.goBack(),_e.showError("Failed to create approval transaction"),S.approvalTransaction=void 0,S.swapTransaction=void 0,S.fetchError=!0;return}}},async createSwapTransaction(){let{networkAddress:e,fromCaipAddress:t,sourceTokenAmount:r}=te.getParams(),s=S.sourceToken,n=S.toToken;if(!t||!r||!s||!n)return;let i=ht.parseUnits(r,s.decimals)?.toString();try{let o=await Le.generateSwapCalldata({userAddress:t,from:s.address,to:n.address,amount:i,disableEstimate:!0}),a=s.address===e,c=BigInt(o.tx.eip155.gas),l=BigInt(o.tx.eip155.gasPrice),u=Re.getPlainAddress(o.tx.to);if(!u)throw new Error("SwapController:createSwapTransaction - address is required");let h={data:o.tx.data,to:u,gas:c,gasPrice:l,value:BigInt(a?i??"0":"0"),toAmount:S.toTokenAmount};return S.gasPriceInUSD=Hr.getGasPriceInUSD(S.networkPrice,c,l),S.approvalTransaction=void 0,S.swapTransaction=h,h}catch{ye.goBack(),_e.showError("Failed to create transaction"),S.approvalTransaction=void 0,S.swapTransaction=void 0,S.fetchError=!0;return}},onEmbeddedWalletApprovalSuccess(){_e.showLoading("Approve limit increase in your wallet"),ye.replace("SwapPreview")},async sendTransactionForApproval(e){let{fromAddress:t,isAuthConnector:r}=te.getParams();S.loadingApprovalTransaction=!0,r?ye.pushTransactionStack({onSuccess:te.onEmbeddedWalletApprovalSuccess}):_e.showLoading("Approve limit increase in your wallet");try{await ht.sendTransaction({address:t,to:e.to,data:e.data,value:e.value,chainNamespace:we.CHAIN.EVM}),await te.swapTokens(),await te.getTransaction(),S.approvalTransaction=void 0,S.loadingApprovalTransaction=!1}catch(n){let i=n;S.transactionError=i?.displayMessage,S.loadingApprovalTransaction=!1,_e.showError(i?.displayMessage||"Transaction error"),nt.sendEvent({type:"track",event:"SWAP_APPROVAL_ERROR",properties:{message:i?.displayMessage||i?.message||"Unknown",network:J.state.activeCaipNetwork?.caipNetworkId||"",swapFromToken:te.state.sourceToken?.symbol||"",swapToToken:te.state.toToken?.symbol||"",swapFromAmount:te.state.sourceTokenAmount||"",swapToAmount:te.state.toTokenAmount||"",isSmartAccount:Gr(we.CHAIN.EVM)===sn.ACCOUNT_TYPES.SMART_ACCOUNT}})}},async sendTransactionForSwap(e){if(!e)return;let{fromAddress:t,toTokenAmount:r,isAuthConnector:s}=te.getParams();S.loadingTransaction=!0;let n=`Swapping ${S.sourceToken?.symbol} to ${Ce.formatNumberToLocalString(r,3)} ${S.toToken?.symbol}`,i=`Swapped ${S.sourceToken?.symbol} to ${Ce.formatNumberToLocalString(r,3)} ${S.toToken?.symbol}`;s?ye.pushTransactionStack({onSuccess(){ye.replace("Account"),_e.showLoading(n),Ta.resetState()}}):_e.showLoading("Confirm transaction in your wallet");try{let o=[S.sourceToken?.address,S.toToken?.address].join(","),a=await ht.sendTransaction({address:t,to:e.to,data:e.data,value:e.value,chainNamespace:we.CHAIN.EVM});return S.loadingTransaction=!1,_e.showSuccess(i),nt.sendEvent({type:"track",event:"SWAP_SUCCESS",properties:{network:J.state.activeCaipNetwork?.caipNetworkId||"",swapFromToken:te.state.sourceToken?.symbol||"",swapToToken:te.state.toToken?.symbol||"",swapFromAmount:te.state.sourceTokenAmount||"",swapToAmount:te.state.toTokenAmount||"",isSmartAccount:Gr(we.CHAIN.EVM)===sn.ACCOUNT_TYPES.SMART_ACCOUNT}}),Ta.resetState(),s||ye.replace("Account"),Ta.getMyTokensWithBalance(o),a}catch(o){let a=o;S.transactionError=a?.displayMessage,S.loadingTransaction=!1,_e.showError(a?.displayMessage||"Transaction error"),nt.sendEvent({type:"track",event:"SWAP_ERROR",properties:{message:a?.displayMessage||a?.message||"Unknown",network:J.state.activeCaipNetwork?.caipNetworkId||"",swapFromToken:te.state.sourceToken?.symbol||"",swapToToken:te.state.toToken?.symbol||"",swapFromAmount:te.state.sourceTokenAmount||"",swapToAmount:te.state.toTokenAmount||"",isSmartAccount:Gr(we.CHAIN.EVM)===sn.ACCOUNT_TYPES.SMART_ACCOUNT}});return}},hasInsufficientToken(e,t){return Hr.isInsufficientSourceTokenForSwap(e,t,S.myTokensWithBalance)},setTransactionDetails(){let{toTokenAddress:e,toTokenDecimals:t}=te.getParams();!e||!t||(S.gasPriceInUSD=Hr.getGasPriceInUSD(S.networkPrice,BigInt(S.gasFee),BigInt(F0)),S.priceImpact=Hr.getPriceImpact({sourceTokenAmount:S.sourceTokenAmount,sourceTokenPriceInUSD:S.sourceTokenPriceInUSD,toTokenPriceInUSD:S.toTokenPriceInUSD,toTokenAmount:S.toTokenAmount}),S.maxSlippage=Hr.getMaxSlippage(S.slippage,S.toTokenAmount),S.providerFee=Hr.getProviderFee(S.sourceTokenAmount))}},te=Wt(Ta);m();w();y();var ji=lt({isLegalCheckboxChecked:!1}),XE={state:ji,subscribe(e){return $t(ji,()=>e(ji))},subscribeKey(e,t){return ut(ji,e,t)},setIsLegalCheckboxChecked(e){ji.isLegalCheckboxChecked=e}};m();w();y();m();w();y();var JE={eip155:{native:{assetNamespace:"slip44",assetReference:"60"},defaultTokenNamespace:"erc20"},solana:{native:{assetNamespace:"slip44",assetReference:"501"},defaultTokenNamespace:"token"}},Oh=class extends Error{};function QE(){let{sdkType:e,sdkVersion:t,projectId:r}=Oe.getSnapshot(),s=new URL("https://rpc.walletconnect.org/v1/json-rpc");return s.searchParams.set("projectId",r),s.searchParams.set("st",e),s.searchParams.set("sv",t),s.searchParams.set("source","fund-wallet"),s.toString()}async function kh(e,t){let r=QE(),{projectId:s}=Oe.getSnapshot(),n={jsonrpc:"2.0",id:1,method:e,params:{...t||{},projectId:s}},o=await(await fetch(r,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}})).json();if(o.error)throw new Oh(o.error.message);return o}async function Nh(e){return(await kh("reown_getExchanges",e)).result}async function Rh(e){return(await kh("reown_getExchangePayUrl",e)).result}async function M0(e){return(await kh("reown_getExchangeBuyStatus",e)).result}function Aa(e,t){let{chainNamespace:r,chainId:s}=Es.parseCaipNetworkId(e),n=JE[r];if(!n)throw new Error(`Unsupported chain namespace for CAIP-19 formatting: ${r}`);let i=n.native.assetNamespace,o=n.native.assetReference;return t!=="native"&&(i=n.defaultTokenNamespace,o=t),`${`${r}:${s}`}/${i}:${o}`}var e8={network:"eip155:1",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},t8={network:"eip155:8453",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},z0={network:"eip155:8453",asset:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},r8={network:"eip155:84532",asset:"0x036CbD53842c5426634e7929541eC2318f3dCF7e",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},s8={network:"eip155:84532",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},n8={network:"eip155:1",asset:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},i8={network:"eip155:42161",asset:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},o8={network:"eip155:137",asset:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},a8={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},c8={network:"eip155:1",asset:"0xdAC17F958D2ee523a2206206994597C13D831ec7",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},l8={network:"eip155:10",asset:"0x94b008aA00579c1307B0EF2c499aD98a8ce58e58",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},u8={network:"eip155:42161",asset:"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},h8={network:"eip155:137",asset:"0xc2132d05d31c914a87c6611c10748aeb04b58e8f",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},p8={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},f8={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"native",metadata:{name:"Solana",symbol:"SOL",decimals:9}},d8={ethereumETH:e8,baseETH:t8,baseUSDC:z0,baseSepoliaETH:s8,ethereumUSDC:n8,arbitrumUSDC:i8,polygonUSDC:o8,solanaUSDC:a8,ethereumUSDT:c8,optimismUSDT:l8,arbitrumUSDT:u8,polygonUSDT:h8,solanaUSDT:p8,solanaSOL:f8};function Bh(e){return Object.values(d8).filter(t=>t.network===e)}var g8=0,H0={paymentAsset:null,amount:null,tokenAmount:0,priceLoading:!1,error:null,exchanges:[],isLoading:!1,currentPayment:void 0,isPaymentInProgress:!1,paymentId:"",assets:[]},Q=lt(H0),bs={state:Q,subscribe(e){return $t(Q,()=>e(Q))},subscribeKey(e,t){return ut(Q,e,t)},resetState(){Object.assign(Q,{...H0})},async getAssetsForNetwork(e){let t=Bh(e),r=await bs.getAssetsImageAndPrice(t),s=t.map(n=>{let i=n.asset==="native"?Kn():`${n.network}:${n.asset}`,o=r.find(a=>a.fungibles?.[0]?.address?.toLowerCase()===i.toLowerCase());return{...n,price:o?.fungibles?.[0]?.price||1,metadata:{...n.metadata,iconUrl:o?.fungibles?.[0]?.iconUrl}}});return Q.assets=s,s},async getAssetsImageAndPrice(e){let t=e.map(s=>s.asset==="native"?Kn():`${s.network}:${s.asset}`);return await Promise.all(t.map(s=>Le.fetchTokenPrice({addresses:[s]})))},getTokenAmount(){if(!Q?.paymentAsset?.price)throw new Error("Cannot get token price");let e=Ce.bigNumber(Q.amount??0).round(8),t=Ce.bigNumber(Q.paymentAsset.price).round(8);return e.div(t).round(8).toNumber()},setAmount(e){Q.amount=e,Q.paymentAsset?.price&&(Q.tokenAmount=bs.getTokenAmount())},setPaymentAsset(e){Q.paymentAsset=e},isPayWithExchangeEnabled(){return Oe.state.remoteFeatures?.payWithExchange},isPayWithExchangeSupported(){return bs.isPayWithExchangeEnabled()&&J.state.activeCaipNetwork&&Ss.PAY_WITH_EXCHANGE_SUPPORTED_CHAIN_NAMESPACES.includes(J.state.activeCaipNetwork.chainNamespace)},async fetchExchanges(){try{let e=bs.isPayWithExchangeSupported();if(!Q.paymentAsset||!e){Q.exchanges=[],Q.isLoading=!1;return}Q.isLoading=!0;let t=await Nh({page:g8,asset:Aa(Q.paymentAsset.network,Q.paymentAsset.asset),amount:Q.amount?.toString()??"0"});Q.exchanges=t.exchanges.slice(0,2)}catch{throw _e.showError("Unable to get exchanges"),new Error("Unable to get exchanges")}finally{Q.isLoading=!1}},async getPayUrl(e,t){try{let r=Number(t.amount),s=await Rh({exchangeId:e,asset:Aa(t.network,t.asset),amount:r.toString(),recipient:`${t.network}:${t.recipient}`});return nt.sendEvent({type:"track",event:"PAY_EXCHANGE_SELECTED",properties:{exchange:{id:e},configuration:{network:t.network,asset:t.asset,recipient:t.recipient,amount:r},currentPayment:{type:"exchange",exchangeId:e},source:"fund-from-exchange",headless:!1}}),s}catch(r){throw r instanceof Error&&r.message.includes("is not supported")?new Error("Asset not supported"):new Error(r.message)}},async handlePayWithExchange(e){try{let t=J.getAccountData()?.address;if(!t)throw new Error("No account connected");if(!Q.paymentAsset)throw new Error("No payment asset selected");let r=Re.returnOpenHref("","popupWindow","scrollbar=yes,width=480,height=720");if(!r)throw new Error("Could not create popup window");Q.isPaymentInProgress=!0,Q.paymentId=crypto.randomUUID(),Q.currentPayment={type:"exchange",exchangeId:e};let{network:s,asset:n}=Q.paymentAsset,i={network:s,asset:n,amount:Q.tokenAmount,recipient:t},o=await bs.getPayUrl(e,i);if(!o){try{r.close()}catch(a){console.error("Unable to close popup window",a)}throw new Error("Unable to initiate payment")}Q.currentPayment.sessionId=o.sessionId,Q.currentPayment.status="IN_PROGRESS",Q.currentPayment.exchangeId=e,r.location.href=o.url}catch{Q.error="Unable to initiate payment",_e.showError(Q.error)}},async waitUntilComplete({exchangeId:e,sessionId:t,paymentId:r,retries:s=20}){let n=await bs.getBuyStatus(e,t,r);if(n.status==="SUCCESS"||n.status==="FAILED")return n;if(s===0)throw new Error("Unable to get deposit status");return await new Promise(i=>{setTimeout(i,5e3)}),bs.waitUntilComplete({exchangeId:e,sessionId:t,paymentId:r,retries:s-1})},async getBuyStatus(e,t,r){try{if(!Q.currentPayment)throw new Error("No current payment");let s=await M0({sessionId:t,exchangeId:e});if(Q.currentPayment.status=s.status,s.status==="SUCCESS"||s.status==="FAILED"){let n=J.getAccountData()?.address;Q.currentPayment.result=s.txHash,Q.isPaymentInProgress=!1,nt.sendEvent({type:"track",event:s.status==="SUCCESS"?"PAY_SUCCESS":"PAY_ERROR",properties:{message:s.status==="FAILED"?Re.parseError(Q.error):void 0,source:"fund-from-exchange",paymentId:r,configuration:{network:Q.paymentAsset?.network||"",asset:Q.paymentAsset?.asset||"",recipient:n||"",amount:Q.amount??0},currentPayment:{type:"exchange",exchangeId:Q.currentPayment?.exchangeId,sessionId:Q.currentPayment?.sessionId,result:s.txHash}}})}return s}catch{return{status:"UNKNOWN",txHash:""}}},reset(){Q.currentPayment=void 0,Q.isPaymentInProgress=!1,Q.paymentId="",Q.paymentAsset=null,Q.amount=0,Q.tokenAmount=0,Q.priceLoading=!1,Q.error=null,Q.exchanges=[],Q.isLoading=!1}};m();w();y();var m8={isUnsupportedChainView(){return ye.state.view==="UnsupportedChain"||ye.state.view==="SwitchNetwork"&&ye.state.history.includes("UnsupportedChain")},async safeClose(){if(this.isUnsupportedChainView()){St.shake();return}if(await Gt.isSIWXCloseDisabled()){St.shake();return}(ye.state.view==="DataCapture"||ye.state.view==="DataCaptureOtpConfirm")&&ht.disconnect(),St.close()}};m();w();y();m();w();y();var ur=lt({message:"",open:!1,triggerRect:{width:0,height:0,top:0,left:0},variant:"shade"}),y8={state:ur,subscribe(e){return $t(ur,()=>e(ur))},subscribeKey(e,t){return ut(ur,e,t)},showTooltip({message:e,triggerRect:t,variant:r}){ur.open=!0,ur.message=e,ur.triggerRect=t,ur.variant=r},hide(){ur.open=!1,ur.message="",ur.triggerRect={width:0,height:0,top:0,left:0}}},w8=Wt(y8);m();w();y();var b8={interpolate(e,t,r){if(e.length!==2||t.length!==2)throw new Error("inputRange and outputRange must be an array of length 2");let s=e[0]||0,n=e[1]||0,i=t[0]||0,o=t[1]||0;return r<s?i:r>n?o:(o-i)/(n-s)*(r-s)+i}};m();w();y();m();w();y();var V0={black:"#202020",white:"#FFFFFF",white010:"rgba(255, 255, 255, 0.1)",accent010:"rgba(9, 136, 240, 0.1)",accent020:"rgba(9, 136, 240, 0.2)",accent030:"rgba(9, 136, 240, 0.3)",accent040:"rgba(9, 136, 240, 0.4)",accent050:"rgba(9, 136, 240, 0.5)",accent060:"rgba(9, 136, 240, 0.6)",accent070:"rgba(9, 136, 240, 0.7)",accent080:"rgba(9, 136, 240, 0.8)",accent090:"rgba(9, 136, 240, 0.9)",accent100:"rgba(9, 136, 240, 1.0)",accentSecondary010:"rgba(199, 185, 148, 0.1)",accentSecondary020:"rgba(199, 185, 148, 0.2)",accentSecondary030:"rgba(199, 185, 148, 0.3)",accentSecondary040:"rgba(199, 185, 148, 0.4)",accentSecondary050:"rgba(199, 185, 148, 0.5)",accentSecondary060:"rgba(199, 185, 148, 0.6)",accentSecondary070:"rgba(199, 185, 148, 0.7)",accentSecondary080:"rgba(199, 185, 148, 0.8)",accentSecondary090:"rgba(199, 185, 148, 0.9)",accentSecondary100:"rgba(199, 185, 148, 1.0)",productWalletKit:"#FFB800",productAppKit:"#FF573B",productCloud:"#0988F0",productDocumentation:"#008847",neutrals050:"#F6F6F6",neutrals100:"#F3F3F3",neutrals200:"#E9E9E9",neutrals300:"#D0D0D0",neutrals400:"#BBB",neutrals500:"#9A9A9A",neutrals600:"#6C6C6C",neutrals700:"#4F4F4F",neutrals800:"#363636",neutrals900:"#2A2A2A",neutrals1000:"#252525",semanticSuccess010:"rgba(48, 164, 107, 0.1)",semanticSuccess020:"rgba(48, 164, 107, 0.2)",semanticSuccess030:"rgba(48, 164, 107, 0.3)",semanticSuccess040:"rgba(48, 164, 107, 0.4)",semanticSuccess050:"rgba(48, 164, 107, 0.5)",semanticSuccess060:"rgba(48, 164, 107, 0.6)",semanticSuccess070:"rgba(48, 164, 107, 0.7)",semanticSuccess080:"rgba(48, 164, 107, 0.8)",semanticSuccess090:"rgba(48, 164, 107, 0.9)",semanticSuccess100:"rgba(48, 164, 107, 1.0)",semanticError010:"rgba(223, 74, 52, 0.1)",semanticError020:"rgba(223, 74, 52, 0.2)",semanticError030:"rgba(223, 74, 52, 0.3)",semanticError040:"rgba(223, 74, 52, 0.4)",semanticError050:"rgba(223, 74, 52, 0.5)",semanticError060:"rgba(223, 74, 52, 0.6)",semanticError070:"rgba(223, 74, 52, 0.7)",semanticError080:"rgba(223, 74, 52, 0.8)",semanticError090:"rgba(223, 74, 52, 0.9)",semanticError100:"rgba(223, 74, 52, 1.0)",semanticWarning010:"rgba(243, 161, 63, 0.1)",semanticWarning020:"rgba(243, 161, 63, 0.2)",semanticWarning030:"rgba(243, 161, 63, 0.3)",semanticWarning040:"rgba(243, 161, 63, 0.4)",semanticWarning050:"rgba(243, 161, 63, 0.5)",semanticWarning060:"rgba(243, 161, 63, 0.6)",semanticWarning070:"rgba(243, 161, 63, 0.7)",semanticWarning080:"rgba(243, 161, 63, 0.8)",semanticWarning090:"rgba(243, 161, 63, 0.9)",semanticWarning100:"rgba(243, 161, 63, 1.0)"},Di={core:{backgroundAccentPrimary:"#0988F0",backgroundAccentCertified:"#C7B994",backgroundWalletKit:"#FFB800",backgroundAppKit:"#FF573B",backgroundCloud:"#0988F0",backgroundDocumentation:"#008847",backgroundSuccess:"rgba(48, 164, 107, 0.20)",backgroundError:"rgba(223, 74, 52, 0.20)",backgroundWarning:"rgba(243, 161, 63, 0.20)",textAccentPrimary:"#0988F0",textAccentCertified:"#C7B994",textWalletKit:"#FFB800",textAppKit:"#FF573B",textCloud:"#0988F0",textDocumentation:"#008847",textSuccess:"#30A46B",textError:"#DF4A34",textWarning:"#F3A13F",borderAccentPrimary:"#0988F0",borderSecondary:"#C7B994",borderSuccess:"#30A46B",borderError:"#DF4A34",borderWarning:"#F3A13F",foregroundAccent010:"rgba(9, 136, 240, 0.1)",foregroundAccent020:"rgba(9, 136, 240, 0.2)",foregroundAccent040:"rgba(9, 136, 240, 0.4)",foregroundAccent060:"rgba(9, 136, 240, 0.6)",foregroundSecondary020:"rgba(199, 185, 148, 0.2)",foregroundSecondary040:"rgba(199, 185, 148, 0.4)",foregroundSecondary060:"rgba(199, 185, 148, 0.6)",iconAccentPrimary:"#0988F0",iconAccentCertified:"#C7B994",iconSuccess:"#30A46B",iconError:"#DF4A34",iconWarning:"#F3A13F",glass010:"rgba(255, 255, 255, 0.1)",zIndex:"9999"},dark:{overlay:"rgba(0, 0, 0, 0.50)",backgroundPrimary:"#202020",backgroundInvert:"#FFFFFF",textPrimary:"#FFFFFF",textSecondary:"#9A9A9A",textTertiary:"#BBBBBB",textInvert:"#202020",borderPrimary:"#2A2A2A",borderPrimaryDark:"#363636",borderSecondary:"#4F4F4F",foregroundPrimary:"#252525",foregroundSecondary:"#2A2A2A",foregroundTertiary:"#363636",iconDefault:"#9A9A9A",iconInverse:"#FFFFFF"},light:{overlay:"rgba(230 , 230, 230, 0.5)",backgroundPrimary:"#FFFFFF",borderPrimaryDark:"#E9E9E9",backgroundInvert:"#202020",textPrimary:"#202020",textSecondary:"#9A9A9A",textTertiary:"#6C6C6C",textInvert:"#FFFFFF",borderPrimary:"#E9E9E9",borderSecondary:"#D0D0D0",foregroundPrimary:"#F3F3F3",foregroundSecondary:"#E9E9E9",foregroundTertiary:"#D0D0D0",iconDefault:"#9A9A9A",iconInverse:"#202020"}},K0={1:"4px",2:"8px",10:"10px",3:"12px",4:"16px",6:"24px",5:"20px",8:"32px",16:"64px",20:"80px",32:"128px",64:"256px",128:"512px",round:"9999px"},G0={0:"0px","01":"2px",1:"4px",2:"8px",3:"12px",4:"16px",5:"20px",6:"24px",7:"28px",8:"32px",9:"36px",10:"40px",12:"48px",14:"56px",16:"64px",20:"80px",32:"128px",64:"256px"},v8={regular:"KHTeka",mono:"KHTekaMono"},x8={regular:"400",medium:"500"},E8={h1:"50px",h2:"44px",h3:"38px",h4:"32px",h5:"26px",h6:"20px",large:"16px",medium:"14px",small:"12px"},S8={"h1-regular-mono":{lineHeight:"50px",letterSpacing:"-3px"},"h1-regular":{lineHeight:"50px",letterSpacing:"-1px"},"h1-medium":{lineHeight:"50px",letterSpacing:"-0.84px"},"h2-regular-mono":{lineHeight:"44px",letterSpacing:"-2.64px"},"h2-regular":{lineHeight:"44px",letterSpacing:"-0.88px"},"h2-medium":{lineHeight:"44px",letterSpacing:"-0.88px"},"h3-regular-mono":{lineHeight:"38px",letterSpacing:"-2.28px"},"h3-regular":{lineHeight:"38px",letterSpacing:"-0.76px"},"h3-medium":{lineHeight:"38px",letterSpacing:"-0.76px"},"h4-regular-mono":{lineHeight:"32px",letterSpacing:"-1.92px"},"h4-regular":{lineHeight:"32px",letterSpacing:"-0.32px"},"h4-medium":{lineHeight:"32px",letterSpacing:"-0.32px"},"h5-regular-mono":{lineHeight:"26px",letterSpacing:"-1.56px"},"h5-regular":{lineHeight:"26px",letterSpacing:"-0.26px"},"h5-medium":{lineHeight:"26px",letterSpacing:"-0.26px"},"h6-regular-mono":{lineHeight:"20px",letterSpacing:"-1.2px"},"h6-regular":{lineHeight:"20px",letterSpacing:"-0.6px"},"h6-medium":{lineHeight:"20px",letterSpacing:"-0.6px"},"lg-regular-mono":{lineHeight:"16px",letterSpacing:"-0.96px"},"lg-regular":{lineHeight:"18px",letterSpacing:"-0.16px"},"lg-medium":{lineHeight:"18px",letterSpacing:"-0.16px"},"md-regular-mono":{lineHeight:"14px",letterSpacing:"-0.84px"},"md-regular":{lineHeight:"16px",letterSpacing:"-0.14px"},"md-medium":{lineHeight:"16px",letterSpacing:"-0.14px"},"sm-regular-mono":{lineHeight:"12px",letterSpacing:"-0.72px"},"sm-regular":{lineHeight:"14px",letterSpacing:"-0.12px"},"sm-medium":{lineHeight:"14px",letterSpacing:"-0.12px"}},C8={"ease-out-power-2":"cubic-bezier(0.23, 0.09, 0.08, 1.13)","ease-out-power-1":"cubic-bezier(0.12, 0.04, 0.2, 1.06)","ease-in-power-2":"cubic-bezier(0.92, -0.13, 0.77, 0.91)","ease-in-power-1":"cubic-bezier(0.88, -0.06, 0.8, 0.96)","ease-inout-power-2":"cubic-bezier(0.77, 0.09, 0.23, 1.13)","ease-inout-power-1":"cubic-bezier(0.88, 0.04, 0.12, 1.06)"},I8={xl:"400ms",lg:"200ms",md:"125ms",sm:"75ms"},Pa={colors:V0,fontFamily:v8,fontWeight:x8,textSize:E8,typography:S8,tokens:{core:Di.core,theme:Di.dark},borderRadius:K0,spacing:G0,durations:I8,easings:C8};var W0="--apkt";function Oa(e){if(!e)return{};let t={};return t["font-family"]=e["--apkt-font-family"]??e["--w3m-font-family"]??"KHTeka",t.accent=e["--apkt-accent"]??e["--w3m-accent"]??"#0988F0",t["color-mix"]=e["--apkt-color-mix"]??e["--w3m-color-mix"]??"#000",t["color-mix-strength"]=e["--apkt-color-mix-strength"]??e["--w3m-color-mix-strength"]??0,t["font-size-master"]=e["--apkt-font-size-master"]??e["--w3m-font-size-master"]??"10px",t["border-radius-master"]=e["--apkt-border-radius-master"]??e["--w3m-border-radius-master"]??"4px",e["--apkt-z-index"]!==void 0?t["z-index"]=e["--apkt-z-index"]:e["--w3m-z-index"]!==void 0&&(t["z-index"]=e["--w3m-z-index"]),t}var Sr={createCSSVariables(e){let t={},r={};function s(i,o,a=""){for(let[c,l]of Object.entries(i)){let u=a?`${a}-${c}`:c;l&&typeof l=="object"&&Object.keys(l).length?(o[c]={},s(l,o[c],u)):typeof l=="string"&&(o[c]=`${W0}-${u}`)}}function n(i,o){for(let[a,c]of Object.entries(i))c&&typeof c=="object"?(o[a]={},n(c,o[a])):typeof c=="string"&&(o[a]=`var(${c})`)}return s(e,t),n(t,r),{cssVariables:t,cssVariablesVarPrefix:r}},assignCSSVariables(e,t){let r={};function s(n,i,o){for(let[a,c]of Object.entries(n)){let l=o?`${o}-${a}`:a,u=i[a];c&&typeof c=="object"?s(c,u,l):typeof u=="string"&&(r[`${W0}-${l}`]=u)}}return s(e,t),r},createRootStyles(e,t){let r={...Pa,tokens:{...Pa.tokens,theme:e==="light"?Di.light:Di.dark}},{cssVariables:s}=Sr.createCSSVariables(r),n=Sr.assignCSSVariables(s,r),i=Sr.generateW3MVariables(t),o=Sr.generateW3MOverrides(t),a=Sr.generateScaledVariables(t),c=Sr.generateBaseVariables(n),l={...n,...c,...i,...o,...a},u=Sr.applyColorMixToVariables(t,l),h={...l,...u};return`:root {${Object.entries(h).map(([f,g])=>`${f}:${g.replace("/[:;{}</>]/g","")};`).join("")}}`},generateW3MVariables(e){if(!e)return{};let t=Oa(e),r={};return r["--w3m-font-family"]=t["font-family"],r["--w3m-accent"]=t.accent,r["--w3m-color-mix"]=t["color-mix"],r["--w3m-color-mix-strength"]=`${t["color-mix-strength"]}%`,r["--w3m-font-size-master"]=t["font-size-master"],r["--w3m-border-radius-master"]=t["border-radius-master"],r},generateW3MOverrides(e){if(!e)return{};let t=Oa(e),r={};if(e["--apkt-accent"]||e["--w3m-accent"]){let s=t.accent;r["--apkt-tokens-core-iconAccentPrimary"]=s,r["--apkt-tokens-core-borderAccentPrimary"]=s,r["--apkt-tokens-core-textAccentPrimary"]=s,r["--apkt-tokens-core-backgroundAccentPrimary"]=s}return(e["--apkt-font-family"]||e["--w3m-font-family"])&&(r["--apkt-fontFamily-regular"]=t["font-family"]),t["z-index"]!==void 0&&(r["--apkt-tokens-core-zIndex"]=`${t["z-index"]}`),r},generateScaledVariables(e){if(!e)return{};let t=Oa(e),r={};if(e["--apkt-font-size-master"]||e["--w3m-font-size-master"]){let s=parseFloat(t["font-size-master"].replace("px",""));r["--apkt-textSize-h1"]=`${Number(s)*5}px`,r["--apkt-textSize-h2"]=`${Number(s)*4.4}px`,r["--apkt-textSize-h3"]=`${Number(s)*3.8}px`,r["--apkt-textSize-h4"]=`${Number(s)*3.2}px`,r["--apkt-textSize-h5"]=`${Number(s)*2.6}px`,r["--apkt-textSize-h6"]=`${Number(s)*2}px`,r["--apkt-textSize-large"]=`${Number(s)*1.6}px`,r["--apkt-textSize-medium"]=`${Number(s)*1.4}px`,r["--apkt-textSize-small"]=`${Number(s)*1.2}px`}if(e["--apkt-border-radius-master"]||e["--w3m-border-radius-master"]){let s=parseFloat(t["border-radius-master"].replace("px",""));r["--apkt-borderRadius-1"]=`${Number(s)}px`,r["--apkt-borderRadius-2"]=`${Number(s)*2}px`,r["--apkt-borderRadius-3"]=`${Number(s)*3}px`,r["--apkt-borderRadius-4"]=`${Number(s)*4}px`,r["--apkt-borderRadius-5"]=`${Number(s)*5}px`,r["--apkt-borderRadius-6"]=`${Number(s)*6}px`,r["--apkt-borderRadius-8"]=`${Number(s)*8}px`,r["--apkt-borderRadius-16"]=`${Number(s)*16}px`,r["--apkt-borderRadius-20"]=`${Number(s)*20}px`,r["--apkt-borderRadius-32"]=`${Number(s)*32}px`,r["--apkt-borderRadius-64"]=`${Number(s)*64}px`,r["--apkt-borderRadius-128"]=`${Number(s)*128}px`}return r},generateColorMixCSS(e,t){if(!e?.["--w3m-color-mix"]||!e["--w3m-color-mix-strength"])return"";let r=e["--w3m-color-mix"],s=e["--w3m-color-mix-strength"];if(!s||s===0)return"";let n=Object.keys(t||{}).filter(o=>{let a=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon"),c=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return a&&!c});return n.length===0?"":` @supports (background: color-mix(in srgb, white 50%, black)) {
      :root {
        ${n.map(o=>{let a=t?.[o]||"";return a.includes("color-mix")||a.startsWith("#")||a.startsWith("rgb")?`${o}: color-mix(in srgb, ${r} ${s}%, ${a});`:`${o}: color-mix(in srgb, ${r} ${s}%, var(${o}-base, ${a}));`}).join("")}
      }
    }`},generateBaseVariables(e){let t={},r=e["--apkt-tokens-theme-backgroundPrimary"];r&&(t["--apkt-tokens-theme-backgroundPrimary-base"]=r);let s=e["--apkt-tokens-core-backgroundAccentPrimary"];return s&&(t["--apkt-tokens-core-backgroundAccentPrimary-base"]=s),t},applyColorMixToVariables(e,t){let r={};t?.["--apkt-tokens-theme-backgroundPrimary"]&&(r["--apkt-tokens-theme-backgroundPrimary"]="var(--apkt-tokens-theme-backgroundPrimary-base)"),t?.["--apkt-tokens-core-backgroundAccentPrimary"]&&(r["--apkt-tokens-core-backgroundAccentPrimary"]="var(--apkt-tokens-core-backgroundAccentPrimary-base)");let s=Oa(e),n=s["color-mix"],i=s["color-mix-strength"];if(!i||i===0)return r;let o=Object.keys(t||{}).filter(a=>{let c=a.includes("-tokens-core-background")||a.includes("-tokens-core-text")||a.includes("-tokens-core-border")||a.includes("-tokens-core-foreground")||a.includes("-tokens-core-icon")||a.includes("-tokens-theme-background")||a.includes("-tokens-theme-text")||a.includes("-tokens-theme-border")||a.includes("-tokens-theme-foreground")||a.includes("-tokens-theme-icon")||a.includes("-tokens-theme-overlay"),l=a.includes("-borderRadius-")||a.includes("-spacing-")||a.includes("-textSize-")||a.includes("-fontFamily-")||a.includes("-fontWeight-")||a.includes("-typography-")||a.includes("-duration-")||a.includes("-ease-")||a.includes("-path-")||a.includes("-width-")||a.includes("-height-")||a.includes("-visual-size-")||a.includes("-modal-width")||a.includes("-cover");return c&&!l});return o.length===0||o.forEach(a=>{let c=t?.[a]||"";a.endsWith("-base")||(a==="--apkt-tokens-theme-backgroundPrimary"||a==="--apkt-tokens-core-backgroundAccentPrimary"?r[a]=`color-mix(in srgb, ${n} ${i}%, var(${a}-base))`:c.includes("color-mix")||c.startsWith("#")||c.startsWith("rgb")?r[a]=`color-mix(in srgb, ${n} ${i}%, ${c})`:r[a]=`color-mix(in srgb, ${n} ${i}%, var(${a}-base, ${c}))`)}),r}},{cssVariablesVarPrefix:Ne}=Sr.createCSSVariables(Pa);function Lh(e,...t){return pt(e,...t.map(r=>typeof r=="function"?Dt(r(Ne)):Dt(r)))}m();w();y();var Qs,en,Cr,hr,ka,Vr={"KHTeka-500-woff2":"https://fonts.reown.com/KHTeka-Medium.woff2","KHTeka-400-woff2":"https://fonts.reown.com/KHTeka-Regular.woff2","KHTeka-300-woff2":"https://fonts.reown.com/KHTeka-Light.woff2","KHTekaMono-400-woff2":"https://fonts.reown.com/KHTekaMono-Regular.woff2","KHTeka-500-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTeka-400-woff":"https://fonts.reown.com/KHTeka-Regular.woff","KHTeka-300-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTekaMono-400-woff":"https://fonts.reown.com/KHTekaMono-Regular.woff"};function Na(e,t="dark"){Qs&&document.head.removeChild(Qs),Qs=document.createElement("style"),Qs.textContent=Sr.createRootStyles(t,e),document.head.appendChild(Qs)}function _8(e,t="dark"){if(ka=e,en=document.createElement("style"),Cr=document.createElement("style"),hr=document.createElement("style"),en.textContent=Mn(e).core.cssText,Cr.textContent=Mn(e).dark.cssText,hr.textContent=Mn(e).light.cssText,document.head.appendChild(en),document.head.appendChild(Cr),document.head.appendChild(hr),Na(e,t),Uh(t),!(e?.["--apkt-font-family"]||e?.["--w3m-font-family"]))for(let[s,n]of Object.entries(Vr)){let i=document.createElement("link");i.rel="preload",i.href=n,i.as="font",i.type=s.includes("woff2")?"font/woff2":"font/woff",i.crossOrigin="anonymous",document.head.appendChild(i)}Uh(t)}function Uh(e="dark"){Cr&&hr&&Qs&&(e==="light"?(Na(ka,e),Cr.removeAttribute("media"),hr.media="enabled"):(Na(ka,e),hr.removeAttribute("media"),Cr.media="enabled"))}function T8(e){if(ka=e,en&&Cr&&hr){en.textContent=Mn(e).core.cssText,Cr.textContent=Mn(e).dark.cssText,hr.textContent=Mn(e).light.cssText;let t=e?.["--apkt-font-family"]||e?.["--w3m-font-family"];t&&(en.textContent=en.textContent?.replace("font-family: KHTeka",`font-family: ${t}`),Cr.textContent=Cr.textContent?.replace("font-family: KHTeka",`font-family: ${t}`),hr.textContent=hr.textContent?.replace("font-family: KHTeka",`font-family: ${t}`))}if(Qs){let t=hr?.media==="enabled"?"light":"dark";Na(e,t)}}function Mn(e){let t=!!(e?.["--apkt-font-family"]||e?.["--w3m-font-family"]);return{core:pt`
      ${t?pt``:pt`
            @font-face {
              font-family: 'KHTeka';
              src:
                url(${Dt(Vr["KHTeka-400-woff2"])}) format('woff2'),
                url(${Dt(Vr["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
              font-display: swap;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${Dt(Vr["KHTeka-300-woff2"])}) format('woff2'),
                url(${Dt(Vr["KHTeka-300-woff"])}) format('woff');
              font-weight: 300;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTekaMono';
              src:
                url(${Dt(Vr["KHTekaMono-400-woff2"])}) format('woff2'),
                url(${Dt(Vr["KHTekaMono-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${Dt(Vr["KHTeka-400-woff2"])}) format('woff2'),
                url(${Dt(Vr["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }
          `}

      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --apkt-modal-width: 370px;

        --apkt-visual-size-inherit: inherit;
        --apkt-visual-size-sm: 40px;
        --apkt-visual-size-md: 55px;
        --apkt-visual-size-lg: 80px;

        --apkt-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --apkt-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --apkt-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --apkt-width-network-sm: 36px;
        --apkt-width-network-md: 48px;
        --apkt-width-network-lg: 86px;

        --apkt-duration-dynamic: 0ms;
        --apkt-height-network-sm: 40px;
        --apkt-height-network-md: 54px;
        --apkt-height-network-lg: 96px;
      }
    `,dark:pt`
      :root {
      }
    `,light:pt`
      :root {
      }
    `}}var zn=pt`
  div,
  span,
  iframe,
  a,
  img,
  form,
  button,
  label,
  *::after,
  *::before {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    backface-visibility: hidden;
  }

  :host {
    font-family: var(--apkt-fontFamily-regular);
  }
`,TR=pt`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;

    will-change: background-color, color, border, box-shadow, width, height, transform, opacity;
    outline: none;
    border: none;
    text-decoration: none;
    transition:
      background-color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      box-shadow var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      width var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      height var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      transform var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      opacity var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      scale var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border-radius var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2);
    will-change:
      background-color, color, border, box-shadow, width, height, transform, opacity, scale,
      border-radius;
  }

  a:active:not([disabled]),
  button:active:not([disabled]) {
    scale: 0.975;
    transform-origin: center;
  }

  button:disabled {
    cursor: default;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`;m();w();y();var Ra=".",Lt={getSpacingStyles(e,t){if(Array.isArray(e))return e[t]?`var(--apkt-spacing-${e[t]})`:void 0;if(typeof e=="string")return`var(--apkt-spacing-${e})`},getFormattedDate(e){return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(e)},formatCurrency(e=0,t={}){let r=Number(e);return isNaN(r)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2,...t}).format(r)},getHostName(e){try{return new URL(e).hostname}catch{return""}},getTruncateString({string:e,charsStart:t,charsEnd:r,truncate:s}){return e.length<=t+r?e:s==="end"?`${e.substring(0,t)}...`:s==="start"?`...${e.substring(e.length-r)}`:`${e.substring(0,Math.floor(t))}...${e.substring(e.length-Math.floor(r))}`},generateAvatarColors(e){let r=e.toLowerCase().replace(/^0x/iu,"").replace(/[^a-f0-9]/gu,"").substring(0,6).padEnd(6,"0"),s=this.hexToRgb(r),n=getComputedStyle(document.documentElement).getPropertyValue("--w3m-border-radius-master"),o=100-3*Number(n?.replace("px","")),a=`${o}% ${o}% at 65% 40%`,c=[];for(let l=0;l<5;l+=1){let u=this.tintColor(s,.15*l);c.push(`rgb(${u[0]}, ${u[1]}, ${u[2]})`)}return`
    --local-color-1: ${c[0]};
    --local-color-2: ${c[1]};
    --local-color-3: ${c[2]};
    --local-color-4: ${c[3]};
    --local-color-5: ${c[4]};
    --local-radial-circle: ${a}
   `},hexToRgb(e){let t=parseInt(e,16),r=t>>16&255,s=t>>8&255,n=t&255;return[r,s,n]},tintColor(e,t){let[r,s,n]=e,i=Math.round(r+(255-r)*t),o=Math.round(s+(255-s)*t),a=Math.round(n+(255-n)*t);return[i,o,a]},isNumber(e){return{number:/^[0-9]+$/u}.number.test(e)},getColorTheme(e){return e||(typeof window<"u"&&window.matchMedia&&typeof window.matchMedia=="function"?window.matchMedia("(prefers-color-scheme: dark)")?.matches?"dark":"light":"dark")},splitBalance(e){let t=e.split(".");return t.length===2?[t[0],t[1]]:["0","00"]},roundNumber(e,t,r){return e.toString().length>=t?Number(e).toFixed(r):e},cssDurationToNumber(e){return e.endsWith("s")?Number(e.replace("s",""))*1e3:e.endsWith("ms")?Number(e.replace("ms","")):0},maskInput({value:e,decimals:t,integers:r}){if(e=e.replace(",","."),e===Ra)return`0${Ra}`;let[s="",n]=e.split(Ra).map(u=>u.replace(/[^0-9]/gu,"")),i=r?s.substring(0,r):s,o=i.length===2?String(Number(i)):i,a=typeof t=="number"?n?.substring(0,t):n,c=typeof t!="number"||t>0;return(typeof a=="string"&&c?[o,a].join(Ra):o)??""},capitalize(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}};m();w();y();function A8(e,t){let{kind:r,elements:s}=t;return{kind:r,elements:s,finisher(n){customElements.get(e)||customElements.define(e,n)}}}function P8(e,t){return customElements.get(e)||customElements.define(e,t),t}function tn(e){return function(r){return typeof r=="function"?P8(e,r):A8(e,r)}}m();w();y();m();w();y();var O8=3,Ba=.1,k8=["receive","deposit","borrow","claim"],N8=["withdraw","repay","burn"],$h={getTransactionGroupTitle(e,t){let r=La.getYear(),s=La.getMonthNameByIndex(t);return e===r?s:`${s} ${e}`},getTransactionImages(e){let[t]=e;return e?.length>1?e.map(s=>this.getTransactionImage(s)):[this.getTransactionImage(t)]},getTransactionImage(e){return{type:$h.getTransactionTransferTokenType(e),url:$h.getTransactionImageURL(e)}},getTransactionImageURL(e){let t,r=!!e?.nft_info,s=!!e?.fungible_info;return e&&r?t=e?.nft_info?.content?.preview?.url:e&&s&&(t=e?.fungible_info?.icon?.url),t},getTransactionTransferTokenType(e){if(e?.fungible_info)return"FUNGIBLE";if(e?.nft_info)return"NFT"},getTransactionDescriptions(e,t){let r=e?.metadata?.operationType,s=t||e?.transfers,n=s&&s.length>0,i=s&&s.length>1,o=n&&s.every(p=>!!p?.fungible_info),[a,c]=s||[],l=this.getTransferDescription(a),u=this.getTransferDescription(c);if(!n)return(r==="send"||r==="receive")&&o?(l=Lt.getTruncateString({string:e?.metadata.sentFrom,charsStart:4,charsEnd:6,truncate:"middle"}),u=Lt.getTruncateString({string:e?.metadata.sentTo,charsStart:4,charsEnd:6,truncate:"middle"}),[l,u]):[e.metadata.status];if(i)return s?.map(p=>this.getTransferDescription(p));let h="";return k8.includes(r)?h="+":N8.includes(r)&&(h="-"),l=h.concat(l),[l]},getTransferDescription(e){let t="";return e&&(e?.nft_info?t=e?.nft_info?.name||"-":e?.fungible_info&&(t=this.getFungibleTransferDescription(e)||"-")),t},getFungibleTransferDescription(e){return e?[this.getQuantityFixedValue(e?.quantity.numeric),e?.fungible_info?.symbol].join(" ").trim():null},mergeTransfers(e){if(e?.length<=1)return e;let r=this.filterGasFeeTransfers(e).reduce((n,i)=>{let o=i?.fungible_info?.name,a=n.find(({fungible_info:c,direction:l})=>o&&o===c?.name&&l===i.direction);if(a){let c=Number(a.quantity.numeric)+Number(i.quantity.numeric);a.quantity.numeric=c.toString(),a.value=(a.value||0)+(i.value||0)}else n.push(i);return n},[]),s=r;return r.length>2&&(s=r.sort((n,i)=>(i.value||0)-(n.value||0)).slice(0,2)),s=s.sort((n,i)=>n.direction==="out"&&i.direction==="in"?-1:n.direction==="in"&&i.direction==="out"?1:0),s},filterGasFeeTransfers(e){let t=e?.reduce((s,n)=>{let i=n?.fungible_info?.name;return i&&(s[i]||(s[i]=[]),s[i].push(n)),s},{}),r=[];return Object.values(t??{}).forEach(s=>{if(s.length===1){let n=s[0];n&&r.push(n)}else{let n=s.filter(o=>o.direction==="in"),i=s.filter(o=>o.direction==="out");if(n.length===1&&i.length===1){let o=n[0],a=i[0],c=!1;if(o&&a){let l=Number(o.quantity.numeric),u=Number(a.quantity.numeric);u<l*Ba?(r.push(o),c=!0):l<u*Ba&&(r.push(a),c=!0)}c||r.push(...s)}else{let o=this.filterGasFeesFromTokenGroup(s);r.push(...o)}}}),e?.forEach(s=>{s?.fungible_info?.name||r.push(s)}),r},filterGasFeesFromTokenGroup(e){if(e.length<=1)return e;let t=e?.map(a=>Number(a.quantity.numeric)),r=Math.max(...t),s=Math.min(...t),n=.01;if(s<r*n)return e?.filter(c=>Number(c.quantity.numeric)>=r*n);let i=e?.filter(a=>a.direction==="in"),o=e?.filter(a=>a.direction==="out");if(i.length===1&&o.length===1){let a=i[0],c=o[0];if(a&&c){let l=Number(a.quantity.numeric),u=Number(c.quantity.numeric);if(u<l*Ba)return[a];if(l<u*Ba)return[c]}}return e},getQuantityFixedValue(e){return e?parseFloat(e).toFixed(O8):null}};m();w();y();m();w();y();m();w();y();var Z0=pt`
  :host {
    display: flex;
    width: inherit;
    height: inherit;
    box-sizing: border-box;
  }
`;var Et=function(e,t,r,s){var n=arguments.length,i=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},tt=class extends cn{render(){return this.style.cssText=`
      flex-direction: ${this.flexDirection};
      flex-wrap: ${this.flexWrap};
      flex-basis: ${this.flexBasis};
      flex-grow: ${this.flexGrow};
      flex-shrink: ${this.flexShrink};
      align-items: ${this.alignItems};
      justify-content: ${this.justifyContent};
      column-gap: ${this.columnGap&&`var(--apkt-spacing-${this.columnGap})`};
      row-gap: ${this.rowGap&&`var(--apkt-spacing-${this.rowGap})`};
      gap: ${this.gap&&`var(--apkt-spacing-${this.gap})`};
      padding-top: ${this.padding&&Lt.getSpacingStyles(this.padding,0)};
      padding-right: ${this.padding&&Lt.getSpacingStyles(this.padding,1)};
      padding-bottom: ${this.padding&&Lt.getSpacingStyles(this.padding,2)};
      padding-left: ${this.padding&&Lt.getSpacingStyles(this.padding,3)};
      margin-top: ${this.margin&&Lt.getSpacingStyles(this.margin,0)};
      margin-right: ${this.margin&&Lt.getSpacingStyles(this.margin,1)};
      margin-bottom: ${this.margin&&Lt.getSpacingStyles(this.margin,2)};
      margin-left: ${this.margin&&Lt.getSpacingStyles(this.margin,3)};
      width: ${this.width};
    `,Ki`<slot></slot>`}};tt.styles=[zn,Z0];Et([Se()],tt.prototype,"flexDirection",void 0);Et([Se()],tt.prototype,"flexWrap",void 0);Et([Se()],tt.prototype,"flexBasis",void 0);Et([Se()],tt.prototype,"flexGrow",void 0);Et([Se()],tt.prototype,"flexShrink",void 0);Et([Se()],tt.prototype,"alignItems",void 0);Et([Se()],tt.prototype,"justifyContent",void 0);Et([Se()],tt.prototype,"columnGap",void 0);Et([Se()],tt.prototype,"rowGap",void 0);Et([Se()],tt.prototype,"gap",void 0);Et([Se()],tt.prototype,"padding",void 0);Et([Se()],tt.prototype,"margin",void 0);Et([Se()],tt.prototype,"width",void 0);tt=Et([tn("wui-flex")],tt);m();w();y();m();w();y();m();w();y();var Y0=Lh`
  slot {
    width: 100%;
    display: inline-block;
    font-style: normal;
    overflow: inherit;
    text-overflow: inherit;
    text-align: var(--local-align);
    color: var(--local-color);
  }

  .wui-line-clamp-1 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 1;
  }

  .wui-line-clamp-2 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
  }

  /* -- Headings --------------------------------------------------- */
  .wui-font-h1-regular-mono {
    font-size: ${({textSize:e})=>e.h1};
    line-height: ${({typography:e})=>e["h1-regular-mono"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h1-regular-mono"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.mono};
  }

  .wui-font-h1-regular {
    font-size: ${({textSize:e})=>e.h1};
    line-height: ${({typography:e})=>e["h1-regular"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h1-regular"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-h1-medium {
    font-size: ${({textSize:e})=>e.h1};
    line-height: ${({typography:e})=>e["h1-medium"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h1-medium"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.medium};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-h2-regular-mono {
    font-size: ${({textSize:e})=>e.h2};
    line-height: ${({typography:e})=>e["h2-regular-mono"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h2-regular-mono"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.mono};
  }

  .wui-font-h2-regular {
    font-size: ${({textSize:e})=>e.h2};
    line-height: ${({typography:e})=>e["h2-regular"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h2-regular"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-h2-medium {
    font-size: ${({textSize:e})=>e.h2};
    line-height: ${({typography:e})=>e["h2-medium"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h2-medium"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.medium};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-h3-regular-mono {
    font-size: ${({textSize:e})=>e.h3};
    line-height: ${({typography:e})=>e["h3-regular-mono"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h3-regular-mono"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.mono};
  }

  .wui-font-h3-regular {
    font-size: ${({textSize:e})=>e.h3};
    line-height: ${({typography:e})=>e["h3-regular"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h3-regular"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-h3-medium {
    font-size: ${({textSize:e})=>e.h3};
    line-height: ${({typography:e})=>e["h3-medium"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h3-medium"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.medium};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-h4-regular-mono {
    font-size: ${({textSize:e})=>e.h4};
    line-height: ${({typography:e})=>e["h4-regular-mono"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h4-regular-mono"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.mono};
  }

  .wui-font-h4-regular {
    font-size: ${({textSize:e})=>e.h4};
    line-height: ${({typography:e})=>e["h4-regular"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h4-regular"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-h4-medium {
    font-size: ${({textSize:e})=>e.h4};
    line-height: ${({typography:e})=>e["h4-medium"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h4-medium"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.medium};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-h5-regular-mono {
    font-size: ${({textSize:e})=>e.h5};
    line-height: ${({typography:e})=>e["h5-regular-mono"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h5-regular-mono"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.mono};
  }

  .wui-font-h5-regular {
    font-size: ${({textSize:e})=>e.h5};
    line-height: ${({typography:e})=>e["h5-regular"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h5-regular"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-h5-medium {
    font-size: ${({textSize:e})=>e.h5};
    line-height: ${({typography:e})=>e["h5-medium"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h5-medium"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.medium};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-h6-regular-mono {
    font-size: ${({textSize:e})=>e.h6};
    line-height: ${({typography:e})=>e["h6-regular-mono"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h6-regular-mono"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.mono};
  }

  .wui-font-h6-regular {
    font-size: ${({textSize:e})=>e.h6};
    line-height: ${({typography:e})=>e["h6-regular"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h6-regular"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-h6-medium {
    font-size: ${({textSize:e})=>e.h6};
    line-height: ${({typography:e})=>e["h6-medium"].lineHeight};
    letter-spacing: ${({typography:e})=>e["h6-medium"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.medium};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-lg-regular-mono {
    font-size: ${({textSize:e})=>e.large};
    line-height: ${({typography:e})=>e["lg-regular-mono"].lineHeight};
    letter-spacing: ${({typography:e})=>e["lg-regular-mono"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.mono};
  }

  .wui-font-lg-regular {
    font-size: ${({textSize:e})=>e.large};
    line-height: ${({typography:e})=>e["lg-regular"].lineHeight};
    letter-spacing: ${({typography:e})=>e["lg-regular"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-lg-medium {
    font-size: ${({textSize:e})=>e.large};
    line-height: ${({typography:e})=>e["lg-medium"].lineHeight};
    letter-spacing: ${({typography:e})=>e["lg-medium"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.medium};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-md-regular-mono {
    font-size: ${({textSize:e})=>e.medium};
    line-height: ${({typography:e})=>e["md-regular-mono"].lineHeight};
    letter-spacing: ${({typography:e})=>e["md-regular-mono"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.mono};
  }

  .wui-font-md-regular {
    font-size: ${({textSize:e})=>e.medium};
    line-height: ${({typography:e})=>e["md-regular"].lineHeight};
    letter-spacing: ${({typography:e})=>e["md-regular"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-md-medium {
    font-size: ${({textSize:e})=>e.medium};
    line-height: ${({typography:e})=>e["md-medium"].lineHeight};
    letter-spacing: ${({typography:e})=>e["md-medium"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.medium};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-sm-regular-mono {
    font-size: ${({textSize:e})=>e.small};
    line-height: ${({typography:e})=>e["sm-regular-mono"].lineHeight};
    letter-spacing: ${({typography:e})=>e["sm-regular-mono"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.mono};
  }

  .wui-font-sm-regular {
    font-size: ${({textSize:e})=>e.small};
    line-height: ${({typography:e})=>e["sm-regular"].lineHeight};
    letter-spacing: ${({typography:e})=>e["sm-regular"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.regular};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }

  .wui-font-sm-medium {
    font-size: ${({textSize:e})=>e.small};
    line-height: ${({typography:e})=>e["sm-medium"].lineHeight};
    letter-spacing: ${({typography:e})=>e["sm-medium"].letterSpacing};
    font-weight: ${({fontWeight:e})=>e.medium};
    font-family: ${({fontFamily:e})=>e.regular};
    font-feature-settings:
      'liga' off,
      'clig' off;
  }
`;var Hn=function(e,t,r,s){var n=arguments.length,i=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},R8={primary:Ne.tokens.theme.textPrimary,secondary:Ne.tokens.theme.textSecondary,tertiary:Ne.tokens.theme.textTertiary,invert:Ne.tokens.theme.textInvert,error:Ne.tokens.core.textError,success:Ne.tokens.core.textSuccess,warning:Ne.tokens.core.textWarning,"accent-primary":Ne.tokens.core.textAccentPrimary},vs=class extends cn{constructor(){super(...arguments),this.variant="md-regular",this.color="inherit",this.align="left",this.lineClamp=void 0,this.display="inline-flex"}render(){let t={[`wui-font-${this.variant}`]:!0,[`wui-line-clamp-${this.lineClamp}`]:!!this.lineClamp};return this.style.cssText=`
      display: ${this.display};
      --local-align: ${this.align};
      --local-color: ${this.color==="inherit"?"inherit":R8[this.color??"primary"]};
      `,Ki`<slot class=${lp(t)}></slot>`}};vs.styles=[zn,Y0];Hn([Se()],vs.prototype,"variant",void 0);Hn([Se()],vs.prototype,"color",void 0);Hn([Se()],vs.prototype,"align",void 0);Hn([Se()],vs.prototype,"lineClamp",void 0);Hn([Se()],vs.prototype,"display",void 0);vs=Hn([tn("wui-text")],vs);m();w();y();m();w();y();var X0=ee`<svg width="30" height="30" viewBox="0 0 30 30" fill="none">
  <g clip-path="url(#clip0_87_33)">
    <path d="M23.9367 2.29447e-07H6.05917C5.26333 -0.000218805 4.47526 0.156384 3.73997 0.46086C3.00469 0.765337 2.33661 1.21172 1.77391 1.7745C1.21121 2.33727 0.764917 3.00542 0.460542 3.74074C0.156167 4.47607 -0.000327963 5.26417 5.16031e-07 6.06V23.9433C4.48257e-07 24.7389 0.156744 25.5267 0.461276 26.2617C0.765808 26.9967 1.21216 27.6645 1.77484 28.2269C2.33752 28.7894 3.0055 29.2355 3.74061 29.5397C4.47573 29.8439 5.26358 30.0003 6.05917 30H23.9417C25.5486 29.9996 27.0895 29.3609 28.2257 28.2245C29.3618 27.0881 30 25.5469 30 23.94V6.06C29.9993 4.45241 29.3602 2.91091 28.2232 1.77449C27.0861 0.638064 25.5443 -0.000220881 23.9367 2.29447e-07Z" fill="url(#paint0_linear_87_33)"/>
    <path d="M14.8708 6.89259L15.4783 5.84259C15.5679 5.68703 15.6873 5.55064 15.8296 5.44122C15.9719 5.3318 16.1344 5.25148 16.3078 5.20486C16.4812 5.15824 16.662 5.14622 16.8401 5.1695C17.0181 5.19277 17.1898 5.25088 17.3453 5.34051C17.5009 5.43013 17.6373 5.54952 17.7467 5.69186C17.8561 5.83419 17.9364 5.99669 17.9831 6.17006C18.0297 6.34344 18.0417 6.5243 18.0184 6.70232C17.9952 6.88034 17.9371 7.05203 17.8474 7.20759L11.9949 17.3401H16.2283C17.5999 17.3401 18.3691 18.9526 17.7724 20.0701H5.36159C5.18215 20.0707 5.00436 20.0359 4.83845 19.9675C4.67254 19.8992 4.5218 19.7986 4.39492 19.6718C4.26803 19.5449 4.16751 19.3941 4.09915 19.2282C4.03079 19.0623 3.99593 18.8845 3.99659 18.7051C3.99659 17.9476 4.60492 17.3401 5.36159 17.3401H8.84159L13.2958 9.61926L11.9041 7.20426C11.738 6.89096 11.7 6.52543 11.7982 6.18469C11.8963 5.84395 12.1229 5.5546 12.4301 5.37763C12.7374 5.20065 13.1014 5.14987 13.4454 5.23599C13.7893 5.3221 14.0864 5.53838 14.2741 5.83926L14.8708 6.89259ZM9.60659 21.4759L8.29409 23.7526C8.20446 23.9082 8.08506 24.0446 7.94271 24.1541C7.80035 24.2636 7.63783 24.344 7.46441 24.3906C7.291 24.4373 7.11009 24.4493 6.93202 24.4261C6.75395 24.4028 6.58221 24.3447 6.42659 24.2551C6.27097 24.1655 6.13454 24.0461 6.02506 23.9037C5.91559 23.7613 5.83523 23.5988 5.78857 23.4254C5.74191 23.252 5.72986 23.0711 5.75311 22.893C5.77637 22.715 5.83446 22.5432 5.92409 22.3876L6.89909 20.7001C8.00159 20.3584 8.89742 20.6209 9.60659 21.4759ZM20.9066 17.3476H24.4583C25.2158 17.3476 25.8233 17.9551 25.8233 18.7126C25.8233 19.4701 25.2149 20.0776 24.4583 20.0776H22.4858L23.8166 22.3876C24.1916 23.0443 23.9708 23.8726 23.3149 24.2551C23.0006 24.4359 22.6274 24.4845 22.2772 24.3903C21.927 24.2961 21.6286 24.0667 21.4474 23.7526C19.2058 19.8643 17.5216 16.9534 16.4041 15.0151C15.2608 13.0426 16.0783 11.0626 16.8841 10.3909C17.7799 11.9293 19.1191 14.2501 20.9074 17.3476H20.9066Z" fill="white"/>
  </g>
  <defs>
    <linearGradient id="paint0_linear_87_33" x1="15" y1="2.29447e-07" x2="15" y2="30" gradientUnits="userSpaceOnUse">
      <stop stop-color="#18BFFB"/>
      <stop offset="1" stop-color="#2072F3"/>
    </linearGradient>
    <clipPath id="clip0_87_33">
      <rect width="30" height="30" fill="white"/>
    </clipPath>
  </defs>
</svg>`;m();w();y();var J0=ee`<svg fill="none" viewBox="0 0 40 40">
  <g clip-path="url(#a)">
    <g clip-path="url(#b)">
      <circle cx="20" cy="19.89" r="20" fill="#000" />
      <g clip-path="url(#c)">
        <path
          fill="#fff"
          d="M28.77 23.3c-.69 1.99-2.75 5.52-4.87 5.56-1.4.03-1.86-.84-3.46-.84-1.61 0-2.12.81-3.45.86-2.25.1-5.72-5.1-5.72-9.62 0-4.15 2.9-6.2 5.42-6.25 1.36-.02 2.64.92 3.47.92.83 0 2.38-1.13 4.02-.97.68.03 2.6.28 3.84 2.08-3.27 2.14-2.76 6.61.75 8.25ZM24.2 7.88c-2.47.1-4.49 2.69-4.2 4.84 2.28.17 4.47-2.39 4.2-4.84Z"
        />
      </g>
    </g>
  </g>
  <defs>
    <clipPath id="a"><rect width="40" height="40" fill="#fff" rx="20" /></clipPath>
    <clipPath id="b"><path fill="#fff" d="M0 0h40v40H0z" /></clipPath>
    <clipPath id="c"><path fill="#fff" d="M8 7.89h24v24H8z" /></clipPath>
  </defs>
</svg>`;m();w();y();var Q0=ee`
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 8 11">
    <path
      fill="var(--apkt-tokens-theme-textPrimary)"
      d="M7.862 4.86c.159-1.064-.652-1.637-1.76-2.018l.36-1.443-.879-.218-.35 1.404c-.23-.058-.468-.112-.703-.166l.352-1.413-.877-.219-.36 1.442a29.02 29.02 0 0 1-.56-.132v-.005l-1.21-.302-.234.938s.652.15.638.158c.356.089.42.324.41.51l-.41 1.644a.715.715 0 0 1 .09.03l-.092-.024-.574 2.302c-.044.108-.154.27-.402.208.008.013-.639-.16-.639-.16L.227 8.403l1.142.285c.213.053.42.109.626.161l-.363 1.459.877.218.36-1.443c.239.065.472.125.7.182l-.36 1.436.879.219.363-1.456c1.497.283 2.623.17 3.097-1.185.381-1.09-.02-1.719-.807-2.129.574-.132 1.006-.51 1.12-1.289ZM5.856 7.673c-.272 1.09-2.107.5-2.702.353l.482-1.933c.595.149 2.503.443 2.22 1.58Zm.271-2.829c-.247.992-1.775.488-2.27.365l.436-1.753c.496.124 2.092.354 1.834 1.388Z"
    />
  </svg>
`;m();w();y();var e1=ee`<svg width="30" height="30" viewBox="0 0 30 30" fill="none">
<path d="M14.9978 7.80003H27.4668C26.2032 5.61107 24.3857 3.79333 22.1968 2.52955C20.008 1.26577 17.525 0.600485 14.9975 0.600586C12.47 0.600687 9.98712 1.26617 7.79838 2.53012C5.60964 3.79408 3.79221 5.61197 2.52881 7.80103L8.76281 18.599L8.76881 18.598C8.13412 17.5044 7.79906 16.2628 7.79743 14.9983C7.79579 13.7339 8.12764 12.4914 8.7595 11.3961C9.39136 10.3008 10.3009 9.39159 11.3963 8.76005C12.4918 8.12851 13.7344 7.79702 14.9988 7.79903L14.9978 7.80003Z" fill="url(#paint0_linear_87_32)"/>
<path d="M21.237 18.5981L15.003 29.3961C17.5305 29.3961 20.0134 28.7308 22.2022 27.467C24.391 26.2032 26.2086 24.3854 27.4721 22.1965C28.7356 20.0075 29.4006 17.5245 29.4003 14.997C29.3999 12.4695 28.7342 9.9867 27.47 7.7981H15.002L15 7.8041C16.2642 7.80168 17.5067 8.13257 18.6022 8.76342C19.6977 9.39428 20.6076 10.3028 21.2401 11.3974C21.8726 12.492 22.2053 13.734 22.2048 14.9982C22.2042 16.2623 21.8704 17.504 21.237 18.5981Z" fill="url(#paint1_linear_87_32)"/>
<path d="M8.76502 18.601L2.53102 7.80298C1.26664 9.99172 0.600848 12.4748 0.600586 15.0025C0.600324 17.5302 1.2656 20.0134 2.52953 22.2024C3.79345 24.3914 5.61145 26.209 7.80071 27.4725C9.98998 28.736 12.4733 29.4008 15.001 29.4L21.236 18.602L21.232 18.598C20.6022 19.6941 19.6944 20.6049 18.6003 21.2383C17.5062 21.8717 16.2644 22.2055 15.0002 22.2059C13.7359 22.2063 12.4939 21.8733 11.3994 21.2406C10.3049 20.6079 9.39657 19.6977 8.76602 18.602L8.76502 18.601Z" fill="url(#paint2_linear_87_32)"/>
<path d="M14.9998 22.2C16.9094 22.2 18.7407 21.4415 20.091 20.0912C21.4412 18.741 22.1998 16.9096 22.1998 15C22.1998 13.0905 21.4412 11.2591 20.091 9.90888C18.7407 8.55862 16.9094 7.80005 14.9998 7.80005C13.0902 7.80005 11.2589 8.55862 9.90864 9.90888C8.55837 11.2591 7.7998 13.0905 7.7998 15C7.7998 16.9096 8.55837 18.741 9.90864 20.0912C11.2589 21.4415 13.0902 22.2 14.9998 22.2Z" fill="white"/>
<path d="M14.9998 20.7C16.5115 20.7 17.9614 20.0995 19.0303 19.0306C20.0993 17.9616 20.6998 16.5118 20.6998 15C20.6998 13.4883 20.0993 12.0385 19.0303 10.9695C17.9614 9.90058 16.5115 9.30005 14.9998 9.30005C13.4881 9.30005 12.0383 9.90058 10.9693 10.9695C9.90034 12.0385 9.2998 13.4883 9.2998 15C9.2998 16.5118 9.90034 17.9616 10.9693 19.0306C12.0383 20.0995 13.4881 20.7 14.9998 20.7Z" fill="#1A73E8"/>
<defs>
  <linearGradient id="paint0_linear_87_32" x1="3.29381" y1="2.99503" x2="38.0998" y2="2.99503" gradientUnits="userSpaceOnUse">
    <stop stop-color="#D93025"/>
    <stop offset="1" stop-color="#EA4335"/>
  </linearGradient>
  <linearGradient id="paint1_linear_87_32" x1="17.953" y1="29.1431" x2="34.194" y2="-0.298904" gradientUnits="userSpaceOnUse">
    <stop stop-color="#FCC934"/>
    <stop offset="1" stop-color="#FBBC04"/>
  </linearGradient>
  <linearGradient id="paint2_linear_87_32" x1="22.873" y1="28.2" x2="6.63202" y2="-1.24102" gradientUnits="userSpaceOnUse">
    <stop stop-color="#1E8E3E"/>
    <stop offset="1" stop-color="#34A853"/>
  </linearGradient>
</defs>
</svg>`;m();w();y();var t1=ee`<svg width="32" height="32" viewBox="0 0 32 32" fill="none">
<path d="M23 11.1962V10.5C23 7.365 18.2712 5 12 5C5.72875 5 1 7.365 1 10.5V15.5C1 18.1112 4.28125 20.1863 9 20.8075V21.5C9 24.635 13.7288 27 20 27C26.2712 27 31 24.635 31 21.5V16.5C31 13.9125 27.8225 11.835 23 11.1962ZM7 18.3587C4.55125 17.675 3 16.5487 3 15.5V13.7413C4.02 14.4637 5.38625 15.0463 7 15.4375V18.3587ZM17 15.4375C18.6138 15.0463 19.98 14.4637 21 13.7413V15.5C21 16.5487 19.4487 17.675 17 18.3587V15.4375ZM15 24.3587C12.5513 23.675 11 22.5487 11 21.5V20.9788C11.3287 20.9913 11.6613 21 12 21C12.485 21 12.9587 20.9837 13.4237 20.9562C13.9403 21.1412 14.4665 21.2981 15 21.4263V24.3587ZM15 18.7812C14.0068 18.928 13.004 19.0011 12 19C10.996 19.0011 9.99324 18.928 9 18.7812V15.8075C9.99472 15.9371 10.9969 16.0014 12 16C13.0031 16.0014 14.0053 15.9371 15 15.8075V18.7812ZM23 24.7812C21.0106 25.0729 18.9894 25.0729 17 24.7812V21.8C17.9944 21.9337 18.9967 22.0005 20 22C21.0031 22.0014 22.0053 21.9371 23 21.8075V24.7812ZM29 21.5C29 22.5487 27.4487 23.675 25 24.3587V21.4375C26.6138 21.0462 27.98 20.4637 29 19.7412V21.5Z" fill="currentColor"/>
</svg>
`;m();w();y();var r1=ee` <svg fill="none" viewBox="0 0 13 4">
  <path fill="currentColor" d="M.5 0h12L8.9 3.13a3.76 3.76 0 0 1-4.8 0L.5 0Z" />
</svg>`;m();w();y();var s1=ee`<svg fill="none" viewBox="0 0 40 40">
  <g clip-path="url(#a)">
    <g clip-path="url(#b)">
      <circle cx="20" cy="19.89" r="20" fill="#5865F2" />
      <path
        fill="#fff"
        fill-rule="evenodd"
        d="M25.71 28.15C30.25 28 32 25.02 32 25.02c0-6.61-2.96-11.98-2.96-11.98-2.96-2.22-5.77-2.15-5.77-2.15l-.29.32c3.5 1.07 5.12 2.61 5.12 2.61a16.75 16.75 0 0 0-10.34-1.93l-.35.04a15.43 15.43 0 0 0-5.88 1.9s1.71-1.63 5.4-2.7l-.2-.24s-2.81-.07-5.77 2.15c0 0-2.96 5.37-2.96 11.98 0 0 1.73 2.98 6.27 3.13l1.37-1.7c-2.6-.79-3.6-2.43-3.6-2.43l.58.35.09.06.08.04.02.01.08.05a17.25 17.25 0 0 0 4.52 1.58 14.4 14.4 0 0 0 8.3-.86c.72-.27 1.52-.66 2.37-1.21 0 0-1.03 1.68-3.72 2.44.61.78 1.35 1.67 1.35 1.67Zm-9.55-9.6c-1.17 0-2.1 1.03-2.1 2.28 0 1.25.95 2.28 2.1 2.28 1.17 0 2.1-1.03 2.1-2.28.01-1.25-.93-2.28-2.1-2.28Zm7.5 0c-1.17 0-2.1 1.03-2.1 2.28 0 1.25.95 2.28 2.1 2.28 1.17 0 2.1-1.03 2.1-2.28 0-1.25-.93-2.28-2.1-2.28Z"
        clip-rule="evenodd"
      />
    </g>
  </g>
  <defs>
    <clipPath id="a"><rect width="40" height="40" fill="#fff" rx="20" /></clipPath>
    <clipPath id="b"><path fill="#fff" d="M0 0h40v40H0z" /></clipPath>
  </defs>
</svg>`;m();w();y();var n1=ee`<svg
  xmlns="http://www.w3.org/2000/svg"
  fill="none"
  viewBox="0 0 9 12"
>
  <path
    fill="var(--apkt-tokens-theme-textPrimary)"
    d="M4.666.001v4.435l3.748 1.675L4.666.001Zm0 0L.917 6.111l3.749-1.675V.001Zm0 8.984V12l3.75-5.19-3.75 2.176Zm0 3.014V8.985L.917 6.81 4.666 12Zm0-3.712 3.748-2.176-3.748-1.675v3.851Z"
  />
  <path fill="var(--apkt-tokens-theme-textPrimary)" d="m.917 6.111 3.749 2.176v-3.85L.917 6.11Z" />
</svg>`;m();w();y();var i1=ee`<svg fill="none" viewBox="0 0 16 16">
  <path
    fill="currentColor"
    d="M4.25 7a.63.63 0 0 0-.63.63v3.97c0 .28-.2.51-.47.54l-.75.07a.93.93 0 0 1-.9-.47A7.51 7.51 0 0 1 5.54.92a7.5 7.5 0 0 1 9.54 4.62c.12.35.06.72-.16 1-.74.97-1.68 1.78-2.6 2.44V4.44a.64.64 0 0 0-.63-.64h-1.06c-.35 0-.63.3-.63.64v5.5c0 .23-.12.42-.32.5l-.52.23V6.05c0-.36-.3-.64-.64-.64H7.45c-.35 0-.64.3-.64.64v4.97c0 .25-.17.46-.4.52a5.8 5.8 0 0 0-.45.11v-4c0-.36-.3-.65-.64-.65H4.25ZM14.07 12.4A7.49 7.49 0 0 1 3.6 14.08c4.09-.58 9.14-2.5 11.87-6.6v.03a7.56 7.56 0 0 1-1.41 4.91Z"
  />
</svg>`;m();w();y();var o1=ee`<svg fill="none" viewBox="0 0 40 40">
  <g clip-path="url(#a)">
    <g clip-path="url(#b)">
      <circle cx="20" cy="19.89" r="20" fill="#1877F2" />
      <g clip-path="url(#c)">
        <path
          fill="#fff"
          d="M26 12.38h-2.89c-.92 0-1.61.38-1.61 1.34v1.66H26l-.36 4.5H21.5v12H17v-12h-3v-4.5h3V12.5c0-3.03 1.6-4.62 5.2-4.62H26v4.5Z"
        />
      </g>
    </g>
    <path
      fill="#1877F2"
      d="M40 20a20 20 0 1 0-23.13 19.76V25.78H11.8V20h5.07v-4.4c0-5.02 3-7.79 7.56-7.79 2.19 0 4.48.4 4.48.4v4.91h-2.53c-2.48 0-3.25 1.55-3.25 3.13V20h5.54l-.88 5.78h-4.66v13.98A20 20 0 0 0 40 20Z"
    />
    <path
      fill="#fff"
      d="m27.79 25.78.88-5.78h-5.55v-3.75c0-1.58.78-3.13 3.26-3.13h2.53V8.2s-2.3-.39-4.48-.39c-4.57 0-7.55 2.77-7.55 7.78V20H11.8v5.78h5.07v13.98a20.15 20.15 0 0 0 6.25 0V25.78h4.67Z"
    />
  </g>
  <defs>
    <clipPath id="a"><rect width="40" height="40" fill="#fff" rx="20" /></clipPath>
    <clipPath id="b"><path fill="#fff" d="M0 0h40v40H0z" /></clipPath>
    <clipPath id="c"><path fill="#fff" d="M8 7.89h24v24H8z" /></clipPath>
  </defs>
</svg>`;m();w();y();var a1=ee`<svg style="border-radius: 9999px; overflow: hidden;"  fill="none" viewBox="0 0 1000 1000">
  <rect width="1000" height="1000" rx="9999" ry="9999" fill="#855DCD"/>
  <path fill="#855DCD" d="M0 0h1000v1000H0V0Z" />
  <path
    fill="#fff"
    d="M320 248h354v504h-51.96V521.13h-.5c-5.76-63.8-59.31-113.81-124.54-113.81s-118.78 50-124.53 113.81h-.5V752H320V248Z"
  />
  <path
    fill="#fff"
    d="m225 320 21.16 71.46h17.9v289.09a16.29 16.29 0 0 0-16.28 16.24v19.49h-3.25a16.3 16.3 0 0 0-16.28 16.24V752h182.26v-19.48a16.22 16.22 0 0 0-16.28-16.24h-3.25v-19.5a16.22 16.22 0 0 0-16.28-16.23h-19.52V320H225Zm400.3 360.55a16.3 16.3 0 0 0-15.04 10.02 16.2 16.2 0 0 0-1.24 6.22v19.49h-3.25a16.29 16.29 0 0 0-16.27 16.24V752h182.24v-19.48a16.23 16.23 0 0 0-16.27-16.24h-3.25v-19.5a16.2 16.2 0 0 0-10.04-15 16.3 16.3 0 0 0-6.23-1.23v-289.1h17.9L775 320H644.82v360.55H625.3Z"
  />
</svg>`;m();w();y();var c1=ee`<svg fill="none" viewBox="0 0 40 40">
  <g clip-path="url(#a)">
    <g clip-path="url(#b)">
      <circle cx="20" cy="19.89" r="20" fill="#1B1F23" />
      <g clip-path="url(#c)">
        <path
          fill="#fff"
          d="M8 19.89a12 12 0 1 1 15.8 11.38c-.6.12-.8-.26-.8-.57v-3.3c0-1.12-.4-1.85-.82-2.22 2.67-.3 5.48-1.31 5.48-5.92 0-1.31-.47-2.38-1.24-3.22.13-.3.54-1.52-.12-3.18 0 0-1-.32-3.3 1.23a11.54 11.54 0 0 0-6 0c-2.3-1.55-3.3-1.23-3.3-1.23a4.32 4.32 0 0 0-.12 3.18 4.64 4.64 0 0 0-1.24 3.22c0 4.6 2.8 5.63 5.47 5.93-.34.3-.65.83-.76 1.6-.69.31-2.42.84-3.5-1 0 0-.63-1.15-1.83-1.23 0 0-1.18-.02-.09.73 0 0 .8.37 1.34 1.76 0 0 .7 2.14 4.03 1.41v2.24c0 .31-.2.68-.8.57A12 12 0 0 1 8 19.9Z"
        />
      </g>
    </g>
  </g>
  <defs>
    <clipPath id="a"><rect width="40" height="40" fill="#fff" rx="20" /></clipPath>
    <clipPath id="b"><path fill="#fff" d="M0 0h40v40H0z" /></clipPath>
    <clipPath id="c"><path fill="#fff" d="M8 7.89h24v24H8z" /></clipPath>
  </defs>
</svg>`;m();w();y();var l1=ee`<svg fill="none" viewBox="0 0 40 40">
  <path
    fill="#4285F4"
    d="M32.74 20.3c0-.93-.08-1.81-.24-2.66H20.26v5.03h7a6 6 0 0 1-2.62 3.91v3.28h4.22c2.46-2.27 3.88-5.6 3.88-9.56Z"
  />
  <path
    fill="#34A853"
    d="M20.26 33a12.4 12.4 0 0 0 8.6-3.14l-4.22-3.28a7.74 7.74 0 0 1-4.38 1.26 7.76 7.76 0 0 1-7.28-5.36H8.65v3.36A12.99 12.99 0 0 0 20.26 33Z"
  />
  <path
    fill="#FBBC05"
    d="M12.98 22.47a7.79 7.79 0 0 1 0-4.94v-3.36H8.65a12.84 12.84 0 0 0 0 11.66l3.37-2.63.96-.73Z"
  />
  <path
    fill="#EA4335"
    d="M20.26 12.18a7.1 7.1 0 0 1 4.98 1.93l3.72-3.72A12.47 12.47 0 0 0 20.26 7c-5.08 0-9.47 2.92-11.6 7.17l4.32 3.36a7.76 7.76 0 0 1 7.28-5.35Z"
  />
</svg>`;m();w();y();var u1=ee`<svg width="10" height="10" viewBox="0 0 10 10" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M4.875 0C3.91082 0 2.96829 0.285914 2.1666 0.821586C1.36491 1.35726 0.740067 2.11863 0.371089 3.00942C0.00211226 3.90021 -0.094429 4.88041 0.093674 5.82607C0.281777 6.77172 0.746076 7.64036 1.42786 8.32215C2.10964 9.00393 2.97828 9.46823 3.92394 9.65633C4.86959 9.84443 5.84979 9.74789 6.74058 9.37891C7.63137 9.00994 8.39274 8.38509 8.92842 7.5834C9.46409 6.78171 9.75 5.83918 9.75 4.875C9.74864 3.58249 9.23458 2.34331 8.32064 1.42936C7.4067 0.515418 6.16751 0.00136492 4.875 0ZM4.6875 2.25C4.79875 2.25 4.90751 2.28299 5.00001 2.3448C5.09251 2.40661 5.16461 2.49446 5.20718 2.59724C5.24976 2.70002 5.2609 2.81312 5.23919 2.92224C5.21749 3.03135 5.16392 3.13158 5.08525 3.21025C5.00658 3.28891 4.90635 3.34249 4.79724 3.36419C4.68813 3.3859 4.57503 3.37476 4.47224 3.33218C4.36946 3.28961 4.28161 3.21751 4.2198 3.12501C4.15799 3.03251 4.125 2.92375 4.125 2.8125C4.125 2.66332 4.18427 2.52024 4.28975 2.41475C4.39524 2.30926 4.53832 2.25 4.6875 2.25ZM5.25 7.5C5.05109 7.5 4.86032 7.42098 4.71967 7.28033C4.57902 7.13968 4.5 6.94891 4.5 6.75V4.875C4.40055 4.875 4.30516 4.83549 4.23484 4.76516C4.16451 4.69484 4.125 4.59946 4.125 4.5C4.125 4.40054 4.16451 4.30516 4.23484 4.23484C4.30516 4.16451 4.40055 4.125 4.5 4.125C4.69891 4.125 4.88968 4.20402 5.03033 4.34467C5.17098 4.48532 5.25 4.67609 5.25 4.875V6.75C5.34946 6.75 5.44484 6.78951 5.51517 6.85983C5.58549 6.93016 5.625 7.02554 5.625 7.125C5.625 7.22446 5.58549 7.31984 5.51517 7.39017C5.44484 7.46049 5.34946 7.5 5.25 7.5Z" fill="#9A9A9A"/>
</svg>
`;m();w();y();var h1=ee`<svg width="32" height="32" viewBox="0 0 32 32" fill="none">
<path d="M28.925 5.5425C28.925 5.5425 28.925 5.555 28.925 5.56125L21.65 29.5537C21.5399 29.9434 21.3132 30.2901 21.0004 30.5473C20.6876 30.8045 20.3036 30.9598 19.9 30.9925C19.8425 30.9975 19.785 31 19.7275 31C19.3493 31.0012 18.9786 30.8941 18.6592 30.6915C18.3398 30.4888 18.085 30.199 17.925 29.8563L13.375 20.5187C13.3295 20.4252 13.3143 20.3197 13.3315 20.2171C13.3488 20.1145 13.3976 20.0198 13.4713 19.9463L20.7113 12.7063C20.8909 12.5172 20.9895 12.2654 20.9862 12.0047C20.9829 11.7439 20.8778 11.4948 20.6934 11.3104C20.509 11.126 20.2599 11.0209 19.9991 11.0176C19.7383 11.0142 19.4866 11.1129 19.2975 11.2925L12.0538 18.5325C11.9802 18.6061 11.8855 18.655 11.7829 18.6722C11.6803 18.6895 11.5748 18.6743 11.4813 18.6287L2.13502 14.08C1.76954 13.9047 1.46598 13.6224 1.26454 13.2706C1.06311 12.9189 0.973316 12.5142 1.00707 12.1102C1.04082 11.7063 1.19652 11.3221 1.45354 11.0087C1.71056 10.6952 2.05676 10.4673 2.44627 10.355L26.4388 3.08H26.4575C26.7991 2.98403 27.1601 2.98066 27.5034 3.07025C27.8468 3.15984 28.1601 3.33916 28.4113 3.58981C28.6624 3.84045 28.8424 4.15341 28.9326 4.49656C29.0229 4.83971 29.0203 5.2007 28.925 5.5425Z" fill="currentColor"/>
</svg>
`;m();w();y();var p1=ee` <svg width="27" height="30" viewBox="0 0 27 30" fill="none">
  <path d="M12.5395 14.3237L0.116699 27.5049V27.5188C0.251527 28.0177 0.49972 28.4788 0.841941 28.866C1.18416 29.2533 1.61117 29.5563 2.0897 29.7515C2.56823 29.9467 3.08536 30.0287 3.60081 29.9913C4.11625 29.9538 4.61609 29.7979 5.06139 29.5356L5.0975 29.512L19.0718 21.4519L12.5395 14.3237Z" fill="#EA4335"/>
  <path d="M25.103 12.0833L25.0919 12.0722L19.0611 8.57202L12.2607 14.6279L19.0847 21.4504L25.0919 17.9864C25.6229 17.6983 26.0665 17.2725 26.376 16.7537C26.6854 16.2349 26.8493 15.6422 26.8505 15.0381C26.8516 14.434 26.6899 13.8408 26.3824 13.3208C26.0749 12.8008 25.633 12.3734 25.103 12.0833Z" fill="#FBBC04"/>
  <path d="M0.116672 2.49553C0.047224 2.7761 0 3.05528 0 3.35946V26.6537C0 26.9565 0.0347234 27.237 0.116672 27.5162L12.959 14.6725L0.116672 2.49553Z" fill="#4285F4"/>
  <path d="M12.634 15.0001L19.0607 8.57198L5.0975 0.477133C4.65115 0.210463 4.14916 0.0506574 3.63079 0.0102139C3.11242 -0.0302296 2.59172 0.0497852 2.10941 0.244001C1.6271 0.438216 1.19625 0.741368 0.850556 1.12975C0.504864 1.51813 0.253698 1.98121 0.116699 2.48279L12.634 15.0001Z" fill="#34A853"/>
</svg>`;m();w();y();var f1=ee`<svg width="75" height="20" viewBox="0 0 75 20" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M11.6666 5.83334C11.6666 2.61168 14.2783 0 17.5 0H25.8334C29.055 0 31.6666 2.61168 31.6666 5.83334V14.1666C31.6666 17.3883 29.055 20 25.8334 20H17.5C14.2783 20 11.6666 17.3883 11.6666 14.1666V5.83334Z" fill="var(--apkt-tokens-theme-foregroundTertiary)"/>
<path d="M19.5068 13.7499L22.4309 5.83331H23.2895L20.3654 13.7499H19.5068Z" fill="var(--apkt-tokens-theme-textPrimary)"/>
<path d="M0 5.41666C0 2.42513 2.42513 0 5.41666 0C8.40821 0 10.8334 2.42513 10.8334 5.41666V14.5833C10.8334 17.5748 8.40821 20 5.41666 20C2.42513 20 0 17.5748 0 14.5833V5.41666Z" fill="var(--apkt-tokens-theme-foregroundTertiary)"/>
<path d="M4.89581 12.4997V11.458H5.93747V12.4997H4.89581Z" fill="var(--apkt-tokens-theme-textPrimary)"/>
<path d="M32.5 10C32.5 4.47715 36.6896 0 41.8578 0H65.6422C70.8104 0 75 4.47715 75 10C75 15.5229 70.8104 20 65.6422 20H41.8578C36.6896 20 32.5 15.5229 32.5 10Z" fill="var(--apkt-tokens-theme-foregroundTertiary)"/>
<path d="M61.7108 12.4475V7.82751H62.5266V8.52418C62.8199 8.01084 63.4157 7.70834 64.0757 7.70834C65.0749 7.70834 65.7715 8.34084 65.7715 9.56918V12.4475H64.9649V9.61503C64.9649 8.80831 64.5066 8.38668 63.8374 8.38668C63.1132 8.38668 62.5266 8.9642 62.5266 9.78001V12.4475H61.7108Z" fill="var(--apkt-tokens-theme-textPrimary)"/>
<path d="M56.5671 12.4475L55.7147 7.82748H56.4846L57.0896 11.6409L57.8871 9.12916H58.6479L59.4363 11.6134L60.0505 7.82748H60.8204L59.9679 12.4475H59.0513L58.2721 10.0458L57.4838 12.4475H56.5671Z" fill="var(--apkt-tokens-theme-textPrimary)"/>
<path d="M52.9636 12.5666C51.5611 12.5666 50.7361 11.5217 50.7361 10.1375C50.7361 8.76254 51.5611 7.70834 52.9636 7.70834C54.3661 7.70834 55.1911 8.76254 55.1911 10.1375C55.1911 11.5217 54.3661 12.5666 52.9636 12.5666ZM52.9636 11.8883C53.9719 11.8883 54.357 11.0266 54.357 10.1283C54.357 9.23914 53.9719 8.38668 52.9636 8.38668C51.9552 8.38668 51.5702 9.23914 51.5702 10.1283C51.5702 11.0266 51.9552 11.8883 52.9636 11.8883Z" fill="var(--apkt-tokens-theme-textPrimary)"/>
<path d="M47.8507 12.5666C46.494 12.5666 45.6415 11.5308 45.6415 10.1375C45.6415 8.75337 46.494 7.70834 47.8507 7.70834C48.9965 7.70834 50.0048 8.35917 49.8948 10.3483H46.4756C46.5398 11.2009 46.934 11.8975 47.8507 11.8975C48.4648 11.8975 48.8681 11.5217 49.0057 11.0908H49.8123C49.684 11.8609 48.9598 12.5666 47.8507 12.5666ZM46.494 9.73416H49.1065C49.0423 8.80831 48.6114 8.37751 47.8507 8.37751C47.0165 8.37751 46.604 8.98254 46.494 9.73416Z" fill="var(--apkt-tokens-theme-textPrimary)"/>
<path d="M41.7284 12.4475V7.82748H42.5625V8.60665C42.8559 8.09332 43.3601 7.82748 43.8825 7.82748H44.9917V8.60665H43.8184C43.0851 8.60665 42.5625 9.08331 42.5625 10.0092V12.4475H41.7284Z" fill="var(--apkt-tokens-theme-textPrimary)"/>
</svg>

`;m();w();y();var d1=ee`
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 8">
    <path
      fill="var(--apkt-tokens-theme-textPrimary)"
      d="m9.524 6.307-1.51 1.584A.35.35 0 0 1 7.76 8H.604a.178.178 0 0 1-.161-.103.168.168 0 0 1 .033-.186l1.51-1.583a.35.35 0 0 1 .256-.11h7.154c.034 0 .068.01.096.029a.168.168 0 0 1 .032.26Zm-1.51-3.189a.35.35 0 0 0-.255-.109H.604a.178.178 0 0 0-.161.103.168.168 0 0 0 .033.186l1.51 1.583a.35.35 0 0 0 .256.11h7.154a.178.178 0 0 0 .16-.104.168.168 0 0 0-.032-.185l-1.51-1.584ZM.605 1.981H7.76a.357.357 0 0 0 .256-.11L9.525.289a.17.17 0 0 0 .032-.185.173.173 0 0 0-.16-.103H2.241a.357.357 0 0 0-.256.109L.476 1.692a.17.17 0 0 0-.033.185.178.178 0 0 0 .16.103Z"
    />
  </svg>
`;m();w();y();var g1=ee`<svg width="32" height="32" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <g clip-path="url(#a)">
    <path fill="url(#b)" d="M0 0h32v32H0z"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M7.034 15.252c4.975-2.167 8.293-3.596 9.953-4.287 4.74-1.971 5.725-2.314 6.366-2.325.142-.002.457.033.662.198.172.14.22.33.243.463.022.132.05.435.028.671-.257 2.7-1.368 9.248-1.933 12.27-.24 1.28-.71 1.708-1.167 1.75-.99.091-1.743-.655-2.703-1.284-1.502-.985-2.351-1.598-3.81-2.558-1.684-1.11-.592-1.721.368-2.718.252-.261 4.619-4.233 4.703-4.594.01-.045.02-.213-.08-.301-.1-.09-.246-.059-.353-.035-.15.034-2.55 1.62-7.198 4.758-.682.468-1.298.696-1.851.684-.61-.013-1.782-.344-2.653-.628-1.069-.347-1.918-.53-1.845-1.12.039-.308.462-.623 1.27-.944Z" fill="#fff"/>
  </g>
  <path d="M.5 16C.5 7.44 7.44.5 16 .5 24.56.5 31.5 7.44 31.5 16c0 8.56-6.94 15.5-15.5 15.5C7.44 31.5.5 24.56.5 16Z" stroke="#141414" stroke-opacity=".05"/>
  <defs>
    <linearGradient id="b" x1="1600" y1="0" x2="1600" y2="3176.27" gradientUnits="userSpaceOnUse">
      <stop stop-color="#2AABEE"/>
      <stop offset="1" stop-color="#229ED9"/>
    </linearGradient>
    <clipPath id="a">
      <path d="M0 16C0 7.163 7.163 0 16 0s16 7.163 16 16-7.163 16-16 16S0 24.837 0 16Z" fill="#fff"/>
    </clipPath>
  </defs>
</svg>`;m();w();y();var m1=ee`
  <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 10 10">
  <path d="M8.37651 0H1.62309C0.381381 0 -0.405611 1.33944 0.219059 2.42225L4.38701 9.64649C4.659 10.1182 5.3406 10.1182 5.61259 9.64649L9.78139 2.42225C10.4052 1.34117 9.61822 0 8.37736 0H8.37651ZM4.38362 7.48005L3.47591 5.72329L1.2857 1.80606C1.14121 1.55534 1.31968 1.23405 1.62225 1.23405H4.38278V7.4809L4.38362 7.48005ZM8.71221 1.80521L6.52284 5.72414L5.61513 7.48005V1.2332H8.37566C8.67823 1.2332 8.85669 1.55449 8.71221 1.80521Z" fill="var(--apkt-tokens-theme-textPrimary)" />
</svg>
`;m();w();y();var y1=ee`<svg fill="none" viewBox="0 0 40 40">
  <g clip-path="url(#a)">
    <g clip-path="url(#b)">
      <circle cx="20" cy="19.89" r="20" fill="#5A3E85" />
      <g clip-path="url(#c)">
        <path
          fill="#fff"
          d="M18.22 25.7 20 23.91h3.34l2.1-2.1v-6.68H15.4v8.78h2.82v1.77Zm3.87-8.16h1.25v3.66H22.1v-3.66Zm-3.34 0H20v3.66h-1.25v-3.66ZM20 7.9a12 12 0 1 0 0 24 12 12 0 0 0 0-24Zm6.69 14.56-3.66 3.66h-2.72l-1.77 1.78h-1.88V26.1H13.3v-9.82l.94-2.4H26.7v8.56Z"
        />
      </g>
    </g>
  </g>
  <defs>
    <clipPath id="a"><rect width="40" height="40" fill="#fff" rx="20" /></clipPath>
    <clipPath id="b"><path fill="#fff" d="M0 0h40v40H0z" /></clipPath>
    <clipPath id="c"><path fill="#fff" d="M8 7.89h24v24H8z" /></clipPath>
  </defs>
</svg>`;m();w();y();var w1=ee`<svg fill="none" viewBox="0 0 16 16">
  <path
    fill="currentColor"
    d="m14.36 4.74.01.42c0 4.34-3.3 9.34-9.34 9.34A9.3 9.3 0 0 1 0 13.03a6.6 6.6 0 0 0 4.86-1.36 3.29 3.29 0 0 1-3.07-2.28c.5.1 1 .07 1.48-.06A3.28 3.28 0 0 1 .64 6.11v-.04c.46.26.97.4 1.49.41A3.29 3.29 0 0 1 1.11 2.1a9.32 9.32 0 0 0 6.77 3.43 3.28 3.28 0 0 1 5.6-3 6.59 6.59 0 0 0 2.08-.8 3.3 3.3 0 0 1-1.45 1.82A6.53 6.53 0 0 0 16 3.04c-.44.66-1 1.23-1.64 1.7Z"
  />
</svg>`;m();w();y();var b1=ee`
<svg xmlns="http://www.w3.org/2000/svg" width="89" height="89" viewBox="0 0 89 89" fill="none">
<path d="M60.0468 39.2502L65.9116 33.3854C52.6562 20.13 36.1858 20.13 22.9304 33.3854L28.7952 39.2502C38.8764 29.169 49.9725 29.169 60.0536 39.2502H60.0468Z" fill="var(--apkt-tokens-theme-textPrimary)"/>
<path d="M58.0927 52.9146L44.415 39.2369L30.7373 52.9146L17.0596 39.2369L11.2017 45.0949L30.7373 64.6374L44.415 50.9597L58.0927 64.6374L77.6284 45.0949L71.7704 39.2369L58.0927 52.9146Z" fill="var(--apkt-tokens-theme-textPrimary)"/>
</svg>`,v1=ee`
<svg xmlns="http://www.w3.org/2000/svg" width="89" height="89" viewBox="0 0 89 89" fill="none">
<path d="M60.0468 39.2502L65.9116 33.3854C52.6562 20.13 36.1858 20.13 22.9304 33.3854L28.7952 39.2502C38.8764 29.169 49.9725 29.169 60.0536 39.2502H60.0468Z" fill="var(--apkt-tokens-theme-textInvert)"/>
<path d="M58.0927 52.9146L44.415 39.2369L30.7373 52.9146L17.0596 39.2369L11.2017 45.0949L30.7373 64.6374L44.415 50.9597L58.0927 64.6374L77.6284 45.0949L71.7704 39.2369L58.0927 52.9146Z" fill="var(--apkt-tokens-theme-textInvert)"/>
</svg>`,x1=ee`
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#clip0_22274_4692)">
<path d="M0 6.64C0 4.17295 0 2.93942 0.525474 2.01817C0.880399 1.39592 1.39592 0.880399 2.01817 0.525474C2.93942 0 4.17295 0 6.64 0H9.36C11.8271 0 13.0606 0 13.9818 0.525474C14.6041 0.880399 15.1196 1.39592 15.4745 2.01817C16 2.93942 16 4.17295 16 6.64V9.36C16 11.8271 16 13.0606 15.4745 13.9818C15.1196 14.6041 14.6041 15.1196 13.9818 15.4745C13.0606 16 11.8271 16 9.36 16H6.64C4.17295 16 2.93942 16 2.01817 15.4745C1.39592 15.1196 0.880399 14.6041 0.525474 13.9818C0 13.0606 0 11.8271 0 9.36V6.64Z" fill="#C7B994"/>
<path d="M4.49038 5.76609C6.42869 3.86833 9.5713 3.86833 11.5096 5.76609L11.7429 5.99449C11.8398 6.08938 11.8398 6.24323 11.7429 6.33811L10.9449 7.11942C10.8964 7.16686 10.8179 7.16686 10.7694 7.11942L10.4484 6.80512C9.09617 5.48119 6.90381 5.48119 5.5516 6.80512L5.20782 7.14171C5.15936 7.18915 5.08079 7.18915 5.03234 7.14171L4.23434 6.3604C4.13742 6.26552 4.13742 6.11167 4.23434 6.01678L4.49038 5.76609ZM13.1599 7.38192L13.8702 8.07729C13.9671 8.17217 13.9671 8.32602 13.8702 8.4209L10.6677 11.5564C10.5708 11.6513 10.4137 11.6513 10.3168 11.5564L8.04388 9.33105C8.01965 9.30733 7.98037 9.30733 7.95614 9.33105L5.6833 11.5564C5.58638 11.6513 5.42925 11.6513 5.33234 11.5564L2.12982 8.42087C2.0329 8.32598 2.0329 8.17213 2.12982 8.07724L2.84004 7.38188C2.93695 7.28699 3.09408 7.28699 3.191 7.38188L5.46392 9.60726C5.48815 9.63098 5.52743 9.63098 5.55166 9.60726L7.82447 7.38188C7.92138 7.28699 8.07851 7.28699 8.17543 7.38187L10.4484 9.60726C10.4726 9.63098 10.5119 9.63098 10.5361 9.60726L12.809 7.38192C12.9059 7.28703 13.063 7.28703 13.1599 7.38192Z" fill="currentColor"/>
</g>
<defs>
<clipPath id="clip0_22274_4692">
<path d="M0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8Z" fill="white"/>
</clipPath>
</defs>
</svg>
`,E1=ee`
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<circle cx="11" cy="11" r="11" transform="matrix(-1 0 0 1 23 1)" fill="#202020"/>
<circle cx="11" cy="11" r="11.5" transform="matrix(-1 0 0 1 23 1)" stroke="#C7B994" stroke-opacity="0.7"/>
<path d="M15.4523 11.0686L16.7472 9.78167C13.8205 6.87297 10.1838 6.87297 7.25708 9.78167L8.55201 11.0686C10.7779 8.85645 13.2279 8.85645 15.4538 11.0686H15.4523Z" fill="#C7B994"/>
<path d="M15.0199 14.067L12 11.0656L8.98 14.067L5.96004 11.0656L4.66663 12.3511L8.98 16.6393L12 13.638L15.0199 16.6393L19.3333 12.3511L18.0399 11.0656L15.0199 14.067Z" fill="#C7B994"/>
</svg>
`;m();w();y();var jh=ee`<svg fill="none" viewBox="0 0 41 40">
  <g clip-path="url(#a)">
    <path fill="#000" d="M.8 0h40v40H.8z" />
    <path
      fill="#fff"
      d="m22.63 18.46 7.14-8.3h-1.69l-6.2 7.2-4.96-7.2H11.2l7.5 10.9-7.5 8.71h1.7l6.55-7.61 5.23 7.61h5.72l-7.77-11.31Zm-9.13-7.03h2.6l11.98 17.13h-2.6L13.5 11.43Z"
    />
  </g>
  <defs>
    <clipPath id="a"><path fill="#fff" d="M.8 20a20 20 0 1 1 40 0 20 20 0 0 1-40 0Z" /></clipPath>
  </defs>
</svg>`;m();w();y();var S1=pt`
  :host {
    display: flex;
    justify-content: center;
    align-items: center;
    aspect-ratio: 1 / 1;
    color: var(--local-color);
    width: var(--local-width);
  }

  svg {
    height: inherit;
    width: inherit;
    object-fit: contain;
    object-position: center;
  }
`;var qi=function(e,t,r,s){var n=arguments.length,i=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},B8={add:"ph-plus",allWallets:"ph-dots-three",arrowBottom:"ph-arrow-down",arrowBottomCircle:"ph-arrow-circle-down",arrowClockWise:"ph-arrow-clockwise",arrowLeft:"ph-arrow-left",arrowRight:"ph-arrow-right",arrowTop:"ph-arrow-up",arrowTopRight:"ph-arrow-up-right",bank:"ph-bank",bin:"ph-trash",browser:"ph-browser",card:"ph-credit-card",checkmark:"ph-check",checkmarkBold:"ph-check",chevronBottom:"ph-caret-down",chevronLeft:"ph-caret-left",chevronRight:"ph-caret-right",chevronTop:"ph-caret-up",clock:"ph-clock",close:"ph-x",coinPlaceholder:"ph-circle-half",compass:"ph-compass",copy:"ph-copy",desktop:"ph-desktop",dollar:"ph-currency-dollar",download:"ph-vault",exclamationCircle:"ph-warning-circle",extension:"ph-puzzle-piece",externalLink:"ph-arrow-square-out",filters:"ph-funnel-simple",helpCircle:"ph-question",id:"ph-identification-card",image:"ph-image",info:"ph-info",lightbulb:"ph-lightbulb",mail:"ph-envelope",mobile:"ph-device-mobile",more:"ph-dots-three",networkPlaceholder:"ph-globe",nftPlaceholder:"ph-image",plus:"ph-plus",power:"ph-power",qrCode:"ph-qr-code",questionMark:"ph-question",refresh:"ph-arrow-clockwise",recycleHorizontal:"ph-arrows-clockwise",search:"ph-magnifying-glass",sealCheck:"ph-seal-check",send:"ph-paper-plane-right",signOut:"ph-sign-out",spinner:"ph-spinner",swapHorizontal:"ph-arrows-left-right",swapVertical:"ph-arrows-down-up",threeDots:"ph-dots-three",user:"ph-user",verify:"ph-seal-check",verifyFilled:"ph-seal-check",wallet:"ph-wallet",warning:"ph-warning",warningCircle:"ph-warning-circle",appStore:"",apple:"",bitcoin:"",coins:"",chromeStore:"",cursor:"",discord:"",ethereum:"",etherscan:"",facebook:"",farcaster:"",github:"",google:"",playStore:"",paperPlaneTitle:"",reown:"",solana:"",ton:"",telegram:"",twitch:"",twitterIcon:"",twitter:"",walletConnect:"",walletConnectBrown:"",walletConnectLightBrown:"",x:"",infoSeal:""},L8={"ph-arrow-circle-down":()=>import("./PhArrowCircleDown-IEXXWQED.js"),"ph-arrow-clockwise":()=>import("./PhArrowClockwise-JWGTWVIL.js"),"ph-arrow-down":()=>import("./PhArrowDown-2EUGOGAM.js"),"ph-arrow-left":()=>import("./PhArrowLeft-FGLX2QDS.js"),"ph-arrow-right":()=>import("./PhArrowRight-RPWIDUCV.js"),"ph-arrow-square-out":()=>import("./PhArrowSquareOut-IMZQK6J4.js"),"ph-arrows-down-up":()=>import("./PhArrowsDownUp-7GD4KL6W.js"),"ph-arrows-left-right":()=>import("./PhArrowsLeftRight-Z3ZECCBL.js"),"ph-arrow-up":()=>import("./PhArrowUp-RSWGSMQW.js"),"ph-arrow-up-right":()=>import("./PhArrowUpRight-4UHKVOE7.js"),"ph-arrows-clockwise":()=>import("./PhArrowsClockwise-AYSDWPLT.js"),"ph-bank":()=>import("./PhBank-2B7BHRIN.js"),"ph-browser":()=>import("./PhBrowser-LS2TT2NH.js"),"ph-caret-down":()=>import("./PhCaretDown-NJWBWI6R.js"),"ph-caret-left":()=>import("./PhCaretLeft-XYGU26UE.js"),"ph-caret-right":()=>import("./PhCaretRight-Y2FNN4PV.js"),"ph-caret-up":()=>import("./PhCaretUp-TDAZN2GV.js"),"ph-check":()=>import("./PhCheck-VSHL2VI5.js"),"ph-circle-half":()=>import("./PhCircleHalf-O7VOU72W.js"),"ph-clock":()=>import("./PhClock-Q6LG7D43.js"),"ph-compass":()=>import("./PhCompass-3HKK6Y2T.js"),"ph-copy":()=>import("./PhCopy-PAJGH56V.js"),"ph-credit-card":()=>import("./PhCreditCard-VRWIJMTU.js"),"ph-currency-dollar":()=>import("./PhCurrencyDollar-JWH6A5TW.js"),"ph-desktop":()=>import("./PhDesktop-LTSKGZMC.js"),"ph-device-mobile":()=>import("./PhDeviceMobile-CMTPUMYS.js"),"ph-dots-three":()=>import("./PhDotsThree-X75DPDKB.js"),"ph-vault":()=>import("./PhVault-O6K2AJ42.js"),"ph-envelope":()=>import("./PhEnvelope-6M7I4MR7.js"),"ph-funnel-simple":()=>import("./PhFunnelSimple-ZPQKXKDV.js"),"ph-globe":()=>import("./PhGlobe-X43TULTX.js"),"ph-identification-card":()=>import("./PhIdentificationCard-6DPNVWHS.js"),"ph-image":()=>import("./PhImage-ALW7TUQN.js"),"ph-info":()=>import("./PhInfo-4IFG7OVY.js"),"ph-lightbulb":()=>import("./PhLightbulb-33PEEVNV.js"),"ph-magnifying-glass":()=>import("./PhMagnifyingGlass-5XDLFZFV.js"),"ph-paper-plane-right":()=>import("./PhPaperPlaneRight-326FQW7I.js"),"ph-plus":()=>import("./PhPlus-2QMNPWIU.js"),"ph-power":()=>import("./PhPower-63L4ILUY.js"),"ph-puzzle-piece":()=>import("./PhPuzzlePiece-AK6KICCX.js"),"ph-qr-code":()=>import("./PhQrCode-AJYKI2KH.js"),"ph-question":()=>import("./PhQuestion-DVMVBMHK.js"),"ph-question-circle":()=>import("./PhQuestionMark-VDWJBDMB.js"),"ph-seal-check":()=>import("./PhSealCheck-PDDNYJ3W.js"),"ph-sign-out":()=>import("./PhSignOut-3SH2MMTN.js"),"ph-spinner":()=>import("./PhSpinner-PWQWK7BF.js"),"ph-trash":()=>import("./PhTrash-UORZPZVB.js"),"ph-user":()=>import("./PhUser-QGWQ5UKN.js"),"ph-wallet":()=>import("./PhWallet-73EDWG2D.js"),"ph-warning":()=>import("./PhWarning-CFQDHT5E.js"),"ph-warning-circle":()=>import("./PhWarningCircle-JGXZJFSW.js"),"ph-x":()=>import("./PhX-EAHS6DZO.js")},U8={appStore:X0,apple:J0,bitcoin:Q0,coins:t1,chromeStore:e1,cursor:r1,discord:s1,ethereum:n1,etherscan:i1,facebook:o1,farcaster:a1,github:c1,google:l1,playStore:p1,paperPlaneTitle:h1,reown:f1,solana:d1,ton:m1,telegram:g1,twitch:y1,twitter:jh,twitterIcon:w1,walletConnect:b1,walletConnectInvert:v1,walletConnectBrown:E1,walletConnectLightBrown:x1,x:jh,infoSeal:u1},$8={"accent-primary":Ne.tokens.core.iconAccentPrimary,"accent-certified":Ne.tokens.core.iconAccentCertified,"foreground-secondary":Ne.tokens.theme.foregroundSecondary,default:Ne.tokens.theme.iconDefault,success:Ne.tokens.core.iconSuccess,error:Ne.tokens.core.iconError,warning:Ne.tokens.core.iconWarning,inverse:Ne.tokens.theme.iconInverse},rn=class extends cn{constructor(){super(...arguments),this.size="md",this.name="copy",this.weight="bold",this.color="inherit"}render(){let t={xxs:"2",xs:"3",sm:"3",md:"4",mdl:"5",lg:"5",xl:"6",xxl:"7",inherit:"inherit"};this.style.cssText=`
      --local-width: ${this.size==="inherit"?"inherit":`var(--apkt-spacing-${t[this.size]})`};
      --local-color: ${this.color==="inherit"?"inherit":$8[this.color]}
    `;let r=B8[this.name];if(r&&r!==""){let s=L8[r];s&&s();let n=cp(r);return Fa`<${n} size=${{xxs:"0.5em",xs:"0.75em",sm:"0.75em",md:"1em",mdl:"1.25em",lg:"1.25em",xl:"1.5em",xxl:"1.75em"}[this.size]} weight="${this.weight}"></${n}>`}return U8[this.name]||Fa``}};rn.styles=[zn,S1];qi([Se()],rn.prototype,"size",void 0);qi([Se()],rn.prototype,"name",void 0);qi([Se()],rn.prototype,"weight",void 0);qi([Se()],rn.prototype,"color",void 0);rn=qi([tn("wui-icon")],rn);export{za as a,_0 as b,ln as c,Xs as d,Th as e,Gt as f,Ah as g,Ph as h,te as i,w8 as j,XE as k,z0 as l,r8 as m,bs as n,m8 as o,b8 as p,Ne as q,Lh as r,_8 as s,Uh as t,T8 as u,zn as v,TR as w,Lt as x,$h as y,tn as z,m1 as A};
/*! Bundled license information:

@noble/curves/esm/abstract/utils.js:
@noble/curves/esm/abstract/modular.js:
@noble/curves/esm/abstract/curve.js:
@noble/curves/esm/abstract/weierstrass.js:
@noble/curves/esm/_shortw_utils.js:
@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@walletconnect/utils/dist/index.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
