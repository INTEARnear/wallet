import{A as f,G as a,I as i,b as m,k as p,l as t,q as u,s as n,u as s}from"./chunk-AXPE5NAX.js";function S(){try{return t.returnOpenHref(`${m.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes")}catch{throw new Error("Could not open social popup")}}async function h(){n.push("ConnectingFarcaster");let r=s.getAuthConnector();if(r&&!i.state.farcasterUrl)try{let{url:e}=await r.provider.getFarcasterUri();i.setFarcasterUrl(e,a.state.activeChain)}catch(e){n.goBack(),f.showError(e)}}async function C(r){n.push("ConnectingSocial");let e=s.getAuthConnector(),o=null;try{let c=setTimeout(()=>{throw new Error("Social login timed out. Please try again.")},45e3);if(e&&r){if(t.isTelegram()||(o=S()),o)i.setSocialWindow(o,a.state.activeChain);else if(!t.isTelegram())throw new Error("Could not create social popup");let{uri:l}=await e.provider.getSocialRedirectUri({provider:r});if(!l)throw o?.close(),new Error("Could not fetch the social redirect uri");if(o&&(o.location.href=l),t.isTelegram()){p.setTelegramSocialProvider(r);let g=t.formatTelegramSocialLoginUrl(l);t.openHref(g,"_top")}clearTimeout(c)}}catch(c){o?.close(),f.showError(c?.message)}}async function w(r){i.setSocialProvider(r,a.state.activeChain),u.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:r}}),r==="farcaster"?await h():await C(r)}export{w as a};
