import{A as h,G as p,I as i,b as C,k as m,l as t,q as g,s as l,u}from"./chunk-UDTBWQKV.js";import{h as n,j as a,n as c}from"./chunk-KGCAX4NX.js";n();c();a();n();c();a();function T(){try{return t.returnOpenHref(`${C.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes")}catch{throw new Error("Could not open social popup")}}async function S(){l.push("ConnectingFarcaster");let r=u.getAuthConnector();if(r&&!i.state.farcasterUrl)try{let{url:e}=await r.provider.getFarcasterUri();i.setFarcasterUrl(e,p.state.activeChain)}catch(e){l.goBack(),h.showError(e)}}async function w(r){l.push("ConnectingSocial");let e=u.getAuthConnector(),o=null;try{let s=setTimeout(()=>{throw new Error("Social login timed out. Please try again.")},45e3);if(e&&r){if(t.isTelegram()||(o=T()),o)i.setSocialWindow(o,p.state.activeChain);else if(!t.isTelegram())throw new Error("Could not create social popup");let{uri:f}=await e.provider.getSocialRedirectUri({provider:r});if(!f)throw o?.close(),new Error("Could not fetch the social redirect uri");if(o&&(o.location.href=f),t.isTelegram()){m.setTelegramSocialProvider(r);let U=t.formatTelegramSocialLoginUrl(f);t.openHref(U,"_top")}clearTimeout(s)}}catch(s){o?.close(),h.showError(s?.message)}}async function y(r){i.setSocialProvider(r,p.state.activeChain),g.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:r}}),r==="farcaster"?await S():await w(r)}export{y as a};
